{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"\";\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || \"\";\n\n// –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã\n// –í–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏ –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è\nexport const supabase = supabaseUrl && supabaseAnonKey\n  ? createClient(supabaseUrl, supabaseAnonKey)\n  : createClient(\"https://placeholder.supabase.co\", \"placeholder-key\");\n\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,gEAAwC;AAC5D,MAAM,kBAAkB,iNAA6C;AAI9D,MAAM,WAAW,uCACpB,IAAA,uMAAY,EAAC,aAAa,mBAC1B"}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/components/EmptyState.tsx"],"sourcesContent":["import type { ReactNode } from \"react\";\nimport Image from \"next/image\";\n\ntype EmptyStateProps = {\n  title?: string;\n  description?: string;\n  imageSrc?: string;\n  children?: ReactNode;\n};\n\nconst defaultTitleText = \"–ù–∏—á–µ–≥–æ –Ω–µ—Ç‚Ä¶\";\nconst defaultDescriptionText = \"–ë—É–¥—Ç–æ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –∫–æ—Å–º–æ—Å–µ...\";\nconst defaultImageSrc = \"/Cosmo.png\";\n\nexport function EmptyState({\n  title = defaultTitleText,\n  description = defaultDescriptionText,\n  imageSrc = defaultImageSrc,\n  children,\n}: EmptyStateProps) {\n  return (\n    <div className=\"flex w-full max-w-[1350px] min-h-[350px] flex-col items-center gap-6 rounded-3xl px-16 pt-6 pb-10 text-center\">\n      <div className=\"relative h-48 w-48 max-w-full\">\n        <Image\n          src={imageSrc}\n          alt={title || defaultTitleText}\n          fill\n          sizes=\"(max-width: 768px) 60vw, 224px\"\n          className=\"object-contain drop-shadow-xl\"\n          priority\n        />\n      </div>\n      {(title || description) && (\n      <div className=\"space-y-2\">\n          {title && <p className=\"text-2xl font-semibold text-gray-900\">{title}</p>}\n          {description && <p className=\"text-gray-600\">{description}</p>}\n      </div>\n      )}\n      {children}\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AACA;;;AASA,MAAM,mBAAmB;AACzB,MAAM,yBAAyB;AAC/B,MAAM,kBAAkB;AAEjB,SAAS,WAAW,EACzB,QAAQ,gBAAgB,EACxB,cAAc,sBAAsB,EACpC,WAAW,eAAe,EAC1B,QAAQ,EACQ;IAChB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,wIAAK;oBACJ,KAAK;oBACL,KAAK,SAAS;oBACd,IAAI;oBACJ,OAAM;oBACN,WAAU;oBACV,QAAQ;;;;;;;;;;;YAGX,CAAC,SAAS,WAAW,mBACtB,8OAAC;gBAAI,WAAU;;oBACV,uBAAS,8OAAC;wBAAE,WAAU;kCAAwC;;;;;;oBAC9D,6BAAe,8OAAC;wBAAE,WAAU;kCAAiB;;;;;;;;;;;;YAGjD;;;;;;;AAGP"}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/components/ui/LogoutModal.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { supabase } from \"@/lib/supabaseClient\";\n\ninterface LogoutModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function LogoutModal({ isOpen, onClose }: LogoutModalProps) {\n  const router = useRouter();\n  const [isLoggingOut, setIsLoggingOut] = useState(false);\n\n  const handleLogout = async () => {\n    setIsLoggingOut(true);\n    try {\n      await supabase.auth.signOut();\n      document.cookie =\n        \"app-auth=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT\";\n      router.push(\"/login\");\n      onClose();\n    } catch (error) {\n      console.error(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ:\", error);\n    } finally {\n      setIsLoggingOut(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n      <div className=\"mx-4 w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl\">\n        <h2 className=\"mb-4 text-xl font-semibold text-gray-900\">–í—ã—Ö–æ–¥</h2>\n        <p className=\"mb-6 text-gray-600\">–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?</p>\n        <div className=\"flex gap-3\">\n          <button\n            type=\"button\"\n            onClick={onClose}\n            disabled={isLoggingOut}\n            className=\"flex-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50 disabled:opacity-50\"\n          >\n            –û—Ç–º–µ–Ω–∞\n          </button>\n          <button\n            type=\"button\"\n            onClick={handleLogout}\n            disabled={isLoggingOut}\n            className=\"flex-1 rounded-lg bg-gray-900 px-4 py-2 text-sm font-semibold text-white transition hover:bg-gray-800 disabled:opacity-50\"\n          >\n            {isLoggingOut ? \"–í—ã—Ö–æ–¥–∏–º...\" : \"–í—ã–π—Ç–∏\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAWO,SAAS,YAAY,EAAE,MAAM,EAAE,OAAO,EAAoB;IAC/D,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IAEjD,MAAM,eAAe;QACnB,gBAAgB;QAChB,IAAI;YACF,MAAM,iIAAQ,CAAC,IAAI,CAAC,OAAO;YAC3B,SAAS,MAAM,GACb;YACF,OAAO,IAAI,CAAC;YACZ;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;QACtC,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAA2C;;;;;;8BACzD,8OAAC;oBAAE,WAAU;8BAAqB;;;;;;8BAClC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,MAAK;4BACL,SAAS;4BACT,UAAU;4BACV,WAAU;sCACX;;;;;;sCAGD,8OAAC;4BACC,MAAK;4BACL,SAAS;4BACT,UAAU;4BACV,WAAU;sCAET,eAAe,eAAe;;;;;;;;;;;;;;;;;;;;;;;AAM3C"}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/lib/prefetchAvatars.ts"],"sourcesContent":["import { supabase } from \"./supabaseClient\";\nimport type { PhotoAvatarRow } from \"@/app/avatars/servers/UploadAvatar\";\n\n// –ö–µ—à –¥–ª—è prefetch –¥–∞–Ω–Ω—ã—Ö\nlet prefetchCache: {\n  data: PhotoAvatarRow[] | null;\n  timestamp: number;\n  userId: string | null;\n} = {\n  data: null,\n  timestamp: 0,\n  userId: null,\n};\n\nconst CACHE_DURATION = 30000; // 30 —Å–µ–∫—É–Ω–¥\n\nexport async function prefetchAvatarsData(): Promise<void> {\n  try {\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–µ—à\n    const now = Date.now();\n    if (\n      prefetchCache.data &&\n      prefetchCache.userId &&\n      now - prefetchCache.timestamp < CACHE_DURATION\n    ) {\n      return; // –î–∞–Ω–Ω—ã–µ —É–∂–µ –≤ –∫–µ—à–µ –∏ —Å–≤–µ–∂–∏–µ\n    }\n\n    // –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n    const {\n      data: { user },\n    } = await supabase.auth.getUser();\n\n    if (!user) {\n      return;\n    }\n\n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ–º –ª–∏ –º—ã —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ\n    if (prefetchCache.userId === user.id && now - prefetchCache.timestamp < CACHE_DURATION) {\n      return;\n    }\n\n    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ–Ω–µ\n    const { data, error } = await supabase\n      .from(\"photo_avatars\")\n      .select(\"*\")\n      .eq(\"uid\", user.id)\n      .order(\"created_at\", { ascending: false });\n\n    if (!error && data) {\n      prefetchCache = {\n        data,\n        timestamp: now,\n        userId: user.id,\n      };\n    }\n  } catch (error) {\n    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ prefetch - —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ\n    console.debug(\"[prefetch] –û—à–∏–±–∫–∞ prefetch –∞–≤–∞—Ç–∞—Ä–æ–≤:\", error);\n  }\n}\n\nexport function getPrefetchedAvatars(): PhotoAvatarRow[] | null {\n  const now = Date.now();\n  if (\n    prefetchCache.data &&\n    now - prefetchCache.timestamp < CACHE_DURATION\n  ) {\n    return prefetchCache.data;\n  }\n  return null;\n}\n\nexport function clearPrefetchCache(): void {\n  prefetchCache = {\n    data: null,\n    timestamp: 0,\n    userId: null,\n  };\n}\n\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGA,0BAA0B;AAC1B,IAAI,gBAIA;IACF,MAAM;IACN,WAAW;IACX,QAAQ;AACV;AAEA,MAAM,iBAAiB,OAAO,YAAY;AAEnC,eAAe;IACpB,IAAI;QACF,gBAAgB;QAChB,MAAM,MAAM,KAAK,GAAG;QACpB,IACE,cAAc,IAAI,IAClB,cAAc,MAAM,IACpB,MAAM,cAAc,SAAS,GAAG,gBAChC;YACA,QAAQ,6BAA6B;QACvC;QAEA,wBAAwB;QACxB,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,OAAO;QAE/B,IAAI,CAAC,MAAM;YACT;QACF;QAEA,6CAA6C;QAC7C,IAAI,cAAc,MAAM,KAAK,KAAK,EAAE,IAAI,MAAM,cAAc,SAAS,GAAG,gBAAgB;YACtF;QACF;QAEA,0BAA0B;QAC1B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,OAAO,KAAK,EAAE,EACjB,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,CAAC,SAAS,MAAM;YAClB,gBAAgB;gBACd;gBACA,WAAW;gBACX,QAAQ,KAAK,EAAE;YACjB;QACF;IACF,EAAE,OAAO,OAAO;QACd,+CAA+C;QAC/C,QAAQ,KAAK,CAAC,wCAAwC;IACxD;AACF;AAEO,SAAS;IACd,MAAM,MAAM,KAAK,GAAG;IACpB,IACE,cAAc,IAAI,IAClB,MAAM,cAAc,SAAS,GAAG,gBAChC;QACA,OAAO,cAAc,IAAI;IAC3B;IACA,OAAO;AACT;AAEO,SAAS;IACd,gBAAgB;QACd,MAAM;QACN,WAAW;QACX,QAAQ;IACV;AACF"}},
    {"offset": {"line": 277, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/components/ui/Header.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport Link from \"next/link\";\nimport { usePathname } from \"next/navigation\";\nimport { LogoutModal } from \"./LogoutModal\";\nimport { prefetchAvatarsData } from \"@/lib/prefetchAvatars\";\n\nconst navLinks = [\n  { href: \"/\", label: \"–ì–ª–∞–≤–Ω–∞—è\" },\n  { href: \"/avatars\", label: \"–ê–≤–∞—Ç–∞—Ä—ã\" },\n  { href: \"/voices\", label: \"–ì–æ–ª–æ—Å–∞\" },\n  { href: \"/material\", label: \"–ú–∞—Ç–µ—Ä–∏–∞–ª\" },\n];\n\nexport function Header() {\n  const pathname = usePathname();\n  const [isLogoutModalOpen, setIsLogoutModalOpen] = useState(false);\n\n  return (\n    <>\n      <header className=\"fixed top-0 left-0 right-0 z-50 h-16 w-full bg-white/95 backdrop-blur supports-[backdrop-filter]:bg-white/80 shadow-lg border-b border-gray-100\">\n        <div className=\"mx-auto flex h-full w-full max-w-[1350px] items-center px-6\">\n          <nav className=\"flex flex-1 items-center gap-8\">\n            {navLinks.map(({ href, label }) => {\n              const isActive = pathname === href;\n              const handleMouseEnter = () => {\n                // Prefetch –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤–∞—Ç–∞—Ä–æ–≤ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏\n                if ((href === \"/avatars\" || href === \"/\") && !isActive) {\n                  prefetchAvatarsData();\n                }\n              };\n              \n              return (\n                <Link\n                  key={href}\n                  href={href}\n                  onMouseEnter={handleMouseEnter}\n                  prefetch={true}\n                  className={`text-lg font-semibold transition ${\n                    isActive\n                      ? \"text-gray-900\"\n                      : \"text-gray-500 hover:text-gray-800\"\n                  }`}\n                >\n                  {label}\n                </Link>\n              );\n            })}\n          </nav>\n          <div className=\"flex flex-none justify-end\">\n            <button\n              type=\"button\"\n              onClick={() => setIsLogoutModalOpen(true)}\n              className=\"rounded-lg bg-gray-900 px-4 py-2 text-sm font-semibold text-white transition hover:bg-gray-800\"\n            >\n              –í—ã–π—Ç–∏\n            </button>\n          </div>\n        </div>\n      </header>\n      <div className=\"h-16\" aria-hidden />\n      <LogoutModal\n        isOpen={isLogoutModalOpen}\n        onClose={() => setIsLogoutModalOpen(false)}\n      />\n    </>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQA,MAAM,WAAW;IACf;QAAE,MAAM;QAAK,OAAO;IAAU;IAC9B;QAAE,MAAM;QAAY,OAAO;IAAU;IACrC;QAAE,MAAM;QAAW,OAAO;IAAS;IACnC;QAAE,MAAM;QAAa,OAAO;IAAW;CACxC;AAEM,SAAS;IACd,MAAM,WAAW,IAAA,iJAAW;IAC5B,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,iNAAQ,EAAC;IAE3D,qBACE;;0BACE,8OAAC;gBAAO,WAAU;0BAChB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;sCACZ,SAAS,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE;gCAC5B,MAAM,WAAW,aAAa;gCAC9B,MAAM,mBAAmB;oCACvB,sDAAsD;oCACtD,IAAI,CAAC,SAAS,cAAc,SAAS,GAAG,KAAK,CAAC,UAAU;wCACtD,IAAA,6IAAmB;oCACrB;gCACF;gCAEA,qBACE,8OAAC,uKAAI;oCAEH,MAAM;oCACN,cAAc;oCACd,UAAU;oCACV,WAAW,CAAC,iCAAiC,EAC3C,WACI,kBACA,qCACJ;8CAED;mCAVI;;;;;4BAaX;;;;;;sCAEF,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCACC,MAAK;gCACL,SAAS,IAAM,qBAAqB;gCACpC,WAAU;0CACX;;;;;;;;;;;;;;;;;;;;;;0BAMP,8OAAC;gBAAI,WAAU;gBAAO,aAAW;;;;;;0BACjC,8OAAC,+IAAW;gBACV,QAAQ;gBACR,SAAS,IAAM,qBAAqB;;;;;;;;AAI5C"}},
    {"offset": {"line": 400, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/components/ui/CosmoLoader.tsx"],"sourcesContent":["type CosmoLoaderProps = {\r\n  ariaLabel?: string;\r\n};\r\n\r\nexport function CosmoLoader({ ariaLabel = \"–ó–∞–≥—Ä—É–∑–∫–∞...\" }: CosmoLoaderProps) {\r\n  return (\r\n    <div className=\"flex flex-col items-center\" role=\"status\" aria-live=\"polite\">\r\n      <div className=\"relative flex items-center justify-center\">\r\n        <div\r\n          className=\"h-10 w-10 animate-spin rounded-full border-[3px] border-transparent shadow-[0_0_18px_rgba(255,192,76,0.55)]\"\r\n          style={{\r\n            borderTopColor: \"#FFB347\",\r\n            borderRightColor: \"#FFC94C\",\r\n          }}\r\n        />\r\n        <div className=\"absolute h-3 w-3 rounded-full bg-[#FFB347] opacity-70 blur-sm\" />\r\n      </div>\r\n      <span className=\"sr-only\">{ariaLabel}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;AAIO,SAAS,YAAY,EAAE,YAAY,aAAa,EAAoB;IACzE,qBACE,8OAAC;QAAI,WAAU;QAA6B,MAAK;QAAS,aAAU;;0BAClE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,WAAU;wBACV,OAAO;4BACL,gBAAgB;4BAChB,kBAAkB;wBACpB;;;;;;kCAEF,8OAAC;wBAAI,WAAU;;;;;;;;;;;;0BAEjB,8OAAC;gBAAK,WAAU;0BAAW;;;;;;;;;;;;AAGjC"}},
    {"offset": {"line": 458, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/app/voices/components/VoiceCreateModal.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { supabase } from \"@/lib/supabaseClient\";\n\ninterface VoiceCreateModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onVoiceCreated?: () => void | Promise<void>;\n}\n\nconst MAX_FILE_SIZE_MB = 11;\nconst MAX_FILE_SIZE = MAX_FILE_SIZE_MB * 1024 * 1024; // 11 –ú–ë\nconst ALLOWED_TYPES = [\"audio/mpeg\", \"audio/mp3\", \"audio/wav\", \"audio/webm\", \"audio/ogg\"];\nconst MAX_DESCRIPTION_LENGTH = 100;\n\nexport function VoiceCreateModal({\n  isOpen,\n  onClose,\n  onVoiceCreated,\n}: VoiceCreateModalProps) {\n  const [voiceName, setVoiceName] = useState(\"\");\n  const [voiceDescription, setVoiceDescription] = useState(\"\");\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordedBlob, setRecordedBlob] = useState<Blob | null>(null);\n  const [recordedAudioUrl, setRecordedAudioUrl] = useState<string | null>(null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [isWaiting, setIsWaiting] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [dragActive, setDragActive] = useState(false);\n  const [audioLevel, setAudioLevel] = useState(0); // –£—Ä–æ–≤–µ–Ω—å –≥—Ä–æ–º–∫–æ—Å—Ç–∏ (0-100)\n  const [isTestingMicrophone, setIsTestingMicrophone] = useState(false); // –¢–µ—Å—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –¥–æ –∑–∞–ø–∏—Å–∏\n  const [recordingTimer, setRecordingTimer] = useState(120); // –¢–∞–π–º–µ—Ä –∑–∞–ø–∏—Å–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (2 –º–∏–Ω—É—Ç—ã)\n  const [errorModal, setErrorModal] = useState<{ isOpen: boolean; message: string }>({ isOpen: false, message: \"\" });\n  const progressIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const timerIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  \n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n  const audioChunksRef = useRef<Blob[]>([]);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const audioPlayerRef = useRef<HTMLAudioElement>(null);\n  const audioContextRef = useRef<AudioContext | null>(null);\n  const analyserRef = useRef<AnalyserNode | null>(null);\n  const animationFrameRef = useRef<number | null>(null);\n  const streamRef = useRef<MediaStream | null>(null);\n\n  const stopProgressLoop = useCallback(() => {\n    if (progressIntervalRef.current) {\n      clearInterval(progressIntervalRef.current);\n      progressIntervalRef.current = null;\n    }\n  }, []);\n\n  const stopTimer = useCallback(() => {\n    if (timerIntervalRef.current) {\n      clearInterval(timerIntervalRef.current);\n      timerIntervalRef.current = null;\n    }\n  }, []);\n\n  const stopAudioAnalysis = useCallback(() => {\n    if (animationFrameRef.current !== null) {\n      cancelAnimationFrame(animationFrameRef.current);\n      animationFrameRef.current = null;\n    }\n    if (audioContextRef.current && audioContextRef.current.state !== \"closed\") {\n      audioContextRef.current.close().catch(console.error);\n    }\n    setAudioLevel(0);\n  }, []);\n\n  const startAudioAnalysis = useCallback((stream: MediaStream) => {\n    try {\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      const analyser = audioContext.createAnalyser();\n      const microphone = audioContext.createMediaStreamSource(stream);\n      \n      analyser.fftSize = 256;\n      analyser.smoothingTimeConstant = 0.8;\n      microphone.connect(analyser);\n      \n      audioContextRef.current = audioContext;\n      analyserRef.current = analyser;\n      \n      const dataArray = new Uint8Array(analyser.frequencyBinCount);\n      \n      const updateAudioLevel = () => {\n        if (!analyserRef.current) return;\n        \n        analyserRef.current.getByteFrequencyData(dataArray);\n        \n        // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –≥—Ä–æ–º–∫–æ—Å—Ç–∏\n        let sum = 0;\n        for (let i = 0; i < dataArray.length; i++) {\n          sum += dataArray[i];\n        }\n        const average = sum / dataArray.length;\n        \n        // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –ø—Ä–æ—Ü–µ–Ω—Ç—ã (0-100)\n        const level = Math.min(100, (average / 255) * 100);\n        setAudioLevel(level);\n        \n        animationFrameRef.current = requestAnimationFrame(updateAudioLevel);\n      };\n      \n      updateAudioLevel();\n    } catch (error) {\n      console.error(\"–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –∞—É–¥–∏–æ:\", error);\n    }\n  }, []);\n\n  const startProgressLoop = useCallback(() => {\n    stopProgressLoop();\n    setProgress(0);\n    const startTime = Date.now();\n    progressIntervalRef.current = setInterval(() => {\n      const elapsed = Date.now() - startTime;\n      const nextValue = Math.min(100, (elapsed / 15000) * 100);\n      setProgress(nextValue);\n    }, 50);\n  }, [stopProgressLoop]);\n\n  const resetState = useCallback(() => {\n    setVoiceName(\"\");\n    setVoiceDescription(\"\");\n    setSelectedFile(null);\n    setRecordedBlob(null);\n    // –û—á–∏—â–∞–µ–º URL –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏\n    if (recordedAudioUrl) {\n      URL.revokeObjectURL(recordedAudioUrl);\n    }\n    setRecordedAudioUrl(null);\n    setIsRecording(false);\n    setIsWaiting(false);\n    setIsTestingMicrophone(false);\n    setProgress(0);\n    setRecordingTimer(120);\n    stopProgressLoop();\n    stopTimer();\n    stopAudioAnalysis();\n    audioChunksRef.current = [];\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== \"inactive\") {\n      mediaRecorderRef.current.stop();\n    }\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n    }\n    if (mediaRecorderRef.current?.stream) {\n      mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());\n    }\n  }, [recordedAudioUrl, stopProgressLoop, stopTimer, stopAudioAnalysis]);\n\n  const closeModal = useCallback(() => {\n    resetState();\n    onClose();\n  }, [onClose, resetState]);\n\n  useEffect(() => {\n    return () => {\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n      }\n      if (mediaRecorderRef.current?.stream) {\n        mediaRecorderRef.current.stream.getTracks().forEach(track => track.stop());\n      }\n      // –û—á–∏—â–∞–µ–º URL –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏\n      if (recordedAudioUrl) {\n        URL.revokeObjectURL(recordedAudioUrl);\n      }\n      stopProgressLoop();\n      stopTimer();\n      stopAudioAnalysis();\n    };\n  }, [recordedAudioUrl, stopProgressLoop, stopTimer, stopAudioAnalysis]);\n\n  const showError = useCallback((message: string) => {\n    setErrorModal({ isOpen: true, message });\n  }, []);\n\n  const validateFile = (file: File): boolean => {\n    if (!ALLOWED_TYPES.includes(file.type.toLowerCase())) {\n      showError(\"–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞. –î–æ–ø—É—Å—Ç–∏–º—ã —Ç–æ–ª—å–∫–æ MP3, WAV, WebM –∏–ª–∏ OGG.\");\n      return false;\n    }\n    if (file.size > MAX_FILE_SIZE) {\n      showError(\n        `–§–∞–π–ª –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç ${MAX_FILE_SIZE_MB} –ú–ë. –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ${(file.size / 1024 / 1024).toFixed(1)} –ú–ë`,\n      );\n      return false;\n    }\n    return true;\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.files?.[0]) {\n      const file = event.target.files[0];\n      if (validateFile(file)) {\n        setSelectedFile(file);\n        setRecordedBlob(null); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–∞–ø–∏—Å—å –µ—Å–ª–∏ –≤—ã–±—Ä–∞–ª–∏ —Ñ–∞–π–ª\n      }\n    }\n  };\n\n  const handleDrag = useCallback((event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (event.type === \"dragenter\" || event.type === \"dragover\") {\n      setDragActive(true);\n    } else if (event.type === \"dragleave\") {\n      setDragActive(false);\n    }\n  }, []);\n\n  const handleDrop = useCallback((event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    setDragActive(false);\n    if (event.dataTransfer.files?.[0]) {\n      const file = event.dataTransfer.files[0];\n      if (validateFile(file)) {\n        setSelectedFile(file);\n        setRecordedBlob(null); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–∞–ø–∏—Å—å –µ—Å–ª–∏ –≤—ã–±—Ä–∞–ª–∏ —Ñ–∞–π–ª\n      }\n    }\n  }, []);\n\n  const startMicrophoneTest = useCallback(async () => {\n    try {\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        showError(\n          \"–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–ø–∏—Å—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä (Chrome, Firefox, Edge).\"\n        );\n        return;\n      }\n\n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n        } \n      });\n      \n      streamRef.current = stream;\n      setIsTestingMicrophone(true);\n      \n      // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑ –∞—É–¥–∏–æ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏\n      startAudioAnalysis(stream);\n    } catch (error: unknown) {\n      console.error(\"–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É:\", error);\n      setIsTestingMicrophone(false);\n      \n      let errorMessage = \"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É.\";\n      \n      if (error instanceof Error) {\n        if (error.name === \"NotAllowedError\" || error.name === \"PermissionDeniedError\") {\n          errorMessage = \n            \"–î–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –∑–∞–ø—Ä–µ—â–µ–Ω.\\n\\n\" +\n            \"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞:\\n\" +\n            \"1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∑–∞–º–∫–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞\\n\" +\n            \"2. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É\\n\" +\n            \"3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞\";\n        } else if (error.name === \"NotFoundError\" || error.name === \"DevicesNotFoundError\") {\n          errorMessage = \"–ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω –∏ –≤–∫–ª—é—á–µ–Ω.\";\n        } else if (error.name === \"NotReadableError\" || error.name === \"TrackStartError\") {\n          errorMessage = \n            \"–ú–∏–∫—Ä–æ—Ñ–æ–Ω —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.\\n\\n\" +\n            \"–ó–∞–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω, –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\";\n        } else {\n          errorMessage = `–û—à–∏–±–∫–∞: ${error.message}`;\n        }\n      }\n      \n      showError(errorMessage);\n    }\n  }, [startAudioAnalysis, showError]);\n\n  const stopMicrophoneTest = useCallback(() => {\n    setIsTestingMicrophone(false);\n    stopAudioAnalysis();\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n    }\n  }, [stopAudioAnalysis]);\n\n  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞\n  useEffect(() => {\n    if (isOpen && !isRecording && !isTestingMicrophone && !streamRef.current) {\n      startMicrophoneTest();\n    }\n    \n    return () => {\n      // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ (–µ—Å–ª–∏ –Ω–µ –∏–¥–µ—Ç –∑–∞–ø–∏—Å—å)\n      if (!isOpen && !isRecording && isTestingMicrophone) {\n        stopMicrophoneTest();\n      }\n    };\n  }, [isOpen, isRecording, isTestingMicrophone, startMicrophoneTest, stopMicrophoneTest]);\n\n  const startRecording = async () => {\n    try {\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        showError(\n          \"–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–ø–∏—Å—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä (Chrome, Firefox, Edge).\"\n        );\n        return;\n      }\n\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∑–∞–ø—Ä–æ—Å–æ–º\n      try {\n        const permissionStatus = await navigator.permissions.query({ name: \"microphone\" as PermissionName });\n        if (permissionStatus.state === \"denied\") {\n          showError(\n            \"–î–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –∑–∞–ø—Ä–µ—â–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.\"\n          );\n          return;\n        }\n      } catch (permError) {\n        // –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç permissions API, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º\n        console.log(\"Permissions API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∑–∞–ø—Ä–æ—Å\");\n      }\n\n      // –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –¥–ª—è –∑–∞–ø–∏—Å–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤\n      // –ï—Å–ª–∏ –±—ã–ª —Ç–µ—Å—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞, –æ—Å—Ç–∞–Ω–æ–≤–∏–º –µ–≥–æ –ø–æ—Ç–æ–∫ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ\n      const oldStream = streamRef.current;\n      \n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n        } \n      });\n      \n      // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π –ø–æ—Ç–æ–∫ –∏–∑ —Ç–µ—Å—Ç–∞, –µ—Å–ª–∏ –æ–Ω –±—ã–ª\n      if (oldStream && isTestingMicrophone) {\n        stopAudioAnalysis();\n        oldStream.getTracks().forEach(track => track.stop());\n      }\n      \n      streamRef.current = stream;\n      \n      // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑ –∞—É–¥–∏–æ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏\n      startAudioAnalysis(stream);\n      \n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType: MediaRecorder.isTypeSupported(\"audio/webm\") \n          ? \"audio/webm\" \n          : MediaRecorder.isTypeSupported(\"audio/webm;codecs=opus\")\n          ? \"audio/webm;codecs=opus\"\n          : \"audio/mp4\"\n      });\n      \n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n\n      mediaRecorder.ondataavailable = (event) => {\n        if (event.data.size > 0) {\n          audioChunksRef.current.push(event.data);\n        }\n      };\n\n      mediaRecorder.onstop = () => {\n        const mimeType = mediaRecorder.mimeType || \"audio/webm\";\n        const audioBlob = new Blob(audioChunksRef.current, { type: mimeType });\n        setRecordedBlob(audioBlob);\n        \n        // –°–æ–∑–¥–∞–µ–º URL –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è\n        const audioUrl = URL.createObjectURL(audioBlob);\n        setRecordedAudioUrl(audioUrl);\n        \n        setSelectedFile(null); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–∞–π–ª –µ—Å–ª–∏ –∑–∞–ø–∏—Å–∞–ª–∏\n        stopAudioAnalysis();\n        stream.getTracks().forEach(track => track.stop());\n        streamRef.current = null;\n      };\n\n      mediaRecorder.onerror = (event) => {\n        console.error(\"–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏:\", event);\n        setIsRecording(false);\n        stopAudioAnalysis();\n        stream.getTracks().forEach(track => track.stop());\n        streamRef.current = null;\n        showError(\"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.\");\n      };\n\n      mediaRecorder.start();\n      setIsRecording(true);\n      setIsTestingMicrophone(false); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ—Å—Ç, –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–∏—Å—å\n      setRecordingTimer(120); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –Ω–∞ 2 –º–∏–Ω—É—Ç—ã\n      \n      // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞\n      stopTimer();\n      timerIntervalRef.current = setInterval(() => {\n        setRecordingTimer((prev) => {\n          if (prev <= 1) {\n            stopTimer();\n            return 0;\n          }\n          return prev - 1;\n        });\n      }, 1000);\n    } catch (error: unknown) {\n      console.error(\"–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É:\", error);\n      setIsRecording(false);\n      \n      let errorMessage = \"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É.\";\n      \n      if (error instanceof Error) {\n        if (error.name === \"NotAllowedError\" || error.name === \"PermissionDeniedError\") {\n          errorMessage = \n            \"–î–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –∑–∞–ø—Ä–µ—â–µ–Ω.\\n\\n\" +\n            \"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞:\\n\" +\n            \"1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∑–∞–º–∫–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞\\n\" +\n            \"2. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É\\n\" +\n            \"3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞\";\n        } else if (error.name === \"NotFoundError\" || error.name === \"DevicesNotFoundError\") {\n          errorMessage = \"–ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω –ø–æ–¥–∫–ª—é—á–µ–Ω –∏ –≤–∫–ª—é—á–µ–Ω.\";\n        } else if (error.name === \"NotReadableError\" || error.name === \"TrackStartError\") {\n          errorMessage = \n            \"–ú–∏–∫—Ä–æ—Ñ–æ–Ω —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.\\n\\n\" +\n            \"–ó–∞–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω, –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\";\n        } else {\n          errorMessage = `–û—à–∏–±–∫–∞: ${error.message}`;\n        }\n      }\n      \n      showError(errorMessage);\n    }\n  };\n\n  const stopRecording = useCallback(() => {\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== \"inactive\") {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n      stopTimer();\n      stopAudioAnalysis();\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n        streamRef.current = null;\n      }\n    }\n  }, [stopTimer, stopAudioAnalysis]);\n\n  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 0\n  useEffect(() => {\n    if (isRecording && recordingTimer === 0) {\n      stopRecording();\n    }\n  }, [isRecording, recordingTimer, stopRecording]);\n\n  const loadLameJs = (): Promise<any> => {\n    return new Promise((resolve, reject) => {\n      if (typeof window !== \"undefined\" && (window as any).lamejs) {\n        resolve((window as any).lamejs);\n        return;\n      }\n\n      const script = document.createElement(\"script\");\n      script.src = \"https://cdn.jsdelivr.net/npm/lamejs@1.2.1/lame.min.js\";\n      script.onload = () => resolve((window as any).lamejs);\n      script.onerror = () => reject(new Error(\"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏\"));\n      document.head.appendChild(script);\n    });\n  };\n\n  const convertWebmToMp3 = async (webmBlob: Blob): Promise<File> => {\n    const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n    const arrayBuffer = await webmBlob.arrayBuffer();\n    const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);\n\n    try {\n      // –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å lamejs –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ MP3\n      const Lame = await loadLameJs();\n      \n      const mp3encoder = new Lame.Mp3Encoder(\n        audioBuffer.numberOfChannels,\n        audioBuffer.sampleRate,\n        128 // bitrate\n      );\n\n      // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º float32 –≤ int16\n      const samples: Int16Array[] = [];\n      for (let i = 0; i < audioBuffer.numberOfChannels; i++) {\n        const channelData = audioBuffer.getChannelData(i);\n        const int16Array = new Int16Array(channelData.length);\n        for (let j = 0; j < channelData.length; j++) {\n          int16Array[j] = Math.max(-32768, Math.min(32767, channelData[j] * 32768));\n        }\n        samples.push(int16Array);\n      }\n\n      const mp3Data: BlobPart[] = [];\n      const sampleBlockSize = 1152;\n      \n      for (let i = 0; i < samples[0].length; i += sampleBlockSize) {\n        const left = samples[0].subarray(i, i + sampleBlockSize);\n        const right = audioBuffer.numberOfChannels > 1 \n          ? samples[1].subarray(i, i + sampleBlockSize)\n          : left;\n        const mp3buf = mp3encoder.encodeBuffer(left, right);\n        if (mp3buf.length > 0) {\n          mp3Data.push(mp3buf);\n        }\n      }\n\n      const mp3buf = mp3encoder.flush();\n      if (mp3buf.length > 0) {\n        mp3Data.push(mp3buf);\n      }\n\n      const mp3Blob = new Blob(mp3Data, { type: \"audio/mpeg\" });\n      return new File([mp3Blob], \"recording.mp3\", { type: \"audio/mpeg\" });\n    } catch (error) {\n      // Fallback: –µ—Å–ª–∏ lamejs –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ WAV\n      console.warn(\"–ù–µ —É–¥–∞–ª–æ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å lamejs, –∏—Å–ø–æ–ª—å–∑—É–µ–º WAV —Ñ–æ—Ä–º–∞—Ç:\", error);\n      const wavBlob = audioBufferToWav(audioBuffer);\n      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∫ WAV —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º mp3 (—Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å)\n      return new File([wavBlob], \"recording.mp3\", { type: \"audio/mpeg\" });\n    }\n  };\n\n  const audioBufferToWav = (buffer: AudioBuffer): Blob => {\n    const length = buffer.length;\n    const numberOfChannels = buffer.numberOfChannels;\n    const sampleRate = buffer.sampleRate;\n    const arrayBuffer = new ArrayBuffer(44 + length * numberOfChannels * 2);\n    const view = new DataView(arrayBuffer);\n\n    // WAV header\n    const writeString = (offset: number, string: string) => {\n      for (let i = 0; i < string.length; i++) {\n        view.setUint8(offset + i, string.charCodeAt(i));\n      }\n    };\n\n    writeString(0, \"RIFF\");\n    view.setUint32(4, 36 + length * numberOfChannels * 2, true);\n    writeString(8, \"WAVE\");\n    writeString(12, \"fmt \");\n    view.setUint32(16, 16, true);\n    view.setUint16(20, 1, true);\n    view.setUint16(22, numberOfChannels, true);\n    view.setUint32(24, sampleRate, true);\n    view.setUint32(28, sampleRate * numberOfChannels * 2, true);\n    view.setUint16(32, numberOfChannels * 2, true);\n    view.setUint16(34, 16, true);\n    writeString(36, \"data\");\n    view.setUint32(40, length * numberOfChannels * 2, true);\n\n    // Convert float samples to 16-bit PCM\n    let offset = 44;\n    for (let i = 0; i < length; i++) {\n      for (let channel = 0; channel < numberOfChannels; channel++) {\n        const sample = Math.max(-1, Math.min(1, buffer.getChannelData(channel)[i]));\n        view.setInt16(offset, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);\n        offset += 2;\n      }\n    }\n\n    return new Blob([arrayBuffer], { type: \"audio/wav\" });\n  };\n\n  const handleCloneVoice = async () => {\n    if (!voiceName.trim()) {\n      showError(\"–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞\");\n      return;\n    }\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ\n    try {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n\n      if (user) {\n        const { data: voicesData } = await supabase\n          .from(\"voices\")\n          .select(\"id\")\n          .eq(\"uid\", user.id);\n\n        if (voicesData && voicesData.length >= 3) {\n          showError(\"–í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –º–∞–∫—Å–∏–º—É–º 3 –≥–æ–ª–æ—Å–∞\");\n          return;\n        }\n      }\n    } catch (error) {\n      console.error(\"[VoiceCreateModal] –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–º–∏—Ç–∞:\", error);\n    }\n\n    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å—Ä–∞–∑—É –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É\n    setIsUploading(true);\n    setIsWaiting(true);\n    startProgressLoop();\n\n    let audioFile: File | null = null;\n\n    if (selectedFile) {\n      // –ï—Å–ª–∏ —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∫–∞–∫ –µ—Å—Ç—å\n      audioFile = selectedFile;\n    } else if (recordedBlob) {\n      // –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º webm –≤ mp3\n      try {\n        audioFile = await convertWebmToMp3(recordedBlob);\n      } catch (error) {\n        console.error(\"[voices] –û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:\", error);\n        stopProgressLoop();\n        setIsUploading(false);\n        setIsWaiting(false);\n        showError(\"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.\");\n        return;\n      }\n    } else {\n      stopProgressLoop();\n      setIsUploading(false);\n      setIsWaiting(false);\n      showError(\"–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ –∑–∞–ø–∏—à–∏—Ç–µ –≥–æ–ª–æ—Å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞\");\n      return;\n    }\n\n    if (audioFile.size > MAX_FILE_SIZE) {\n      stopProgressLoop();\n      setIsUploading(false);\n      setIsWaiting(false);\n      showError(\n        `–§–∞–π–ª –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç ${MAX_FILE_SIZE_MB} –ú–ë. –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ${(audioFile.size / 1024 / 1024).toFixed(1)} –ú–ë`,\n      );\n      return;\n    }\n\n    try {\n      // –ü–æ–ª—É—á–∞–µ–º UUID –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n      const {\n        data: { user },\n        error: authError,\n      } = await supabase.auth.getUser();\n\n      if (authError || !user) {\n        throw new Error(\"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\");\n      }\n\n      const formData = new FormData();\n      formData.append(\"name\", voiceName.trim());\n      if (voiceDescription.trim()) {\n        const trimmedDescription = voiceDescription.trim().slice(0, MAX_DESCRIPTION_LENGTH);\n        formData.append(\"description\", trimmedDescription);\n      }\n      formData.append(\"file\", audioFile);\n      formData.append(\"uuid\", user.id);\n\n      const response = await fetch(\n        \"https://rueleven.ru/webhook/053aa1a5-396c-4cff-b9c4-a71ca8910a22\",\n        {\n          method: \"POST\",\n          body: formData,\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ${response.statusText}`);\n      }\n\n      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤–µ–±—Ö—É–∫ —Å UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥–æ–ª–æ—Å–∞\n      try {\n        await fetch(\"https://rueleven.ru/webhook/373bb6fa-8fae-49fd-83b6-b503e7f286c4\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({ uuid: user.id }),\n        });\n      } catch (webhookError) {\n        // –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –≤–µ–±—Ö—É–∫–∞, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è\n        console.error(\"[VoiceCreateModal] –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–µ–±—Ö—É–∫–∞ UUID:\", webhookError);\n      }\n\n      // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∂–¥–∞—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ (–ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω)\n      setIsUploading(false);\n\n      // –ñ–¥–µ–º –ø–æ—è–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ voices\n      const timeoutMs = 30000; // 30 —Å–µ–∫—É–Ω–¥ –º–∞–∫—Å–∏–º—É–º\n      const pollDelayMs = 1000; // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É\n      const deadline = Date.now() + timeoutMs;\n      let found = false;\n\n      while (Date.now() < deadline && !found) {\n        const { data, error } = await supabase\n          .from(\"voices\")\n          .select(\"*\")\n          .eq(\"uid\", user.id)\n          .eq(\"name\", voiceName.trim())\n          .order(\"created_at\", { ascending: false })\n          .limit(1);\n\n        if (!error && data && data.length > 0) {\n          found = true;\n          stopProgressLoop();\n          setProgress(100);\n          await new Promise((resolve) => setTimeout(resolve, 300)); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏\n          setIsWaiting(false);\n          await onVoiceCreated?.();\n          closeModal();\n          return;\n        }\n\n        await new Promise((resolve) => setTimeout(resolve, pollDelayMs));\n      }\n\n      // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –∑–∞ –æ—Ç–≤–µ–¥–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è\n      stopProgressLoop();\n      setIsWaiting(false);\n      showError(\"–ì–æ–ª–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ –≥–æ–ª–æ—Å–æ–≤ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥.\");\n      await onVoiceCreated?.();\n      closeModal();\n    } catch (error) {\n      console.error(\"[voices] –û—à–∏–±–∫–∞ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≥–æ–ª–æ—Å–∞:\", error);\n      stopProgressLoop();\n      setIsUploading(false);\n      setIsWaiting(false);\n      showError(\n        `–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥–æ–ª–æ—Å–∞: ${\n          error instanceof Error ? error.message : \"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞\"\n        }`\n      );\n    }\n  };\n\n  const dropZoneClasses = `rounded-2xl border border-dashed border-purple-400/50 bg-purple-50/30 p-6 text-center transition-all duration-200 ${\n    dragActive\n      ? \"shadow-lg -translate-y-0.5 border-purple-500\"\n      : \"hover:shadow-md hover:-translate-y-0.5\"\n  }`;\n\n  if (!isOpen) {\n    return null;\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-8\">\n      <div className=\"w-full max-w-lg rounded-[32px] bg-white shadow-2xl\">\n        <div className=\"relative flex items-center justify-center border-b px-6 py-4\">\n          <h2 className=\"text-lg font-semibold text-gray-900\">\n            –°–æ–∑–¥–∞—Ç—å –≥–æ–ª–æ—Å\n          </h2>\n          <button\n            type=\"button\"\n            onClick={closeModal}\n            className=\"absolute right-6 rounded-full p-1 text-gray-400 transition hover:bg-gray-100 hover:text-gray-600\"\n            disabled={isUploading || isRecording}\n          >\n            <span className=\"sr-only\">–ó–∞–∫—Ä—ã—Ç—å</span>‚úï\n          </button>\n        </div>\n\n        <div className=\"max-h-[70vh] overflow-y-auto px-6 py-6 [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full\">\n          <div className=\"space-y-6 text-sm text-gray-600\">\n            <div>\n              <label\n                htmlFor=\"voice-name\"\n                className=\"mb-2 block text-xs font-semibold uppercase tracking-wide text-gray-500\"\n              >\n                –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞\n              </label>\n              <input\n                id=\"voice-name\"\n                value={voiceName}\n                onChange={(event) => setVoiceName(event.target.value)}\n                placeholder=\"–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞\"\n                className=\"w-full rounded-2xl border border-gray-200 bg-gray-50 px-4 py-3 text-base text-gray-900 outline-none transition focus:border-gray-400\"\n                disabled={isUploading || isRecording}\n              />\n            </div>\n\n            <div>\n              <div className=\"mb-2 flex items-center justify-between\">\n                <label\n                  htmlFor=\"voice-description\"\n                  className=\"block text-xs font-semibold uppercase tracking-wide text-gray-500\"\n                >\n                  –û–ø–∏—Å–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞ <span className=\"text-gray-400\">(–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>\n                </label>\n                <span className={`text-xs ${\n                  voiceDescription.length > MAX_DESCRIPTION_LENGTH \n                    ? \"text-red-500\" \n                    : \"text-gray-400\"\n                }`}>\n                  {voiceDescription.length}/{MAX_DESCRIPTION_LENGTH}\n                </span>\n              </div>\n              <textarea\n                id=\"voice-description\"\n                value={voiceDescription}\n                onChange={(event) => {\n                  const value = event.target.value;\n                  if (value.length <= MAX_DESCRIPTION_LENGTH) {\n                    setVoiceDescription(value);\n                  }\n                }}\n                maxLength={MAX_DESCRIPTION_LENGTH}\n                placeholder=\"–î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞\"\n                className=\"h-28 w-full rounded-2xl border border-gray-200 bg-gray-50 px-4 py-3 text-base text-gray-900 outline-none transition focus:border-gray-400\"\n                disabled={isUploading || isRecording}\n              />\n            </div>\n\n            {/* –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ */}\n            <div\n              className={dropZoneClasses}\n              onDragEnter={handleDrag}\n              onDragLeave={handleDrag}\n              onDragOver={handleDrag}\n              onDrop={handleDrop}\n            >\n              <div className=\"mx-auto flex max-w-sm flex-col items-center gap-3 text-gray-700\">\n                <div className=\"rounded-2xl border border-purple-200 bg-white p-3 text-purple-500\">\n                  ‚Üë\n                </div>\n                <p className=\"text-base font-semibold\">\n                  –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∞—É–¥–∏–æ —Ñ–∞–π–ª —Å—é–¥–∞\n                </p>\n                <p className=\"text-xs text-gray-500\">MP3, WAV –¥–æ 11 –ú–ë</p>\n                <button\n                  type=\"button\"\n                  className=\"rounded-lg bg-purple-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-purple-500 disabled:opacity-50\"\n                  onClick={() => fileInputRef.current?.click()}\n                  disabled={isUploading || isRecording}\n                >\n                  –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª\n                </button>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"audio/*\"\n                  className=\"hidden\"\n                  onChange={handleFileSelect}\n                  disabled={isUploading || isRecording}\n                />\n              </div>\n            </div>\n\n            {/* –í—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–∞–π–ª */}\n            {selectedFile && (\n              <div className=\"rounded-2xl border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-700\">\n                <div className=\"flex items-center justify-between gap-3\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"rounded-lg bg-purple-100 p-2 text-purple-600\">\n                      üéµ\n                    </div>\n                    <div>\n                      <div className=\"font-medium\">{selectedFile.name}</div>\n                      <div className=\"text-xs text-gray-500\">\n                        {(selectedFile.size / 1024 / 1024).toFixed(2)} –ú–ë\n                      </div>\n                    </div>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={() => setSelectedFile(null)}\n                    className=\"text-gray-400 transition hover:text-red-500\"\n                    disabled={isUploading || isRecording}\n                  >\n                    ‚úï\n                  </button>\n                </div>\n              </div>\n            )}\n\n            {/* –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å */}\n            <div className=\"relative\">\n              <div className=\"absolute inset-0 flex items-center\">\n                <div className=\"w-full border-t border-gray-200\"></div>\n              </div>\n              <div className=\"relative flex justify-center text-xs uppercase\">\n                <span className=\"bg-white px-2 text-gray-500\">–∏–ª–∏</span>\n              </div>\n            </div>\n\n            {/* –ó–∞–ø–∏—Å—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ */}\n            <div className=\"rounded-2xl border border-gray-200 bg-gray-50 p-6 text-center\">\n              <div className=\"mx-auto flex max-w-sm flex-col items-center gap-4\">\n                <div className=\"rounded-full border-4 border-purple-200 bg-white p-4\">\n                  {isRecording ? (\n                    <div className=\"h-12 w-12 animate-pulse rounded-full bg-red-500\"></div>\n                  ) : (\n                    <div className=\"h-12 w-12 rounded-full bg-purple-500\"></div>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-base font-semibold text-gray-900\">\n                    {isRecording ? \"–ò–¥–µ—Ç –∑–∞–ø–∏—Å—å...\" : \"–ó–∞–ø–∏—Å–∞—Ç—å —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞\"}\n                  </p>\n                  <p className=\"mt-1 text-xs text-gray-500\">\n                    {isRecording\n                      ? \"–ù–∞–∂–º–∏—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏\"\n                      : \"–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –æ—Ç—Ä—ã–≤–æ–∫ –ª—é–±–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º–µ (–Ω–µ –º–µ–Ω–µ–µ 2 –º–∏–Ω—É—Ç)\"}\n                  </p>\n                </div>\n                \n                {/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≥—Ä–æ–º–∫–æ—Å—Ç–∏ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ–≥–¥–∞ –∫–æ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –∏–ª–∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º */}\n                {(isTestingMicrophone || isRecording) && (\n                  <div className=\"w-full space-y-1.5\">\n                    <p className=\"text-xs font-medium text-gray-600\">\n                      –¢–µ—Å—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞\n                    </p>\n                    <div className=\"relative h-1.5 w-full overflow-hidden rounded-full bg-gray-200\">\n                      <div\n                        className=\"absolute inset-y-0 left-0 rounded-full bg-gradient-to-r from-transparent via-purple-500/50 to-purple-600 transition-all duration-75 ease-out\"\n                        style={{ width: `${Math.max(2, audioLevel)}%` }}\n                      />\n                    </div>\n                  </div>\n                )}\n                \n                {/* –¢–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ */}\n                {isRecording && (\n                  <div className=\"w-full\">\n                    <div className=\"rounded-lg bg-purple-50 px-4 py-2\">\n                      <p className=\"text-sm font-semibold text-purple-700\">\n                        –û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏: {Math.floor(recordingTimer / 60)}:{(recordingTimer % 60).toString().padStart(2, '0')}\n                      </p>\n                    </div>\n                  </div>\n                )}\n                \n                {!isRecording ? (\n                  <button\n                    type=\"button\"\n                    onClick={startRecording}\n                    className=\"rounded-lg bg-purple-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-purple-500 disabled:opacity-50\"\n                    disabled={isUploading || !!selectedFile}\n                  >\n                    –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å\n                  </button>\n                ) : (\n                  <button\n                    type=\"button\"\n                    onClick={stopRecording}\n                    className=\"rounded-lg bg-red-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-red-500\"\n                  >\n                    –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å\n                  </button>\n                )}\n              </div>\n            </div>\n\n            {/* –ó–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Ñ–∞–π–ª */}\n            {recordedBlob && !isRecording && recordedAudioUrl && (\n              <div className=\"rounded-2xl border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-700\">\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between gap-3\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"rounded-lg bg-green-100 p-2 text-green-600\">\n                        ‚úì\n                      </div>\n                      <div>\n                        <div className=\"font-medium\">–ó–∞–ø–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞</div>\n                        <div className=\"text-xs text-gray-500\">\n                          {(recordedBlob.size / 1024).toFixed(2)} –ö–ë\n                        </div>\n                      </div>\n                    </div>\n                    <button\n                      type=\"button\"\n                      onClick={() => {\n                        setRecordedBlob(null);\n                        if (recordedAudioUrl) {\n                          URL.revokeObjectURL(recordedAudioUrl);\n                        }\n                        setRecordedAudioUrl(null);\n                      }}\n                      className=\"text-gray-400 transition hover:text-red-500\"\n                      disabled={isUploading}\n                    >\n                      ‚úï\n                    </button>\n                  </div>\n                  {/* –ê—É–¥–∏–æ –ø–ª–µ–µ—Ä */}\n                  <div className=\"flex items-center gap-2 rounded-lg bg-white p-2\">\n                    <audio\n                      ref={audioPlayerRef}\n                      src={recordedAudioUrl}\n                      controls\n                      className=\"flex-1\"\n                      style={{ height: \"32px\" }}\n                    />\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"flex flex-col gap-3 border-t border-gray-200 px-6 py-4 text-sm text-gray-500 sm:flex-row sm:items-center sm:justify-between sm:gap-4\">\n          <div className=\"flex flex-1 items-center gap-4\">\n            <button\n              type=\"button\"\n              onClick={closeModal}\n              className=\"rounded-lg border border-gray-200 px-5 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50\"\n              disabled={isUploading || isRecording || isWaiting}\n            >\n              –û—Ç–º–µ–Ω–∞\n            </button>\n            {(isUploading || isWaiting || progress > 0) && (\n              <div className=\"relative h-1 flex-1 overflow-hidden rounded-full bg-gray-200\">\n                <div\n                  className=\"absolute inset-y-0 left-0 rounded-full bg-gradient-to-r from-purple-500 via-purple-600 to-purple-500 transition-[width] duration-100 ease-out\"\n                  style={{ width: `${progress}%` }}\n                  aria-hidden=\"true\"\n                />\n              </div>\n            )}\n          </div>\n          <button\n            type=\"button\"\n            onClick={handleCloneVoice}\n            disabled={\n              isUploading ||\n              isRecording ||\n              isWaiting ||\n              !voiceName.trim() ||\n              (!selectedFile && !recordedBlob)\n            }\n            className=\"rounded-lg bg-purple-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-purple-500 disabled:cursor-not-allowed disabled:bg-gray-300 sm:ml-auto\"\n          >\n            {isUploading\n              ? \"–ö–ª–æ–Ω–∏—Ä—É–µ–º...\"\n              : isWaiting\n                ? \"–û–∂–∏–¥–∞–µ–º...\"\n                : \"–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≥–æ–ª–æ—Å\"}\n          </button>\n        </div>\n      </div>\n\n      {/* –ö–∞—Å—Ç–æ–º–Ω—ã–π –º–æ–¥–∞–ª –æ—à–∏–±–∫–∏ */}\n      {errorModal.isOpen && (\n        <div \n          className=\"fixed inset-0 z-[60] flex items-center justify-center bg-black/50\"\n          onMouseDown={(e) => {\n            if (e.target === e.currentTarget) {\n              setErrorModal({ isOpen: false, message: \"\" });\n            }\n          }}\n        >\n          <div \n            className=\"mx-4 w-full max-w-md rounded-3xl border border-gray-100 bg-white p-6 shadow-sm ring-1 ring-black/5\"\n            onMouseDown={(e) => e.stopPropagation()}\n          >\n            <div className=\"mb-4 flex items-center justify-between\">\n              <h2 className=\"text-xl font-semibold text-gray-900\">\n                –û—à–∏–±–∫–∞\n              </h2>\n              <button\n                type=\"button\"\n                onClick={() => setErrorModal({ isOpen: false, message: \"\" })}\n                className=\"rounded-full p-1 text-gray-400 transition hover:bg-gray-100 hover:text-gray-600\"\n              >\n                <span className=\"sr-only\">–ó–∞–∫—Ä—ã—Ç—å</span>\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n            <div className=\"mb-6\">\n              <p className=\"whitespace-pre-line text-sm text-gray-600\">\n                {errorModal.message}\n              </p>\n            </div>\n            <div className=\"flex justify-end\">\n              <button\n                type=\"button\"\n                onClick={() => setErrorModal({ isOpen: false, message: \"\" })}\n                className=\"rounded-lg border border-purple-600 bg-purple-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-purple-700\"\n              >\n                OK\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1882, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/app/voices/components/VoiceCard.tsx"],"sourcesContent":["\"use client\";\n\nimport { ReactNode, useEffect, useRef, useState } from \"react\";\n\ninterface VoiceCardProps {\n  name: string;\n  url: string;\n  description?: string | null;\n  menuSlot?: ReactNode;\n  onMouseEnter?: () => void;\n  onMouseLeave?: () => void;\n}\n\nexport function VoiceCard({\n  name,\n  url,\n  description,\n  menuSlot,\n  onMouseEnter,\n  onMouseLeave,\n}: VoiceCardProps) {\n  const [isPlaying, setIsPlaying] = useState(false);\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n  const formattedDescription = description?.trim() ?? \"\";\n\n  const handlePlay = () => {\n    if (!audioRef.current) {\n      audioRef.current = new Audio(url);\n      audioRef.current.onended = () => setIsPlaying(false);\n      audioRef.current.onerror = () => {\n        setIsPlaying(false);\n        alert(\"–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ\");\n      };\n    }\n\n    if (isPlaying) {\n      audioRef.current.pause();\n      audioRef.current.currentTime = 0;\n      setIsPlaying(false);\n    } else {\n      audioRef.current.play();\n      setIsPlaying(true);\n    }\n  };\n\n  useEffect(() => {\n    return () => {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current = null;\n      }\n    };\n  }, []);\n\n  return (\n    <article\n      className=\"group relative rounded-3xl border border-gray-100 bg-white p-6 shadow-sm ring-1 ring-black/5 transition-all duration-300 hover:-translate-y-2 hover:shadow-lg\"\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n    >\n      {menuSlot}\n      <div className=\"flex items-center gap-4\">\n        <button\n          type=\"button\"\n          onClick={handlePlay}\n          className=\"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-purple-600 text-white transition hover:bg-purple-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-purple-600\"\n          aria-label={isPlaying ? \"–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ\" : \"–ü—Ä–æ–∏–≥—Ä–∞—Ç—å –≥–æ–ª–æ—Å\"}\n        >\n          {isPlaying ? (\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n              fill=\"currentColor\"\n              className=\"h-6 w-6\"\n            >\n              <path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\" />\n            </svg>\n          ) : (\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n              fill=\"currentColor\"\n              className=\"h-6 w-6\"\n            >\n              <path d=\"M8 5v14l11-7z\" />\n            </svg>\n          )}\n        </button>\n        <div className=\"min-w-0 flex-1\">\n          <p className=\"text-xl font-semibold text-gray-900\">{name}</p>\n        </div>\n      </div>\n      <p className=\"mt-4 text-sm text-gray-600\">\n        <span className=\"font-semibold text-gray-900\">–û–ø–∏—Å–∞–Ω–∏–µ:</span>{\" \"}\n        {formattedDescription || \"–ù–µ —É–∫–∞–∑–∞–Ω–æ\"}\n      </p>\n    </article>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAaO,SAAS,UAAU,EACxB,IAAI,EACJ,GAAG,EACH,WAAW,EACX,QAAQ,EACR,YAAY,EACZ,YAAY,EACG;IACf,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,WAAW,IAAA,+MAAM,EAA0B;IACjD,MAAM,uBAAuB,aAAa,UAAU;IAEpD,MAAM,aAAa;QACjB,IAAI,CAAC,SAAS,OAAO,EAAE;YACrB,SAAS,OAAO,GAAG,IAAI,MAAM;YAC7B,SAAS,OAAO,CAAC,OAAO,GAAG,IAAM,aAAa;YAC9C,SAAS,OAAO,CAAC,OAAO,GAAG;gBACzB,aAAa;gBACb,MAAM;YACR;QACF;QAEA,IAAI,WAAW;YACb,SAAS,OAAO,CAAC,KAAK;YACtB,SAAS,OAAO,CAAC,WAAW,GAAG;YAC/B,aAAa;QACf,OAAO;YACL,SAAS,OAAO,CAAC,IAAI;YACrB,aAAa;QACf;IACF;IAEA,IAAA,kNAAS,EAAC;QACR,OAAO;YACL,IAAI,SAAS,OAAO,EAAE;gBACpB,SAAS,OAAO,CAAC,KAAK;gBACtB,SAAS,OAAO,GAAG;YACrB;QACF;IACF,GAAG,EAAE;IAEL,qBACE,8OAAC;QACC,WAAU;QACV,cAAc;QACd,cAAc;;YAEb;0BACD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,SAAS;wBACT,WAAU;wBACV,cAAY,YAAY,+BAA+B;kCAEtD,0BACC,8OAAC;4BACC,OAAM;4BACN,SAAQ;4BACR,MAAK;4BACL,WAAU;sCAEV,cAAA,8OAAC;gCAAK,GAAE;;;;;;;;;;iDAGV,8OAAC;4BACC,OAAM;4BACN,SAAQ;4BACR,MAAK;4BACL,WAAU;sCAEV,cAAA,8OAAC;gCAAK,GAAE;;;;;;;;;;;;;;;;kCAId,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAE,WAAU;sCAAuC;;;;;;;;;;;;;;;;;0BAGxD,8OAAC;gBAAE,WAAU;;kCACX,8OAAC;wBAAK,WAAU;kCAA8B;;;;;;oBAAiB;oBAC9D,wBAAwB;;;;;;;;;;;;;AAIjC"}},
    {"offset": {"line": 2024, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/app/voices/components/VoiceDeleteModal.tsx"],"sourcesContent":["\"use client\";\r\n\r\ninterface VoiceDeleteModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onConfirm: () => void | Promise<void>;\r\n  voiceName: string;\r\n  isDeleting?: boolean;\r\n}\r\n\r\nexport function VoiceDeleteModal({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  voiceName,\r\n  isDeleting = false,\r\n}: VoiceDeleteModalProps) {\r\n  if (!isOpen) {\r\n    return null;\r\n  }\r\n\r\n  const handleConfirm = async () => {\r\n    await onConfirm();\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\r\n      <div className=\"mx-4 w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl\">\r\n        <h2 className=\"mb-4 text-xl font-semibold text-gray-900\">\r\n          –£–¥–∞–ª–µ–Ω–∏–µ –≥–æ–ª–æ—Å–∞\r\n        </h2>\r\n        <p className=\"mb-6 text-gray-600\">\r\n          –í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≥–æ–ª–æ—Å ¬´{voiceName}¬ª?\r\n        </p>\r\n        <div className=\"flex gap-3\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            disabled={isDeleting}\r\n            className=\"flex-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50 disabled:opacity-50\"\r\n          >\r\n            –û—Ç–º–µ–Ω–∞\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleConfirm}\r\n            disabled={isDeleting}\r\n            className=\"flex-1 rounded-lg bg-red-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-red-700 disabled:opacity-50\"\r\n          >\r\n            {isDeleting ? \"–£–¥–∞–ª—è–µ–º...\" : \"–£–¥–∞–ª–∏—Ç—å\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;AAAA;;AAUO,SAAS,iBAAiB,EAC/B,MAAM,EACN,OAAO,EACP,SAAS,EACT,SAAS,EACT,aAAa,KAAK,EACI;IACtB,IAAI,CAAC,QAAQ;QACX,OAAO;IACT;IAEA,MAAM,gBAAgB;QACpB,MAAM;IACR;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAA2C;;;;;;8BAGzD,8OAAC;oBAAE,WAAU;;wBAAqB;wBACQ;wBAAU;;;;;;;8BAEpD,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,MAAK;4BACL,SAAS;4BACT,UAAU;4BACV,WAAU;sCACX;;;;;;sCAGD,8OAAC;4BACC,MAAK;4BACL,SAAS;4BACT,UAAU;4BACV,WAAU;sCAET,aAAa,eAAe;;;;;;;;;;;;;;;;;;;;;;;AAMzC"}},
    {"offset": {"line": 2110, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/app/voices/components/VoiceEditModal.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  type KeyboardEvent as ReactKeyboardEvent,\n  useEffect,\n  useState,\n} from \"react\";\n\nexport interface VoiceEditFormValues {\n  name: string;\n  description: string;\n}\n\nconst MAX_DESCRIPTION_LENGTH = 100;\n\ninterface VoiceEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: (values: VoiceEditFormValues) => void | Promise<void>;\n  currentName: string;\n  currentDescription: string;\n  isSaving?: boolean;\n}\n\nexport function VoiceEditModal({\n  isOpen,\n  onClose,\n  onConfirm,\n  currentName,\n  currentDescription,\n  isSaving = false,\n}: VoiceEditModalProps) {\n  const [formValues, setFormValues] = useState<VoiceEditFormValues>({\n    name: currentName,\n    description: currentDescription,\n  });\n\n  useEffect(() => {\n    if (isOpen) {\n      setFormValues({\n        name: currentName,\n        description: currentDescription,\n      });\n    }\n  }, [isOpen, currentName, currentDescription]);\n\n  if (!isOpen) {\n    return null;\n  }\n\n  const handleConfirm = async () => {\n    if (!formValues.name.trim()) {\n      return;\n    }\n\n    await onConfirm({\n      name: formValues.name.trim(),\n      description: formValues.description.trim().slice(0, MAX_DESCRIPTION_LENGTH),\n    });\n  };\n\n  const handleKeyDown = (\n    event: ReactKeyboardEvent<HTMLInputElement | HTMLTextAreaElement>\n  ) => {\n    const isTextarea = event.currentTarget.tagName === \"TEXTAREA\";\n    if (\n      event.key === \"Enter\" &&\n      !isTextarea &&\n      !isSaving &&\n      formValues.name.trim()\n    ) {\n      event.preventDefault();\n      handleConfirm();\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n      <div className=\"mx-4 w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl\">\n        <h2 className=\"mb-4 text-xl font-semibold text-gray-900\">\n          –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–æ–ª–æ—Å\n        </h2>\n        <div className=\"space-y-4\">\n          <div>\n            <label\n              htmlFor=\"voice-name\"\n              className=\"mb-2 block text-xs font-semibold uppercase tracking-wide text-gray-500\"\n            >\n              –ò–º—è\n            </label>\n            <input\n              id=\"voice-name\"\n              type=\"text\"\n              value={formValues.name}\n              onChange={(event) =>\n                setFormValues((prev) => ({ ...prev, name: event.target.value }))\n              }\n              onKeyDown={handleKeyDown}\n              disabled={isSaving}\n              placeholder=\"–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è\"\n              className=\"w-full rounded-lg border border-gray-300 bg-white px-4 py-2 text-base text-gray-900 outline-none transition focus:border-gray-400 disabled:opacity-50\"\n              autoFocus\n            />\n          </div>\n          <div>\n            <div className=\"mb-2 flex items-center justify-between\">\n              <label\n                htmlFor=\"voice-description\"\n                className=\"block text-xs font-semibold uppercase tracking-wide text-gray-500\"\n              >\n                –û–ø–∏—Å–∞–Ω–∏–µ\n              </label>\n              <span className={`text-xs ${\n                formValues.description.length > MAX_DESCRIPTION_LENGTH \n                  ? \"text-red-500\" \n                  : \"text-gray-400\"\n              }`}>\n                {formValues.description.length}/{MAX_DESCRIPTION_LENGTH}\n              </span>\n            </div>\n            <textarea\n              id=\"voice-description\"\n              value={formValues.description}\n              onChange={(event) => {\n                const value = event.target.value;\n                if (value.length <= MAX_DESCRIPTION_LENGTH) {\n                  setFormValues((prev) => ({\n                    ...prev,\n                    description: value,\n                  }));\n                }\n              }}\n              maxLength={MAX_DESCRIPTION_LENGTH}\n              onKeyDown={handleKeyDown}\n              disabled={isSaving}\n              placeholder=\"–î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞\"\n              className=\"h-28 w-full rounded-lg border border-gray-300 bg-white px-4 py-2 text-base text-gray-900 outline-none transition focus:border-gray-400 disabled:opacity-50\"\n            />\n          </div>\n        </div>\n        <div className=\"mt-6 flex gap-3\">\n          <button\n            type=\"button\"\n            onClick={onClose}\n            disabled={isSaving}\n            className=\"flex-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50 disabled:opacity-50\"\n          >\n            –û—Ç–º–µ–Ω–∞\n          </button>\n          <button\n            type=\"button\"\n            onClick={handleConfirm}\n            disabled={isSaving || !formValues.name.trim()}\n            className=\"flex-1 rounded-lg bg-purple-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-purple-700 disabled:opacity-50\"\n          >\n            {isSaving ? \"–°–æ—Ö—Ä–∞–Ω—è–µ–º...\" : \"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAaA,MAAM,yBAAyB;AAWxB,SAAS,eAAe,EAC7B,MAAM,EACN,OAAO,EACP,SAAS,EACT,WAAW,EACX,kBAAkB,EAClB,WAAW,KAAK,EACI;IACpB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAsB;QAChE,MAAM;QACN,aAAa;IACf;IAEA,IAAA,kNAAS,EAAC;QACR,IAAI,QAAQ;YACV,cAAc;gBACZ,MAAM;gBACN,aAAa;YACf;QACF;IACF,GAAG;QAAC;QAAQ;QAAa;KAAmB;IAE5C,IAAI,CAAC,QAAQ;QACX,OAAO;IACT;IAEA,MAAM,gBAAgB;QACpB,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,IAAI;YAC3B;QACF;QAEA,MAAM,UAAU;YACd,MAAM,WAAW,IAAI,CAAC,IAAI;YAC1B,aAAa,WAAW,WAAW,CAAC,IAAI,GAAG,KAAK,CAAC,GAAG;QACtD;IACF;IAEA,MAAM,gBAAgB,CACpB;QAEA,MAAM,aAAa,MAAM,aAAa,CAAC,OAAO,KAAK;QACnD,IACE,MAAM,GAAG,KAAK,WACd,CAAC,cACD,CAAC,YACD,WAAW,IAAI,CAAC,IAAI,IACpB;YACA,MAAM,cAAc;YACpB;QACF;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAA2C;;;;;;8BAGzD,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;;8CACC,8OAAC;oCACC,SAAQ;oCACR,WAAU;8CACX;;;;;;8CAGD,8OAAC;oCACC,IAAG;oCACH,MAAK;oCACL,OAAO,WAAW,IAAI;oCACtB,UAAU,CAAC,QACT,cAAc,CAAC,OAAS,CAAC;gDAAE,GAAG,IAAI;gDAAE,MAAM,MAAM,MAAM,CAAC,KAAK;4CAAC,CAAC;oCAEhE,WAAW;oCACX,UAAU;oCACV,aAAY;oCACZ,WAAU;oCACV,SAAS;;;;;;;;;;;;sCAGb,8OAAC;;8CACC,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,SAAQ;4CACR,WAAU;sDACX;;;;;;sDAGD,8OAAC;4CAAK,WAAW,CAAC,QAAQ,EACxB,WAAW,WAAW,CAAC,MAAM,GAAG,yBAC5B,iBACA,iBACJ;;gDACC,WAAW,WAAW,CAAC,MAAM;gDAAC;gDAAE;;;;;;;;;;;;;8CAGrC,8OAAC;oCACC,IAAG;oCACH,OAAO,WAAW,WAAW;oCAC7B,UAAU,CAAC;wCACT,MAAM,QAAQ,MAAM,MAAM,CAAC,KAAK;wCAChC,IAAI,MAAM,MAAM,IAAI,wBAAwB;4CAC1C,cAAc,CAAC,OAAS,CAAC;oDACvB,GAAG,IAAI;oDACP,aAAa;gDACf,CAAC;wCACH;oCACF;oCACA,WAAW;oCACX,WAAW;oCACX,UAAU;oCACV,aAAY;oCACZ,WAAU;;;;;;;;;;;;;;;;;;8BAIhB,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,MAAK;4BACL,SAAS;4BACT,UAAU;4BACV,WAAU;sCACX;;;;;;sCAGD,8OAAC;4BACC,MAAK;4BACL,SAAS;4BACT,UAAU,YAAY,CAAC,WAAW,IAAI,CAAC,IAAI;4BAC3C,WAAU;sCAET,WAAW,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;AAMzC"}},
    {"offset": {"line": 2320, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/app/voices/servers/DeleteVoice.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\nif (!supabaseUrl) {\n  throw new Error(\"NEXT_PUBLIC_SUPABASE_URL –Ω–µ –∑–∞–¥–∞–Ω\");\n}\n\nif (!supabaseServiceRoleKey) {\n  throw new Error(\"SUPABASE_SERVICE_ROLE_KEY –Ω–µ –∑–∞–¥–∞–Ω\");\n}\n\nconst supabaseAdmin = createClient(supabaseUrl, supabaseServiceRoleKey);\n\ninterface DeleteVoiceInput {\n  uid: string;\n  voiceId: string;\n}\n\ninterface DeleteVoiceResult {\n  success: boolean;\n  error?: string;\n}\n\nexport async function DeleteVoice({\n  uid,\n  voiceId,\n}: DeleteVoiceInput): Promise<DeleteVoiceResult> {\n  try {\n    if (!uid) {\n      return { success: false, error: \"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω\" };\n    }\n\n    if (!voiceId) {\n      return { success: false, error: \"ID –≥–æ–ª–æ—Å–∞ –Ω–µ —É–∫–∞–∑–∞–Ω\" };\n    }\n\n    // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –∑–∞–ø–∏—Å—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã, —á—Ç–æ–±—ã –∏–∑–≤–ª–µ—á—å voice_id –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞\n    const { data: voiceRecord, error: fetchError } = await supabaseAdmin\n      .from(\"voices\")\n      .select(\"voice_id, name\")\n      .eq(\"id\", voiceId)\n      .eq(\"uid\", uid)\n      .single();\n\n    if (fetchError) {\n      throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –≥–æ–ª–æ—Å: ${fetchError.message}`);\n    }\n\n    if (!voiceRecord || !voiceRecord.voice_id) {\n      throw new Error(\"–ù–µ –Ω–∞–π–¥–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ voice_id –¥–ª—è —ç—Ç–æ–≥–æ –≥–æ–ª–æ—Å–∞\");\n    }\n\n    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤–µ–±—Ö—É–∫ —Å voice_id, –Ω–∞–∑–≤–∞–Ω–∏–µ–º –≥–æ–ª–æ—Å–∞ –∏ UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n    const webhookResponse = await fetch(\n      \"https://rueleven.ru/webhook/932aee6f-b554-45e9-b232-f7829b0a1d06\",\n      {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ \n          voice_id: voiceRecord.voice_id,\n          voice_name: voiceRecord.name || null,\n          uuid: uid,\n        }),\n      }\n    );\n\n    if (!webhookResponse.ok) {\n      const message = await webhookResponse.text();\n      throw new Error(\n        `–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–µ–±—Ö—É–∫: ${\n          message || webhookResponse.statusText\n        }`\n      );\n    }\n\n    // –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã\n    const { error } = await supabaseAdmin\n      .from(\"voices\")\n      .delete()\n      .eq(\"id\", voiceId)\n      .eq(\"uid\", uid);\n\n    if (error) {\n      throw new Error(error.message);\n    }\n\n    return { success: true };\n  } catch (error) {\n    const message =\n      error instanceof Error ? error.message : \"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞\";\n    console.error(\"[DeleteVoice]\", message);\n    return { success: false, error: message };\n  }\n}\n\n\n"],"names":[],"mappings":";;;;;;;IA2BsB,cAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA"}},
    {"offset": {"line": 2332, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/app/voices/servers/UpdateVoice.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nif (!supabaseUrl) {\r\n  throw new Error(\"NEXT_PUBLIC_SUPABASE_URL –Ω–µ –∑–∞–¥–∞–Ω\");\r\n}\r\n\r\nif (!supabaseServiceRoleKey) {\r\n  throw new Error(\"SUPABASE_SERVICE_ROLE_KEY –Ω–µ –∑–∞–¥–∞–Ω\");\r\n}\r\n\r\nconst supabaseAdmin = createClient(supabaseUrl, supabaseServiceRoleKey);\r\n\r\ninterface UpdateVoiceInput {\r\n  uid: string;\r\n  voiceId: string;\r\n  name: string;\r\n  description?: string | null;\r\n}\r\n\r\ninterface UpdateVoiceResult {\r\n  success: boolean;\r\n  error?: string;\r\n}\r\n\r\nexport async function UpdateVoice({\r\n  uid,\r\n  voiceId,\r\n  name,\r\n  description,\r\n}: UpdateVoiceInput): Promise<UpdateVoiceResult> {\r\n  try {\r\n    if (!uid) {\r\n      return { success: false, error: \"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω\" };\r\n    }\r\n\r\n    if (!voiceId) {\r\n      return { success: false, error: \"ID –≥–æ–ª–æ—Å–∞ –Ω–µ —É–∫–∞–∑–∞–Ω\" };\r\n    }\r\n\r\n    if (!name || !name.trim()) {\r\n      return { success: false, error: \"–ò–º—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º\" };\r\n    }\r\n\r\n    const trimmedName = name.trim();\r\n    const trimmedDescription = description?.trim();\r\n\r\n    const { error } = await supabaseAdmin\r\n      .from(\"voices\")\r\n      .update({\r\n        name: trimmedName,\r\n        description: trimmedDescription || null,\r\n      })\r\n      .eq(\"id\", voiceId)\r\n      .eq(\"uid\", uid);\r\n\r\n    if (error) {\r\n      throw new Error(error.message);\r\n    }\r\n\r\n    return { success: true };\r\n  } catch (error) {\r\n    const message =\r\n      error instanceof Error ? error.message : \"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞\";\r\n    console.error(\"[UpdateVoice]\", message);\r\n    return { success: false, error: message };\r\n  }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;;;IA6BsB,cAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA"}},
    {"offset": {"line": 2344, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/app/voices/components/VoiceGrid.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  type MouseEvent as ReactMouseEvent,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { VoiceCard } from \"./VoiceCard\";\nimport { VoiceDeleteModal } from \"./VoiceDeleteModal\";\nimport { VoiceEditModal, type VoiceEditFormValues } from \"./VoiceEditModal\";\nimport { DeleteVoice } from \"../servers/DeleteVoice\";\nimport { UpdateVoice } from \"../servers/UpdateVoice\";\n\ninterface VoiceRow {\n  id?: string;\n  uid: string;\n  name: string;\n  url: string;\n  created_at?: string;\n  description?: string | null;\n}\n\ninterface VoiceGridProps {\n  voices: VoiceRow[];\n  currentUserId?: string | null;\n  onVoicesChanged?: () => void | Promise<void>;\n}\n\nexport function VoiceGrid({\n  voices,\n  currentUserId,\n  onVoicesChanged,\n}: VoiceGridProps) {\n  const [openMenuId, setOpenMenuId] = useState<string | null>(null);\n  const [hoveredCardId, setHoveredCardId] = useState<string | null>(null);\n  const [voiceToDelete, setVoiceToDelete] = useState<{\n    voice: VoiceRow;\n    key: string;\n  } | null>(null);\n  const [voiceToEdit, setVoiceToEdit] = useState<{\n    voice: VoiceRow;\n    key: string;\n  } | null>(null);\n  const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n  const [deletingId, setDeletingId] = useState<string | null>(null);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const menuRefs = useRef<Record<string, HTMLDivElement | null>>({});\n  const closeMenuTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (openMenuId) {\n        const menuElement = menuRefs.current[openMenuId];\n        if (menuElement && !menuElement.contains(event.target as Node)) {\n          setOpenMenuId(null);\n        }\n      }\n    };\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [openMenuId]);\n\n  useEffect(() => {\n    return () => {\n      if (closeMenuTimeoutRef.current) {\n        clearTimeout(closeMenuTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  if (voices.length === 0) {\n    return null;\n  }\n\n  const validVoices = voices.filter((voice) => voice.url && voice.name);\n\n  if (validVoices.length === 0) {\n    console.warn(\"[VoiceGrid] –ù–µ—Ç –≤–∞–ª–∏–¥–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è\");\n    return null;\n  }\n\n  const handleMenuClick = (key: string, event: ReactMouseEvent) => {\n    event.stopPropagation();\n    setOpenMenuId((prev) => (prev === key ? null : key));\n  };\n\n  const handleDeleteClick = (voice: VoiceRow, key: string) => {\n    if (!currentUserId) {\n      alert(\"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\");\n      return;\n    }\n    if (!voice.id) {\n      alert(\"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥–æ–ª–æ—Å–∞\");\n      return;\n    }\n    setOpenMenuId(null);\n    setVoiceToDelete({ voice, key });\n    setIsDeleteModalOpen(true);\n  };\n\n  const handleEditClick = (voice: VoiceRow, key: string) => {\n    if (!currentUserId) {\n      alert(\"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\");\n      return;\n    }\n    if (!voice.id) {\n      alert(\"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥–æ–ª–æ—Å–∞\");\n      return;\n    }\n    setOpenMenuId(null);\n    setVoiceToEdit({ voice, key });\n    setIsEditModalOpen(true);\n  };\n\n  const handleDeleteConfirm = async () => {\n    if (!voiceToDelete || !currentUserId || !voiceToDelete.voice.id) {\n      return;\n    }\n\n    try {\n      setDeletingId(voiceToDelete.voice.id);\n      const result = await DeleteVoice({\n        uid: currentUserId,\n        voiceId: voiceToDelete.voice.id,\n      });\n\n      if (!result.success) {\n        throw new Error(result.error || \"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –≥–æ–ª–æ—Å\");\n      }\n\n      setIsDeleteModalOpen(false);\n      setVoiceToDelete(null);\n      await onVoicesChanged?.();\n    } catch (error) {\n      console.error(\"[voices] –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:\", error);\n      alert(\n        `–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: ${\n          error instanceof Error ? error.message : \"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞\"\n        }`\n      );\n    } finally {\n      setDeletingId(null);\n    }\n  };\n\n  const handleEditConfirm = async ({ name, description }: VoiceEditFormValues) => {\n    if (!voiceToEdit || !currentUserId || !voiceToEdit.voice.id) {\n      return;\n    }\n\n    try {\n      setEditingId(voiceToEdit.voice.id);\n      const result = await UpdateVoice({\n        uid: currentUserId,\n        voiceId: voiceToEdit.voice.id,\n        name,\n        description,\n      });\n\n      if (!result.success) {\n        throw new Error(result.error || \"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –≥–æ–ª–æ—Å\");\n      }\n\n      setIsEditModalOpen(false);\n      setVoiceToEdit(null);\n      await onVoicesChanged?.();\n    } catch (error) {\n      console.error(\"[voices] –û—à–∏–±–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:\", error);\n      alert(\n        `–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏: ${\n          error instanceof Error ? error.message : \"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞\"\n        }`\n      );\n    } finally {\n      setEditingId(null);\n    }\n  };\n\n  const handleDeleteCancel = () => {\n    setIsDeleteModalOpen(false);\n    setVoiceToDelete(null);\n  };\n\n  const handleEditCancel = () => {\n    setIsEditModalOpen(false);\n    setVoiceToEdit(null);\n  };\n\n  return (\n    <div className=\"grid w-full gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\">\n      {validVoices.map((voice) => {\n        const key = voice.id ?? `${voice.uid}-${voice.name}`;\n        const isHovered = hoveredCardId === key;\n        const showMenuButton = isHovered || openMenuId === key;\n        const isProcessing =\n          !!voice.id &&\n          (voice.id === deletingId || voice.id === editingId);\n\n        const menuSlot = (\n          <div className=\"absolute right-3 top-3\">\n            <button\n              type=\"button\"\n              onClick={(event) => handleMenuClick(key, event)}\n              className={`flex h-8 w-8 items-center justify-center rounded-full bg-white/90 text-gray-600 shadow-md transition-all duration-200 hover:bg-white hover:text-gray-900 ${\n                showMenuButton ? \"opacity-100\" : \"opacity-0\"\n              }`}\n              aria-label=\"–ú–µ–Ω—é\"\n              disabled={isProcessing}\n            >\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 24 24\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                strokeWidth={2.5}\n                className=\"h-4 w-4\"\n              >\n                <circle cx=\"5\" cy=\"12\" r=\"1.5\" />\n                <circle cx=\"12\" cy=\"12\" r=\"1.5\" />\n                <circle cx=\"19\" cy=\"12\" r=\"1.5\" />\n              </svg>\n            </button>\n            {openMenuId === key && (\n              <div\n                ref={(el) => {\n                  menuRefs.current[key] = el;\n                }}\n                className=\"absolute right-0 top-10 z-50 min-w-[160px] rounded-lg border border-gray-200 bg-white shadow-lg\"\n              >\n                <button\n                  type=\"button\"\n                  onClick={() => handleEditClick(voice, key)}\n                  disabled={\n                    isProcessing ||\n                    !voice.id ||\n                    !currentUserId\n                  }\n                  className=\"w-full rounded-t-lg px-4 py-2 text-left text-sm text-gray-700 transition hover:bg-gray-50 disabled:opacity-50\"\n                >\n                  –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => handleDeleteClick(voice, key)}\n                  disabled={\n                    isProcessing ||\n                    !voice.id ||\n                    !currentUserId\n                  }\n                  className=\"w-full rounded-b-lg px-4 py-2 text-left text-sm text-red-600 transition hover:bg-red-50 disabled:opacity-50\"\n                >\n                  –£–¥–∞–ª–∏—Ç—å\n                </button>\n              </div>\n            )}\n          </div>\n        );\n\n        return (\n          <VoiceCard\n            key={key}\n            name={voice.name}\n            url={voice.url}\n            description={voice.description}\n            menuSlot={menuSlot}\n            onMouseEnter={() => {\n              setHoveredCardId(key);\n              if (closeMenuTimeoutRef.current) {\n                clearTimeout(closeMenuTimeoutRef.current);\n                closeMenuTimeoutRef.current = null;\n              }\n            }}\n            onMouseLeave={() => {\n              setHoveredCardId((current) => (current === key ? null : current));\n              if (closeMenuTimeoutRef.current) {\n                clearTimeout(closeMenuTimeoutRef.current);\n              }\n              closeMenuTimeoutRef.current = setTimeout(() => {\n                if (openMenuId === key) {\n                  setOpenMenuId(null);\n                }\n              }, 500);\n            }}\n          />\n        );\n      })}\n      <VoiceDeleteModal\n        isOpen={isDeleteModalOpen}\n        onClose={handleDeleteCancel}\n        onConfirm={handleDeleteConfirm}\n        voiceName={voiceToDelete?.voice.name ?? \"\"}\n        isDeleting={\n          voiceToDelete?.voice.id !== undefined &&\n          voiceToDelete.voice.id === deletingId\n        }\n      />\n      <VoiceEditModal\n        isOpen={isEditModalOpen}\n        onClose={handleEditCancel}\n        onConfirm={handleEditConfirm}\n        currentName={voiceToEdit?.voice.name ?? \"\"}\n        currentDescription={voiceToEdit?.voice.description ?? \"\"}\n        isSaving={\n          voiceToEdit?.voice.id !== undefined &&\n          voiceToEdit.voice.id === editingId\n        }\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2663, "column": 0}, "map": {"version":3,"sources":["file:///G:/apps/Dev/avatars_new/front/app/voices/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { supabase } from \"@/lib/supabaseClient\";\n\nimport { EmptyState } from \"@/components/EmptyState\";\nimport { Header } from \"@/components/ui/Header\";\nimport { CosmoLoader } from \"@/components/ui/CosmoLoader\";\nimport { VoiceCreateModal } from \"./components/VoiceCreateModal\";\nimport { VoiceGrid } from \"./components/VoiceGrid\";\n\ninterface VoiceRow {\n  id?: string;\n  uid: string;\n  name: string;\n  url: string;\n  created_at?: string;\n  description?: string | null;\n}\n\nexport default function VoicesPage() {\n  const router = useRouter();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [isFetchingVoices, setIsFetchingVoices] = useState(true);\n  const [voices, setVoices] = useState<VoiceRow[]>([]);\n  const [currentUserId, setCurrentUserId] = useState<string | null>(null);\n\n  const fetchVoices = useCallback(async () => {\n    setIsFetchingVoices(true);\n\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n\n      if (!user) {\n        router.push(\"/login\");\n      setCurrentUserId(null);\n      setVoices([]);\n      setIsFetchingVoices(false);\n      return;\n    }\n\n    setCurrentUserId(user.id);\n\n    const { data, error } = await supabase\n      .from(\"voices\")\n      .select(\"*\")\n      .eq(\"uid\", user.id)\n      .order(\"created_at\", { ascending: false });\n\n    if (error) {\n      console.error(\"[voices] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ–ª–æ—Å–æ–≤:\", error);\n      setVoices([]);\n    } else {\n      console.log(\"[voices] –ó–∞–≥—Ä—É–∂–µ–Ω–æ –≥–æ–ª–æ—Å–æ–≤:\", data?.length ?? 0, data);\n      // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –≥–æ–ª–æ—Å–∞ —Å –≤–∞–ª–∏–¥–Ω—ã–º url\n      const validVoices = (data ?? []).filter((voice) => voice.url && voice.name);\n      console.log(\"[voices] –í–∞–ª–∏–¥–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤:\", validVoices.length);\n      setVoices(validVoices);\n    }\n    setIsFetchingVoices(false);\n  }, [router]);\n\n  useEffect(() => {\n    fetchVoices();\n  }, [fetchVoices]);\n\n  const hasReachedLimit = voices.length >= 3;\n\n  return (\n    <div className=\"min-h-screen bg-white\">\n      <Header />\n      <div className=\"mx-auto flex w-full max-w-[1350px] items-center justify-between px-6 pt-8\">\n        <h1 className=\"text-2xl font-bold text-gray-900\">–ú–æ–∏ –≥–æ–ª–æ—Å–∞</h1>\n        <button\n          type=\"button\"\n          onClick={() => {\n            if (!hasReachedLimit) {\n              setIsModalOpen(true);\n            }\n          }}\n          disabled={hasReachedLimit}\n          className=\"min-w-[170px] rounded-lg bg-purple-600 px-4 py-3 text-sm font-semibold text-white transition hover:bg-purple-500 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:bg-purple-600\"\n          title={hasReachedLimit ? \"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤ (3) –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ\" : \"–°–æ–∑–¥–∞—Ç—å –≥–æ–ª–æ—Å\"}\n        >\n          –°–æ–∑–¥–∞—Ç—å –≥–æ–ª–æ—Å\n        </button>\n      </div>\n      <div className=\"mx-auto flex w-full max-w-[1350px] px-6 pt-4\">\n        <div className=\"w-full rounded-lg border border-amber-200 bg-amber-50/50 px-4 py-3\">\n          <div className=\"flex items-start gap-3\">\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              className=\"h-5 w-5 flex-shrink-0 text-amber-600 mt-0.5\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n              strokeWidth={2}\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n              />\n            </svg>\n            <div className=\"flex-1\">\n              <p className=\"text-sm font-medium text-amber-900\">\n                –î–µ–º–æ-—Ä–µ–∂–∏–º\n              </p>\n              <p className=\"mt-1 text-xs text-amber-700\">\n                –í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –º–∞–∫—Å–∏–º—É–º 3 –≥–æ–ª–æ—Å–∞\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n      <main className=\"mx-auto flex w-full max-w-[1350px] justify-center px-6 py-12\">\n        {isFetchingVoices ? (\n          <EmptyState title=\"\" description=\"\">\n            <div className=\"mt-px flex justify-center\">\n              <CosmoLoader ariaLabel=\"–ó–∞–≥—Ä—É–∂–∞–µ–º –≥–æ–ª–æ—Å–∞...\" />\n            </div>\n          </EmptyState>\n        ) : voices.length === 0 ? (\n        <EmptyState />\n        ) : (\n          <VoiceGrid\n            voices={voices}\n            currentUserId={currentUserId}\n            onVoicesChanged={fetchVoices}\n          />\n        )}\n      </main>\n      <VoiceCreateModal\n        isOpen={isModalOpen}\n        onClose={() => setIsModalOpen(false)}\n        onVoiceCreated={fetchVoices}\n      />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAVA;;;;;;;;;;AAqBe,SAAS;IACtB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAC;IACzD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAa,EAAE;IACnD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAgB;IAElE,MAAM,cAAc,IAAA,oNAAW,EAAC;QAC9B,oBAAoB;QAElB,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,OAAO;QAE/B,IAAI,CAAC,MAAM;YACT,OAAO,IAAI,CAAC;YACd,iBAAiB;YACjB,UAAU,EAAE;YACZ,oBAAoB;YACpB;QACF;QAEA,iBAAiB,KAAK,EAAE;QAExB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CACnC,IAAI,CAAC,UACL,MAAM,CAAC,KACP,EAAE,CAAC,OAAO,KAAK,EAAE,EACjB,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,qCAAqC;YACnD,UAAU,EAAE;QACd,OAAO;YACL,QAAQ,GAAG,CAAC,+BAA+B,MAAM,UAAU,GAAG;YAC9D,yCAAyC;YACzC,MAAM,cAAc,CAAC,QAAQ,EAAE,EAAE,MAAM,CAAC,CAAC,QAAU,MAAM,GAAG,IAAI,MAAM,IAAI;YAC1E,QAAQ,GAAG,CAAC,8BAA8B,YAAY,MAAM;YAC5D,UAAU;QACZ;QACA,oBAAoB;IACtB,GAAG;QAAC;KAAO;IAEX,IAAA,kNAAS,EAAC;QACR;IACF,GAAG;QAAC;KAAY;IAEhB,MAAM,kBAAkB,OAAO,MAAM,IAAI;IAEzC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,qIAAM;;;;;0BACP,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAmC;;;;;;kCACjD,8OAAC;wBACC,MAAK;wBACL,SAAS;4BACP,IAAI,CAAC,iBAAiB;gCACpB,eAAe;4BACjB;wBACF;wBACA,UAAU;wBACV,WAAU;wBACV,OAAO,kBAAkB,mDAAmD;kCAC7E;;;;;;;;;;;;0BAIH,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,OAAM;gCACN,WAAU;gCACV,MAAK;gCACL,SAAQ;gCACR,QAAO;gCACP,aAAa;0CAEb,cAAA,8OAAC;oCACC,eAAc;oCACd,gBAAe;oCACf,GAAE;;;;;;;;;;;0CAGN,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAE,WAAU;kDAAqC;;;;;;kDAGlD,8OAAC;wCAAE,WAAU;kDAA8B;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAOnD,8OAAC;gBAAK,WAAU;0BACb,iCACC,8OAAC,uIAAU;oBAAC,OAAM;oBAAG,aAAY;8BAC/B,cAAA,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,+IAAW;4BAAC,WAAU;;;;;;;;;;;;;;;2BAGzB,OAAO,MAAM,KAAK,kBACtB,8OAAC,uIAAU;;;;yCAET,8OAAC,sJAAS;oBACR,QAAQ;oBACR,eAAe;oBACf,iBAAiB;;;;;;;;;;;0BAIvB,8OAAC,oKAAgB;gBACf,QAAQ;gBACR,SAAS,IAAM,eAAe;gBAC9B,gBAAgB;;;;;;;;;;;;AAIxB"}}]
}