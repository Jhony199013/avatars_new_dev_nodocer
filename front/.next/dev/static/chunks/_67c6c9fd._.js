(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/lib/supabaseClient.ts [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "supabase",
    ()=>supabase
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = /*#__PURE__*/ __turbopack_context__.i("[project]/node_modules/next/dist/build/polyfills/process.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@supabase/supabase-js/dist/module/index.js [app-client] (ecmascript) <locals>");
;
const supabaseUrl = ("TURBOPACK compile-time value", "https://base.lect-gen.ru") || "";
const supabaseAnonKey = ("TURBOPACK compile-time value", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzYzNDEzMjAwLCJleHAiOjE5MjExNzk2MDB9.idPB37uPfkR0tioORf3PqSuFUCPp6ZDTrdBWtUou_9Y") || "";
const supabase = ("TURBOPACK compile-time truthy", 1) ? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseAnonKey) : "TURBOPACK unreachable";
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/servers/data:174e33 [app-client] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

/* __next_internal_action_entry_do_not_use__ [{"407bfa4289ac144f6c78aa0a192ae267f388afa793":"GetAudioUrl"},"app/material/editor/servers/GetAudioUrl.ts",""] */ __turbopack_context__.s([
    "GetAudioUrl",
    ()=>GetAudioUrl
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-client] (ecmascript)");
"use turbopack no side effects";
;
var GetAudioUrl = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["createServerReference"])("407bfa4289ac144f6c78aa0a192ae267f388afa793", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["findSourceMapURL"], "GetAudioUrl"); //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vR2V0QXVkaW9VcmwudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc2VydmVyXCI7XHJcblxyXG5pbnRlcmZhY2UgR2V0QXVkaW9VcmxJbnB1dCB7XHJcbiAgdXNlclV1aWQ6IHN0cmluZyB8IG51bGw7XHJcbiAgc2xpZGVOdW1iZXI6IG51bWJlcjtcclxuICB2b2ljZUlkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBHZXRBdWRpb1VybFJlc3VsdCB7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbn1cclxuXHJcbmNvbnN0IFMzX0JVQ0tFVF9JRCA9IFwiZGEyYWMxMmEtNDFjYzYzYTMtM2FkOS00ZWVlLWEzM2EtNzc3NmY3OTczZGU3XCI7XHJcbmNvbnN0IFMzX0JBU0VfVVJMID0gXCJodHRwczovL3MzLnR3Y3N0b3JhZ2UucnVcIjtcclxuXHJcbi8qKlxyXG4gKiDQn9C+0LvRg9GH0LDQtdGCIFVSTCDQsNGD0LTQuNC+INGE0LDQudC70LAg0LjQtyBTMyDRhdGA0LDQvdC40LvQuNGJ0LBcclxuICogQHBhcmFtIHVzZXJVdWlkIC0gVVVJRCDQt9Cw0LvQvtCz0LjQvdC10L3QvdC+0LPQviDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y9cclxuICogQHBhcmFtIHNsaWRlTnVtYmVyIC0g0J3QvtC80LXRgCDRgdC70LDQudC00LBcclxuICogQHBhcmFtIHZvaWNlSWQgLSBJRCDQs9C+0LvQvtGB0LAg0LjQtyDRgtCw0LHQu9C40YbRiyB2b2ljZXNcclxuICogQHJldHVybnMgVVJMINCw0YPQtNC40L4g0YTQsNC50LvQsFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdldEF1ZGlvVXJsKHtcclxuICB1c2VyVXVpZCxcclxuICBzbGlkZU51bWJlcixcclxuICB2b2ljZUlkLFxyXG59OiBHZXRBdWRpb1VybElucHV0KTogUHJvbWlzZTxHZXRBdWRpb1VybFJlc3VsdD4ge1xyXG4gIGlmICghdXNlclV1aWQpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIlVVSUQg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPINC90LUg0YPQutCw0LfQsNC9XCIpO1xyXG4gIH1cclxuXHJcbiAgaWYgKCF2b2ljZUlkKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJ2b2ljZV9pZCDQvdC1INGD0LrQsNC30LDQvVwiKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGF1ZGlvVXJsID0gYCR7UzNfQkFTRV9VUkx9LyR7UzNfQlVDS0VUX0lEfS90ZW1wLyR7dXNlclV1aWR9L1RUUy8ke3NsaWRlTnVtYmVyfV8ke3ZvaWNlSWR9Lm1wM2A7XHJcblxyXG4gIHJldHVybiB7IHVybDogYXVkaW9VcmwgfTtcclxufVxyXG5cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiIrU0FzQnNCIn0=
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/EditorSidebar.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "EditorSidebar",
    ()=>EditorSidebar
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$image$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/image.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/supabaseClient.ts [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$servers$2f$data$3a$174e33__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/app/material/editor/servers/data:174e33 [app-client] (ecmascript) <text/javascript>");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
;
;
;
const ratioOptions = [
    {
        label: "16:9",
        value: "16:9"
    },
    {
        label: "9:16",
        value: "9:16"
    }
];
function EditorSidebar({ aspectRatio, onAspectRatioChange, videoTitle, onVideoTitleChange, avatars, isLoadingAvatars, voices, isLoadingVoices, scenes, activeSceneId, onSelectScene, onAddScene, onDeleteScene, onSceneVoiceChange, onSceneScriptChange, onSceneAvatarChange }) {
    _s();
    const [openAvatarModalForSceneId, setOpenAvatarModalForSceneId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [openVoiceModalForSceneId, setOpenVoiceModalForSceneId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [playingSceneId, setPlayingSceneId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [loadingSceneId, setLoadingSceneId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const audioRefs = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])({});
    // Сохраняем последний отправленный текст для каждого слайда
    const lastSentTexts = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])({});
    // Очистка аудио при размонтировании компонента
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "EditorSidebar.useEffect": ()=>{
            return ({
                "EditorSidebar.useEffect": ()=>{
                    Object.values(audioRefs.current).forEach({
                        "EditorSidebar.useEffect": (audio)=>{
                            const managed = audio;
                            audio.pause();
                            audio.onplay = null;
                            audio.onpause = null;
                            audio.onended = null;
                            audio.onerror = null;
                            managed.__handlers = undefined;
                            audio.removeAttribute("src");
                            audio.src = "";
                        }
                    }["EditorSidebar.useEffect"]);
                    audioRefs.current = {};
                }
            })["EditorSidebar.useEffect"];
        }
    }["EditorSidebar.useEffect"], []);
    // Останавливает воспроизведение на всех слайдах, кроме указанного
    const stopOtherScenesAudio = (currentSceneId)=>{
        Object.entries(audioRefs.current).forEach(([id, audio])=>{
            if (id !== currentSceneId && audio.src) {
                audio.pause();
                audio.currentTime = 0;
            }
        });
    };
    const handlePlayClick = async (sceneId, sceneIndex)=>{
        const scene = scenes.find((s)=>s.id === sceneId);
        if (!scene || !scene.avatarId || !scene.script || scene.script.trim() === "") {
            return;
        }
        // Находим выбранный голос и получаем его voice_id из таблицы
        const selectedVoice = voices.find((voice)=>voice.id === scene.voiceId);
        if (!selectedVoice || !selectedVoice.voice_id) {
            alert("У выбранного голоса отсутствует voice_id");
            return;
        }
        // Извлекаем номер слайда из title (например, "Слайд 1" -> 1)
        const slideNumberMatch = scene.title.match(/\d+/);
        const slideNumber = slideNumberMatch ? parseInt(slideNumberMatch[0], 10) : sceneIndex + 1;
        const currentText = scene.script.trim();
        const lastSentText = lastSentTexts.current[sceneId];
        // Получаем UUID залогиненного пользователя
        const { data: { user } } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.getUser();
        const userUuid = user?.id || null;
        // Получаем базовый URL файла в хранилище через серверный компонент
        let baseAudioUrl;
        try {
            const audioUrlResult = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$servers$2f$data$3a$174e33__$5b$app$2d$client$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["GetAudioUrl"])({
                userUuid,
                slideNumber,
                voiceId: selectedVoice.voice_id
            });
            baseAudioUrl = audioUrlResult.url;
            console.log("Сформированный URL аудио:", baseAudioUrl);
        } catch (error) {
            console.error("Ошибка при получении URL аудио:", error);
            alert("Не удалось получить URL аудио файла");
            return;
        }
        // Определяем, изменился ли текст
        const textChanged = lastSentText !== currentText;
        // Если текст не изменился и уже есть загруженный аудио-файл для этого слайда,
        // просто управляем воспроизведением/паузой без повторной отправки вебхука
        const existingAudio = audioRefs.current[sceneId];
        if (!textChanged && existingAudio && existingAudio.src.startsWith(baseAudioUrl)) {
            if (!existingAudio.paused) {
                // Ставим на паузу текущий слайд
                existingAudio.pause();
                setPlayingSceneId((current)=>current === sceneId ? null : current);
            } else {
                // Перед воспроизведением этого слайда останавливаем все остальные
                stopOtherScenesAudio(sceneId);
                await existingAudio.play();
                setPlayingSceneId(sceneId);
            }
            return;
        }
        try {
            setLoadingSceneId(sceneId);
            // Отправляем вебхук и ждем, пока n8n вернет success === true
            const response = await fetch("https://rueleven.ru/webhook/d08c47c0-82c3-4b50-a7e0-e1b525c5498b", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    voice_id: selectedVoice.voice_id,
                    slide_number: slideNumber,
                    text: currentText,
                    uuid: userUuid
                })
            });
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            // Ожидаем подтверждение от n8n, что файл готов: [{ "success": true }] или { "success": true }
            let json;
            try {
                json = await response.json();
            } catch  {
                throw new Error("Некорректный JSON ответ от вебхука");
            }
            let success = false;
            if (Array.isArray(json) && json.length > 0 && typeof json[0] === "object" && json[0] !== null) {
                success = Boolean(json[0].success);
            } else if (json && typeof json === "object") {
                success = Boolean(json.success);
            }
            if (!success) {
                console.error("Неожиданный ответ вебхука, ожидали success=true:", json);
                throw new Error("Вебхук не вернул success=true, аудио может быть не готово");
            }
            console.log("Вебхук успешно завершил генерацию для слайда:", slideNumber);
            // Сохраняем отправленный текст (используется для определения, изменился ли текст)
            lastSentTexts.current[sceneId] = currentText;
            // Если текст изменился, добавляем cache-buster к URL, чтобы браузер не брал старое аудио из кеша
            const audioUrl = textChanged ? `${baseAudioUrl}?t=${Date.now()}` : baseAudioUrl;
            console.log("Воспроизведение аудио по URL:", audioUrl);
            // Останавливаем воспроизведение на других слайдах
            stopOtherScenesAudio(sceneId);
            // Создаем или используем существующий audio элемент
            let audio = audioRefs.current[sceneId];
            if (!audio) {
                audio = new Audio();
                const handlePlay = ()=>{
                    setPlayingSceneId(sceneId);
                    setLoadingSceneId(null);
                };
                const handlePause = ()=>{
                    setPlayingSceneId((current)=>current === sceneId ? null : current);
                };
                const handleEnded = ()=>{
                    setPlayingSceneId((current)=>current === sceneId ? null : current);
                };
                const handleError = (event)=>{
                    if (typeof event === "string") {
                        console.error("Ошибка загрузки аудио:", event);
                        setLoadingSceneId(null);
                        setPlayingSceneId((current)=>current === sceneId ? null : current);
                        return;
                    }
                    const audioElement = event.currentTarget;
                    const hasSrcAttr = audioElement.getAttribute("src");
                    if (!hasSrcAttr || hasSrcAttr === "") {
                        return;
                    }
                    console.error("Ошибка загрузки аудио:", event);
                    setLoadingSceneId(null);
                    setPlayingSceneId((current)=>current === sceneId ? null : current);
                    if (audioElement.error) {
                        console.error("Код ошибки:", audioElement.error.code);
                        console.error("Сообщение:", audioElement.error.message);
                    }
                };
                audio.onplay = handlePlay;
                audio.onpause = handlePause;
                audio.onended = handleEnded;
                audio.onerror = handleError;
                audio.__handlers = {
                    onPlay: handlePlay,
                    onPause: handlePause,
                    onEnded: handleEnded,
                    onError: handleError
                };
                audioRefs.current[sceneId] = audio;
            }
            // Устанавливаем источник и воспроизводим
            audio.setAttribute("src", audioUrl);
            audio.src = audioUrl;
            await audio.play();
            setPlayingSceneId(sceneId);
            setLoadingSceneId(null);
            console.log("Воспроизведение начато");
        } catch (error) {
            setLoadingSceneId(null);
            console.error("Ошибка при отправке вебхука или воспроизведении:", error);
            alert(error instanceof Error ? error.message : "Не удалось отправить вебхук или воспроизвести аудио");
        }
    };
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("aside", {
                className: "flex h-full min-h-0 flex-col overflow-hidden rounded-3xl border border-gray-100 bg-white shadow-sm ring-1 ring-black/5",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex-shrink-0 space-y-6 border-b border-gray-100 p-6",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "space-y-3",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                        className: "text-sm uppercase tracking-[0.2em] text-gray-500",
                                        children: "Настройка слайдов"
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 290,
                                        columnNumber: 13
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "flex items-center gap-3",
                                        children: ratioOptions.map(({ label, value })=>{
                                            const isActive = aspectRatio === value;
                                            return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                type: "button",
                                                onClick: ()=>onAspectRatioChange(value),
                                                className: `flex h-12 flex-1 items-center justify-center rounded-2xl border text-sm font-semibold transition ${isActive ? "border-gray-900 bg-gray-900 text-white" : "border-gray-200 text-gray-600 hover:border-gray-300 hover:text-gray-900"}`,
                                                children: label
                                            }, value, false, {
                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                lineNumber: 297,
                                                columnNumber: 19
                                            }, this);
                                        })
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 293,
                                        columnNumber: 13
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                lineNumber: 289,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("label", {
                                className: "block space-y-2",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                        className: "text-sm text-gray-600",
                                        children: "Название видео"
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 315,
                                        columnNumber: 13
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("input", {
                                        type: "text",
                                        value: videoTitle,
                                        onChange: (event)=>onVideoTitleChange(event.target.value),
                                        placeholder: "Untitled Video",
                                        className: "w-full rounded-2xl border border-gray-200 bg-white px-4 py-3 text-sm text-gray-900 outline-none placeholder:text-gray-400 focus:border-gray-900 focus:ring-1 focus:ring-gray-900"
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 316,
                                        columnNumber: 13
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                lineNumber: 314,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                        lineNumber: 288,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex-1 min-h-0 space-y-2 overflow-y-auto p-4 [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full",
                        children: scenes.map((scene, index)=>{
                            const isActive = scene.id === activeSceneId;
                            const selectedAvatar = avatars.find((avatar)=>avatar.id === scene.avatarId);
                            const selectedVoice = voices.find((voice)=>voice.id === scene.voiceId);
                            return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "space-y-2",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: `rounded-2xl p-4 transition ${isActive ? "bg-gray-50" : "bg-white hover:bg-gray-50/50"}`,
                                        onClick: ()=>onSelectScene(scene.id),
                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "space-y-3",
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                    className: "flex items-center gap-3",
                                                    children: [
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                            className: "flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full bg-gray-200 text-sm font-semibold text-gray-700",
                                                            children: index + 1
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 344,
                                                            columnNumber: 23
                                                        }, this),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                            type: "button",
                                                            onClick: (e)=>{
                                                                e.stopPropagation();
                                                                setOpenAvatarModalForSceneId(scene.id);
                                                            },
                                                            className: "flex items-center gap-1 rounded-xl bg-gray-100 px-3 py-2 transition hover:bg-gray-200",
                                                            children: selectedAvatar ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                                                                children: [
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                        className: "relative h-8 w-8 flex-shrink-0 overflow-hidden rounded-full",
                                                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$image$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"], {
                                                                            src: selectedAvatar.photo,
                                                                            alt: selectedAvatar.name,
                                                                            fill: true,
                                                                            className: "object-cover",
                                                                            unoptimized: true
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                            lineNumber: 358,
                                                                            columnNumber: 31
                                                                        }, this)
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 357,
                                                                        columnNumber: 29
                                                                    }, this),
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                        className: "text-left text-xs font-medium text-gray-900 whitespace-nowrap",
                                                                        children: "Аватар"
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 366,
                                                                        columnNumber: 29
                                                                    }, this)
                                                                ]
                                                            }, void 0, true) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                                                                children: [
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                        className: "flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full border-2 border-dashed border-gray-300 bg-white",
                                                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                            className: "text-sm text-gray-400",
                                                                            children: "＋"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                            lineNumber: 373,
                                                                            columnNumber: 31
                                                                        }, this)
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 372,
                                                                        columnNumber: 29
                                                                    }, this),
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                        className: "text-left text-xs text-gray-500 whitespace-nowrap",
                                                                        children: "Аватар"
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 375,
                                                                        columnNumber: 29
                                                                    }, this)
                                                                ]
                                                            }, void 0, true)
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 347,
                                                            columnNumber: 23
                                                        }, this),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                            type: "button",
                                                            onClick: (e)=>{
                                                                e.stopPropagation();
                                                                setOpenVoiceModalForSceneId(scene.id);
                                                            },
                                                            className: "flex items-center gap-1 rounded-xl bg-gray-100 px-3 py-2 transition hover:bg-gray-200",
                                                            children: selectedVoice ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                                                                children: [
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                        className: "flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full border-2 border-dashed border-gray-300 bg-white",
                                                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                                                            xmlns: "http://www.w3.org/2000/svg",
                                                                            viewBox: "0 0 24 24",
                                                                            fill: "none",
                                                                            stroke: "currentColor",
                                                                            strokeWidth: 2,
                                                                            className: "h-4 w-4 text-gray-400",
                                                                            children: [
                                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                                                    d: "M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"
                                                                                }, void 0, false, {
                                                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                                    lineNumber: 400,
                                                                                    columnNumber: 33
                                                                                }, this),
                                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                                                    d: "M19 10v2a7 7 0 0 1-14 0v-2"
                                                                                }, void 0, false, {
                                                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                                    lineNumber: 401,
                                                                                    columnNumber: 33
                                                                                }, this),
                                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("line", {
                                                                                    x1: "12",
                                                                                    y1: "19",
                                                                                    x2: "12",
                                                                                    y2: "23"
                                                                                }, void 0, false, {
                                                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                                    lineNumber: 402,
                                                                                    columnNumber: 33
                                                                                }, this),
                                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("line", {
                                                                                    x1: "8",
                                                                                    y1: "23",
                                                                                    x2: "16",
                                                                                    y2: "23"
                                                                                }, void 0, false, {
                                                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                                    lineNumber: 403,
                                                                                    columnNumber: 33
                                                                                }, this)
                                                                            ]
                                                                        }, void 0, true, {
                                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                            lineNumber: 392,
                                                                            columnNumber: 31
                                                                        }, this)
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 391,
                                                                        columnNumber: 29
                                                                    }, this),
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                        className: "text-left text-xs font-medium text-gray-900 whitespace-nowrap",
                                                                        children: selectedVoice.name
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 406,
                                                                        columnNumber: 29
                                                                    }, this)
                                                                ]
                                                            }, void 0, true) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                                                                children: [
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                        className: "flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full border-2 border-dashed border-gray-300 bg-white",
                                                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                            className: "text-sm text-gray-400",
                                                                            children: "＋"
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                            lineNumber: 413,
                                                                            columnNumber: 31
                                                                        }, this)
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 412,
                                                                        columnNumber: 29
                                                                    }, this),
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                        className: "text-left text-xs text-gray-500 whitespace-nowrap",
                                                                        children: "Голос"
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 415,
                                                                        columnNumber: 29
                                                                    }, this)
                                                                ]
                                                            }, void 0, true)
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 381,
                                                            columnNumber: 23
                                                        }, this),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                            type: "button",
                                                            onClick: (e)=>{
                                                                e.stopPropagation();
                                                                handlePlayClick(scene.id, index);
                                                            },
                                                            disabled: !scene.avatarId || !scene.voiceId || !scene.script || scene.script.trim() === "" || loadingSceneId === scene.id,
                                                            className: "ml-auto flex h-9 w-9 flex-shrink-0 items-center justify-center rounded-xl bg-gray-100 text-gray-900 transition hover:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-300",
                                                            "aria-label": playingSceneId === scene.id ? "Поставить на паузу" : "Воспроизвести голос",
                                                            children: loadingSceneId === scene.id ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                                                className: "h-4 w-4 animate-spin text-gray-600",
                                                                xmlns: "http://www.w3.org/2000/svg",
                                                                fill: "none",
                                                                viewBox: "0 0 24 24",
                                                                children: [
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("circle", {
                                                                        className: "opacity-25",
                                                                        cx: "12",
                                                                        cy: "12",
                                                                        r: "10",
                                                                        stroke: "currentColor",
                                                                        strokeWidth: "4"
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 444,
                                                                        columnNumber: 29
                                                                    }, this),
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                                        className: "opacity-75",
                                                                        fill: "currentColor",
                                                                        d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                        lineNumber: 452,
                                                                        columnNumber: 29
                                                                    }, this)
                                                                ]
                                                            }, void 0, true, {
                                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                lineNumber: 438,
                                                                columnNumber: 27
                                                            }, this) : playingSceneId === scene.id ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                                                xmlns: "http://www.w3.org/2000/svg",
                                                                viewBox: "0 0 24 24",
                                                                fill: "currentColor",
                                                                className: "h-4 w-4",
                                                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                                    d: "M6 4h4v16H6V4zm8 0h4v16h-4V4z"
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                    lineNumber: 465,
                                                                    columnNumber: 29
                                                                }, this)
                                                            }, void 0, false, {
                                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                lineNumber: 459,
                                                                columnNumber: 27
                                                            }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                                                xmlns: "http://www.w3.org/2000/svg",
                                                                viewBox: "0 0 24 24",
                                                                fill: "currentColor",
                                                                className: "h-4 w-4",
                                                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                                    d: "M8 5v14l11-7z"
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                    lineNumber: 474,
                                                                    columnNumber: 29
                                                                }, this)
                                                            }, void 0, false, {
                                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                lineNumber: 468,
                                                                columnNumber: 27
                                                            }, this)
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 421,
                                                            columnNumber: 23
                                                        }, this),
                                                        scenes.length > 1 && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                            type: "button",
                                                            onClick: (e)=>{
                                                                e.stopPropagation();
                                                                onDeleteScene(scene.id);
                                                            },
                                                            className: "flex h-9 w-9 flex-shrink-0 items-center justify-center rounded-xl bg-red-50 text-red-600 transition hover:bg-red-100",
                                                            "aria-label": "Удалить слайд",
                                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                                                xmlns: "http://www.w3.org/2000/svg",
                                                                viewBox: "0 0 24 24",
                                                                fill: "none",
                                                                stroke: "currentColor",
                                                                strokeWidth: 2,
                                                                className: "h-4 w-4",
                                                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                                    d: "M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                    lineNumber: 496,
                                                                    columnNumber: 29
                                                                }, this)
                                                            }, void 0, false, {
                                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                                lineNumber: 488,
                                                                columnNumber: 27
                                                            }, this)
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 479,
                                                            columnNumber: 25
                                                        }, this)
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                    lineNumber: 343,
                                                    columnNumber: 21
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("textarea", {
                                                    value: scene.script,
                                                    onChange: (event)=>onSceneScriptChange(scene.id, event.target.value),
                                                    onClick: (e)=>e.stopPropagation(),
                                                    rows: 3,
                                                    placeholder: "Напишите текст",
                                                    className: "w-full resize-none rounded-xl border border-gray-200 bg-white px-3 py-2 text-xs text-gray-900 outline-none placeholder:text-gray-400 focus:border-gray-900 focus:ring-1 focus:ring-gray-900"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                    lineNumber: 502,
                                                    columnNumber: 21
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                            lineNumber: 342,
                                            columnNumber: 19
                                        }, this)
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 334,
                                        columnNumber: 17
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                        type: "button",
                                        onClick: (e)=>{
                                            e.stopPropagation();
                                            onAddScene(scene.id);
                                        },
                                        className: "flex w-full items-center justify-center gap-2 rounded-xl bg-gray-100 px-3 py-2 text-xs font-medium text-gray-700 transition hover:bg-gray-200",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                className: "text-sm",
                                                children: "＋"
                                            }, void 0, false, {
                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                lineNumber: 523,
                                                columnNumber: 19
                                            }, this),
                                            "Слайд"
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 515,
                                        columnNumber: 17
                                    }, this)
                                ]
                            }, scene.id, true, {
                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                lineNumber: 333,
                                columnNumber: 15
                            }, this);
                        })
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                        lineNumber: 326,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                lineNumber: 287,
                columnNumber: 7
            }, this),
            openAvatarModalForSceneId && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",
                onClick: ()=>setOpenAvatarModalForSceneId(null),
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "w-full max-w-2xl rounded-3xl border border-gray-100 bg-white p-6 shadow-xl",
                    onClick: (e)=>e.stopPropagation(),
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "mb-4 flex items-center justify-between",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h2", {
                                    className: "text-xl font-semibold text-gray-900",
                                    children: "Выберите аватар"
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                    lineNumber: 542,
                                    columnNumber: 15
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                    type: "button",
                                    onClick: ()=>setOpenAvatarModalForSceneId(null),
                                    className: "rounded-lg p-2 text-gray-400 transition hover:bg-gray-100 hover:text-gray-900",
                                    "aria-label": "Закрыть",
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                        xmlns: "http://www.w3.org/2000/svg",
                                        viewBox: "0 0 24 24",
                                        fill: "none",
                                        stroke: "currentColor",
                                        strokeWidth: 2,
                                        className: "h-5 w-5",
                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                            d: "M18 6L6 18M6 6l12 12"
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                            lineNumber: 559,
                                            columnNumber: 19
                                        }, this)
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 551,
                                        columnNumber: 17
                                    }, this)
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                    lineNumber: 545,
                                    columnNumber: 15
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                            lineNumber: 541,
                            columnNumber: 13
                        }, this),
                        isLoadingAvatars ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex items-center justify-center py-12",
                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                className: "text-gray-500",
                                children: "Загрузка аватаров..."
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                lineNumber: 565,
                                columnNumber: 17
                            }, this)
                        }, void 0, false, {
                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                            lineNumber: 564,
                            columnNumber: 15
                        }, this) : avatars.length === 0 ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex items-center justify-center py-12",
                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                className: "text-gray-500",
                                children: "Нет доступных аватаров"
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                lineNumber: 569,
                                columnNumber: 17
                            }, this)
                        }, void 0, false, {
                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                            lineNumber: 568,
                            columnNumber: 15
                        }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4",
                            children: avatars.map((avatar)=>{
                                const scene = scenes.find((s)=>s.id === openAvatarModalForSceneId);
                                const isSelected = scene?.avatarId === avatar.id;
                                return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                    type: "button",
                                    onClick: ()=>{
                                        if (openAvatarModalForSceneId) {
                                            onSceneAvatarChange(openAvatarModalForSceneId, isSelected ? null : avatar.id);
                                        }
                                        setOpenAvatarModalForSceneId(null);
                                    },
                                    className: `group relative aspect-[3/4] overflow-hidden rounded-2xl border-2 transition ${isSelected ? "border-gray-900 ring-2 ring-gray-900" : "border-gray-200 hover:border-gray-300"}`,
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$image$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"], {
                                            src: avatar.photo,
                                            alt: avatar.name,
                                            fill: true,
                                            className: "object-cover",
                                            unoptimized: true
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                            lineNumber: 595,
                                            columnNumber: 23
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "absolute inset-0 bg-black/0 transition group-hover:bg-black/20"
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                            lineNumber: 602,
                                            columnNumber: 23
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-3",
                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                className: "text-sm font-semibold text-white",
                                                children: avatar.name
                                            }, void 0, false, {
                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                lineNumber: 604,
                                                columnNumber: 25
                                            }, this)
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                            lineNumber: 603,
                                            columnNumber: 23
                                        }, this)
                                    ]
                                }, avatar.id, true, {
                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                    lineNumber: 577,
                                    columnNumber: 21
                                }, this);
                            })
                        }, void 0, false, {
                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                            lineNumber: 572,
                            columnNumber: 15
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                    lineNumber: 537,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                lineNumber: 533,
                columnNumber: 9
            }, this),
            openVoiceModalForSceneId && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",
                onClick: ()=>setOpenVoiceModalForSceneId(null),
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "w-full max-w-2xl rounded-3xl border border-gray-100 bg-white p-6 shadow-xl",
                    onClick: (e)=>e.stopPropagation(),
                    children: [
                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "mb-4 flex items-center justify-between",
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h2", {
                                    className: "text-xl font-semibold text-gray-900",
                                    children: "Выберите голос"
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                    lineNumber: 627,
                                    columnNumber: 15
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                    type: "button",
                                    onClick: ()=>setOpenVoiceModalForSceneId(null),
                                    className: "rounded-lg p-2 text-gray-400 transition hover:bg-gray-100 hover:text-gray-900",
                                    "aria-label": "Закрыть",
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                        xmlns: "http://www.w3.org/2000/svg",
                                        viewBox: "0 0 24 24",
                                        fill: "none",
                                        stroke: "currentColor",
                                        strokeWidth: 2,
                                        className: "h-5 w-5",
                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                            d: "M18 6L6 18M6 6l12 12"
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                            lineNumber: 644,
                                            columnNumber: 19
                                        }, this)
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 636,
                                        columnNumber: 17
                                    }, this)
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                    lineNumber: 630,
                                    columnNumber: 15
                                }, this)
                            ]
                        }, void 0, true, {
                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                            lineNumber: 626,
                            columnNumber: 13
                        }, this),
                        isLoadingVoices ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex items-center justify-center py-12",
                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                className: "text-gray-500",
                                children: "Загрузка голосов..."
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                lineNumber: 650,
                                columnNumber: 17
                            }, this)
                        }, void 0, false, {
                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                            lineNumber: 649,
                            columnNumber: 15
                        }, this) : voices.length === 0 ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "flex items-center justify-center py-12",
                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                className: "text-gray-500",
                                children: "Нет доступных голосов"
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                lineNumber: 654,
                                columnNumber: 17
                            }, this)
                        }, void 0, false, {
                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                            lineNumber: 653,
                            columnNumber: 15
                        }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "space-y-2",
                            children: voices.map((voice)=>{
                                const scene = scenes.find((s)=>s.id === openVoiceModalForSceneId);
                                const isSelected = scene?.voiceId === voice.id;
                                return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                    type: "button",
                                    onClick: ()=>{
                                        if (openVoiceModalForSceneId) {
                                            onSceneVoiceChange(openVoiceModalForSceneId, isSelected ? null : voice.id);
                                        }
                                        setOpenVoiceModalForSceneId(null);
                                    },
                                    className: `w-full rounded-xl border-2 p-4 text-left transition ${isSelected ? "border-gray-900 bg-gray-50 ring-2 ring-gray-900" : "border-gray-200 hover:border-gray-300"}`,
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "flex items-center gap-3",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                className: "flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full bg-gray-100",
                                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                                    xmlns: "http://www.w3.org/2000/svg",
                                                    viewBox: "0 0 24 24",
                                                    fill: "none",
                                                    stroke: "currentColor",
                                                    strokeWidth: 2,
                                                    className: "h-5 w-5 text-gray-600",
                                                    children: [
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                            d: "M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 690,
                                                            columnNumber: 29
                                                        }, this),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                            d: "M19 10v2a7 7 0 0 1-14 0v-2"
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 691,
                                                            columnNumber: 29
                                                        }, this),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("line", {
                                                            x1: "12",
                                                            y1: "19",
                                                            x2: "12",
                                                            y2: "23"
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 692,
                                                            columnNumber: 29
                                                        }, this),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("line", {
                                                            x1: "8",
                                                            y1: "23",
                                                            x2: "16",
                                                            y2: "23"
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                            lineNumber: 693,
                                                            columnNumber: 29
                                                        }, this)
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                    lineNumber: 682,
                                                    columnNumber: 27
                                                }, this)
                                            }, void 0, false, {
                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                lineNumber: 681,
                                                columnNumber: 25
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                className: "flex-1",
                                                children: [
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-sm font-semibold text-gray-900",
                                                        children: voice.name
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                        lineNumber: 697,
                                                        columnNumber: 27
                                                    }, this),
                                                    voice.description && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-xs text-gray-500",
                                                        children: voice.description
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                        lineNumber: 701,
                                                        columnNumber: 29
                                                    }, this)
                                                ]
                                            }, void 0, true, {
                                                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                                lineNumber: 696,
                                                columnNumber: 25
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                        lineNumber: 680,
                                        columnNumber: 23
                                    }, this)
                                }, voice.id, false, {
                                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                                    lineNumber: 662,
                                    columnNumber: 21
                                }, this);
                            })
                        }, void 0, false, {
                            fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                            lineNumber: 657,
                            columnNumber: 15
                        }, this)
                    ]
                }, void 0, true, {
                    fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                    lineNumber: 622,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/EditorSidebar.tsx",
                lineNumber: 618,
                columnNumber: 9
            }, this)
        ]
    }, void 0, true);
}
_s(EditorSidebar, "nQR+5Awu+NT4ONOUzyb3usKzC1c=");
_c = EditorSidebar;
var _c;
__turbopack_context__.k.register(_c, "EditorSidebar");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/Timeline.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Timeline",
    ()=>Timeline
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
"use client";
;
const CANVAS_SIZES = {
    "16:9": {
        width: 1920,
        height: 1080
    },
    "9:16": {
        width: 1080,
        height: 1920
    }
};
function CanvasThumbnail({ scene, avatars, aspectRatio }) {
    const canvasSize = CANVAS_SIZES[aspectRatio];
    const avatar = scene.avatarId ? avatars.find((a)=>a.id === scene.avatarId) : null;
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "absolute inset-0 bg-gray-50 overflow-hidden",
        children: [
            avatar && scene.avatarPosition && scene.avatarSize && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "absolute",
                style: {
                    left: `${scene.avatarPosition.x / canvasSize.width * 100}%`,
                    top: `${scene.avatarPosition.y / canvasSize.height * 100}%`,
                    width: `${scene.avatarSize.width / canvasSize.width * 100}%`,
                    height: `${scene.avatarSize.height / canvasSize.height * 100}%`,
                    transform: "translate(-50%, -50%)"
                },
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("img", {
                    src: avatar.photo,
                    alt: avatar.name,
                    className: "w-full h-full object-cover rounded"
                }, void 0, false, {
                    fileName: "[project]/app/material/editor/components/Timeline.tsx",
                    lineNumber: 38,
                    columnNumber: 11
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/Timeline.tsx",
                lineNumber: 28,
                columnNumber: 9
            }, this),
            scene.elements.map((element)=>{
                const leftPercent = element.x / canvasSize.width * 100;
                const topPercent = element.y / canvasSize.height * 100;
                const widthPercent = element.width / canvasSize.width * 100;
                const heightPercent = element.height / canvasSize.height * 100;
                return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "absolute rounded border border-gray-300 overflow-hidden",
                    style: {
                        left: `${leftPercent}%`,
                        top: `${topPercent}%`,
                        width: `${widthPercent}%`,
                        height: `${heightPercent}%`,
                        transform: "translate(-50%, -50%)",
                        backgroundColor: element.imageUrl ? "transparent" : "#e5e7eb"
                    },
                    children: element.imageUrl ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("img", {
                        src: element.imageUrl,
                        alt: element.label,
                        className: "w-full h-full object-cover"
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/Timeline.tsx",
                        lineNumber: 67,
                        columnNumber: 15
                    }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "w-full h-full bg-gray-200"
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/Timeline.tsx",
                        lineNumber: 73,
                        columnNumber: 15
                    }, this)
                }, element.id, false, {
                    fileName: "[project]/app/material/editor/components/Timeline.tsx",
                    lineNumber: 54,
                    columnNumber: 11
                }, this);
            })
        ]
    }, void 0, true, {
        fileName: "[project]/app/material/editor/components/Timeline.tsx",
        lineNumber: 25,
        columnNumber: 5
    }, this);
}
_c = CanvasThumbnail;
function Timeline({ scenes, activeSceneId, onSelectScene, onAddScene, avatars, aspectRatio }) {
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "flex h-full flex-col rounded-3xl border border-gray-100 bg-white p-4 shadow-sm ring-1 ring-black/5",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "mb-3 flex flex-shrink-0 items-center justify-between",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-sm font-semibold text-gray-900",
                        children: "Таймлайн"
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/Timeline.tsx",
                        lineNumber: 102,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "text-xs text-gray-500",
                        children: [
                            "Слайды: ",
                            scenes.length.toString().padStart(2, "0")
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/material/editor/components/Timeline.tsx",
                        lineNumber: 103,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/material/editor/components/Timeline.tsx",
                lineNumber: 101,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "flex w-full flex-1 flex-nowrap items-center gap-4 overflow-x-auto pb-2 [&::-webkit-scrollbar]:h-2 [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full min-h-0",
                children: scenes.map((scene, index)=>{
                    const isActive = scene.id === activeSceneId;
                    const isLast = index === scenes.length - 1;
                    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex items-center gap-2 flex-shrink-0",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                type: "button",
                                onClick: ()=>onSelectScene(scene.id),
                                className: `relative min-w-[180px] min-h-[120px] w-[180px] h-[120px] rounded-2xl border overflow-hidden transition ${isActive ? "border-gray-900" : "border-gray-200 hover:border-gray-300"}`,
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(CanvasThumbnail, {
                                        scene: scene,
                                        avatars: avatars,
                                        aspectRatio: aspectRatio
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/Timeline.tsx",
                                        lineNumber: 122,
                                        columnNumber: 17
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "absolute top-2 left-2 flex h-6 w-6 items-center justify-center rounded-full bg-black/70 text-xs font-semibold text-white",
                                        children: index + 1
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/Timeline.tsx",
                                        lineNumber: 128,
                                        columnNumber: 17
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/material/editor/components/Timeline.tsx",
                                lineNumber: 113,
                                columnNumber: 15
                            }, this),
                            isLast && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                type: "button",
                                onClick: ()=>onAddScene(scene.id),
                                className: "flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full border-2 border-dashed border-gray-300 bg-white text-gray-400 transition hover:border-gray-400 hover:text-gray-600",
                                "aria-label": "Добавить слайд",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                    xmlns: "http://www.w3.org/2000/svg",
                                    viewBox: "0 0 24 24",
                                    fill: "none",
                                    stroke: "currentColor",
                                    strokeWidth: 2,
                                    className: "h-4 w-4",
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                        d: "M12 5v14M5 12h14"
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/Timeline.tsx",
                                        lineNumber: 147,
                                        columnNumber: 21
                                    }, this)
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/Timeline.tsx",
                                    lineNumber: 139,
                                    columnNumber: 19
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/Timeline.tsx",
                                lineNumber: 133,
                                columnNumber: 17
                            }, this),
                            !isLast && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                xmlns: "http://www.w3.org/2000/svg",
                                viewBox: "0 0 24 24",
                                fill: "none",
                                stroke: "currentColor",
                                strokeWidth: 2,
                                strokeLinecap: "round",
                                strokeLinejoin: "round",
                                className: "h-3 w-3 flex-shrink-0 text-gray-400",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                    d: "M9 18l6-6-6-6"
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/Timeline.tsx",
                                    lineNumber: 162,
                                    columnNumber: 19
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/Timeline.tsx",
                                lineNumber: 152,
                                columnNumber: 17
                            }, this)
                        ]
                    }, scene.id, true, {
                        fileName: "[project]/app/material/editor/components/Timeline.tsx",
                        lineNumber: 112,
                        columnNumber: 13
                    }, this);
                })
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/Timeline.tsx",
                lineNumber: 107,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/material/editor/components/Timeline.tsx",
        lineNumber: 100,
        columnNumber: 5
    }, this);
}
_c1 = Timeline;
var _c, _c1;
__turbopack_context__.k.register(_c, "CanvasThumbnail");
__turbopack_context__.k.register(_c1, "Timeline");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/useImageAspectRatio.ts [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "useImageAspectRatio",
    ()=>useImageAspectRatio
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var _s = __turbopack_context__.k.signature();
;
function useImageAspectRatio(imageSrc) {
    _s();
    const [aspectRatio, setAspectRatio] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "useImageAspectRatio.useEffect": ()=>{
            if (!imageSrc) {
                setAspectRatio(null);
                return;
            }
            const img = new Image();
            img.onload = ({
                "useImageAspectRatio.useEffect": ()=>{
                    const ratio = img.naturalWidth / img.naturalHeight;
                    setAspectRatio(ratio);
                }
            })["useImageAspectRatio.useEffect"];
            img.onerror = ({
                "useImageAspectRatio.useEffect": ()=>{
                    setAspectRatio(null);
                }
            })["useImageAspectRatio.useEffect"];
            img.src = imageSrc;
            return ({
                "useImageAspectRatio.useEffect": ()=>{
                    img.onload = null;
                    img.onerror = null;
                }
            })["useImageAspectRatio.useEffect"];
        }
    }["useImageAspectRatio.useEffect"], [
        imageSrc
    ]);
    return aspectRatio;
}
_s(useImageAspectRatio, "lyBXZv9RyF2LMs5axocmHA+wGos=");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/AvatarCanvas.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "AvatarCanvas",
    ()=>AvatarCanvas
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/useImageAspectRatio.ts [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
function AvatarCanvas({ avatar, position, size, canvasSize, onRemove, onPointerDown, onResizeStart }) {
    _s();
    if (!avatar) return null;
    // Определяем соотношение сторон изображения
    const imageAspectRatio = (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useImageAspectRatio"])(avatar.photo);
    // Конвертируем пиксели канвы в проценты для отображения
    const leftPercent = position.x / canvasSize.width * 100;
    const topPercent = position.y / canvasSize.height * 100;
    const widthPercent = size.width / canvasSize.width * 100;
    const resizeHandles = [
        {
            corner: "top-left",
            cursor: "cursor-nwse-resize",
            position: "top-0 left-0"
        },
        {
            corner: "top-right",
            cursor: "cursor-nesw-resize",
            position: "top-0 right-0"
        },
        {
            corner: "bottom-left",
            cursor: "cursor-nesw-resize",
            position: "bottom-0 left-0"
        },
        {
            corner: "bottom-right",
            cursor: "cursor-nwse-resize",
            position: "bottom-0 right-0"
        }
    ];
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "group absolute cursor-grab active:cursor-grabbing",
        style: {
            left: `${leftPercent}%`,
            top: `${topPercent}%`,
            width: `${widthPercent}%`,
            aspectRatio: imageAspectRatio ? `${imageAspectRatio} / 1` : undefined,
            transform: "translate(-50%, -50%)"
        },
        onPointerDown: onPointerDown,
        role: "button",
        tabIndex: 0,
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("img", {
                src: avatar.photo,
                alt: avatar.name,
                className: "w-full h-full object-cover rounded-2xl"
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/AvatarCanvas.tsx",
                lineNumber: 65,
                columnNumber: 7
            }, this),
            resizeHandles.map(({ corner, cursor, position })=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: `absolute h-5 w-5 rounded-full bg-white border-2 border-gray-600 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity hover:border-gray-900 hover:scale-125 ${cursor} ${position}`,
                    style: {
                        transform: corner === "top-left" ? "translate(-50%, -50%)" : corner === "top-right" ? "translate(50%, -50%)" : corner === "bottom-left" ? "translate(-50%, 50%)" : "translate(50%, 50%)"
                    },
                    onPointerDown: (e)=>{
                        e.stopPropagation();
                        onResizeStart(e, corner);
                    },
                    role: "button",
                    tabIndex: 0
                }, corner, false, {
                    fileName: "[project]/app/material/editor/components/AvatarCanvas.tsx",
                    lineNumber: 73,
                    columnNumber: 9
                }, this)),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                type: "button",
                onClick: (e)=>{
                    e.stopPropagation();
                    onRemove();
                },
                className: "absolute right-0 top-0 flex items-center justify-center rounded-full bg-red-500 text-white opacity-0 transition-opacity hover:bg-red-600 group-hover:opacity-100 z-10",
                style: {
                    width: `${Math.min(40, Math.max(24, Math.min(size.width, size.height) * 0.08))}px`,
                    height: `${Math.min(40, Math.max(24, Math.min(size.width, size.height) * 0.08))}px`,
                    transform: 'translate(50%, -50%)'
                },
                "aria-label": "Удалить аватар",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                    xmlns: "http://www.w3.org/2000/svg",
                    viewBox: "0 0 24 24",
                    fill: "none",
                    stroke: "currentColor",
                    strokeWidth: 2.5,
                    className: "w-full h-full p-1",
                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                        d: "M18 6L6 18M6 6l12 12"
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/AvatarCanvas.tsx",
                        lineNumber: 117,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "[project]/app/material/editor/components/AvatarCanvas.tsx",
                    lineNumber: 109,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/AvatarCanvas.tsx",
                lineNumber: 95,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/material/editor/components/AvatarCanvas.tsx",
        lineNumber: 51,
        columnNumber: 5
    }, this);
}
_s(AvatarCanvas, "MeXULDdP4Klydiwp5O8/FH2CP7U=", false, function() {
    return [
        __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useImageAspectRatio"]
    ];
});
_c = AvatarCanvas;
var _c;
__turbopack_context__.k.register(_c, "AvatarCanvas");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/MediaCanvas.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "MediaCanvas",
    ()=>MediaCanvas
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/useImageAspectRatio.ts [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
function MediaCanvas({ element, canvasSize, onRemove, onPointerDown, onResizeStart }) {
    _s();
    if (!element.imageUrl) return null;
    // Определяем соотношение сторон изображения
    const imageAspectRatio = (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useImageAspectRatio"])(element.imageUrl);
    // Конвертируем пиксели канвы в проценты для отображения
    const leftPercent = element.x / canvasSize.width * 100;
    const topPercent = element.y / canvasSize.height * 100;
    const widthPercent = element.width / canvasSize.width * 100;
    const resizeHandles = [
        {
            corner: "top-left",
            cursor: "cursor-nwse-resize",
            position: "top-0 left-0"
        },
        {
            corner: "top-right",
            cursor: "cursor-nesw-resize",
            position: "top-0 right-0"
        },
        {
            corner: "bottom-left",
            cursor: "cursor-nesw-resize",
            position: "bottom-0 left-0"
        },
        {
            corner: "bottom-right",
            cursor: "cursor-nwse-resize",
            position: "bottom-0 right-0"
        }
    ];
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "group absolute cursor-grab active:cursor-grabbing",
        style: {
            left: `${leftPercent}%`,
            top: `${topPercent}%`,
            width: `${widthPercent}%`,
            aspectRatio: imageAspectRatio ? `${imageAspectRatio} / 1` : undefined,
            transform: "translate(-50%, -50%)"
        },
        onPointerDown: onPointerDown,
        role: "button",
        tabIndex: 0,
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("img", {
                src: element.imageUrl,
                alt: element.label,
                className: "w-full h-full object-cover rounded-2xl"
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/MediaCanvas.tsx",
                lineNumber: 60,
                columnNumber: 7
            }, this),
            resizeHandles.map(({ corner, cursor, position })=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: `absolute h-5 w-5 rounded-full bg-white border-2 border-gray-600 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity hover:border-gray-900 hover:scale-125 ${cursor} ${position}`,
                    style: {
                        transform: corner === "top-left" ? "translate(-50%, -50%)" : corner === "top-right" ? "translate(50%, -50%)" : corner === "bottom-left" ? "translate(-50%, 50%)" : "translate(50%, 50%)"
                    },
                    onPointerDown: (e)=>{
                        e.stopPropagation();
                        onResizeStart(e, corner);
                    },
                    role: "button",
                    tabIndex: 0
                }, corner, false, {
                    fileName: "[project]/app/material/editor/components/MediaCanvas.tsx",
                    lineNumber: 68,
                    columnNumber: 9
                }, this)),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                type: "button",
                onClick: (e)=>{
                    e.stopPropagation();
                    onRemove();
                },
                className: "absolute right-0 top-0 flex items-center justify-center rounded-full bg-red-500 text-white opacity-0 transition-opacity hover:bg-red-600 group-hover:opacity-100 z-10",
                style: {
                    width: `${Math.min(40, Math.max(24, Math.min(element.width, element.height) * 0.08))}px`,
                    height: `${Math.min(40, Math.max(24, Math.min(element.width, element.height) * 0.08))}px`,
                    transform: 'translate(50%, -50%)'
                },
                "aria-label": "Удалить медиа",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                    xmlns: "http://www.w3.org/2000/svg",
                    viewBox: "0 0 24 24",
                    fill: "none",
                    stroke: "currentColor",
                    strokeWidth: 2.5,
                    className: "w-full h-full p-1",
                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                        d: "M18 6L6 18M6 6l12 12"
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/MediaCanvas.tsx",
                        lineNumber: 112,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "[project]/app/material/editor/components/MediaCanvas.tsx",
                    lineNumber: 104,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/MediaCanvas.tsx",
                lineNumber: 90,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/material/editor/components/MediaCanvas.tsx",
        lineNumber: 46,
        columnNumber: 5
    }, this);
}
_s(MediaCanvas, "MeXULDdP4Klydiwp5O8/FH2CP7U=", false, function() {
    return [
        __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useImageAspectRatio"]
    ];
});
_c = MediaCanvas;
var _c;
__turbopack_context__.k.register(_c, "MediaCanvas");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/MediaCanvasWrapper.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "MediaCanvasWrapper",
    ()=>MediaCanvasWrapper
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$MediaCanvas$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/MediaCanvas.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/useImageAspectRatio.ts [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
;
;
function MediaCanvasWrapper({ element, canvasSize, onRemove, onPointerDown, onResizeStart, screenToCanvas, onElementSizeChange }) {
    _s();
    const imageAspectRatio = (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useImageAspectRatio"])(element.imageUrl ?? null);
    const handleResizeStart = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useCallback"])({
        "MediaCanvasWrapper.useCallback[handleResizeStart]": (event, corner)=>{
            if (!imageAspectRatio) return;
            event.preventDefault();
            event.stopPropagation();
            const startX = event.clientX;
            const startY = event.clientY;
            const initialWidth = element.width;
            const initialHeight = initialWidth / imageAspectRatio;
            const initialX = element.x;
            const initialY = element.y;
            const centerX = initialX;
            const centerY = initialY;
            const halfWidth = initialWidth / 2;
            const halfHeight = initialHeight / 2;
            let initialCornerX, initialCornerY;
            if (corner === "top-left") {
                initialCornerX = centerX - halfWidth;
                initialCornerY = centerY - halfHeight;
            } else if (corner === "top-right") {
                initialCornerX = centerX + halfWidth;
                initialCornerY = centerY - halfHeight;
            } else if (corner === "bottom-left") {
                initialCornerX = centerX - halfWidth;
                initialCornerY = centerY + halfHeight;
            } else {
                initialCornerX = centerX + halfWidth;
                initialCornerY = centerY + halfHeight;
            }
            const initialDistance = Math.sqrt(Math.pow(initialCornerX - centerX, 2) + Math.pow(initialCornerY - centerY, 2));
            let rafId = null;
            const handlePointerMove = {
                "MediaCanvasWrapper.useCallback[handleResizeStart].handlePointerMove": (moveEvent)=>{
                    if (rafId !== null) {
                        cancelAnimationFrame(rafId);
                    }
                    rafId = requestAnimationFrame({
                        "MediaCanvasWrapper.useCallback[handleResizeStart].handlePointerMove": ()=>{
                            const deltaXScreen = moveEvent.clientX - startX;
                            const deltaYScreen = moveEvent.clientY - startY;
                            const deltaX = screenToCanvas(deltaXScreen, "width");
                            const deltaY = screenToCanvas(deltaYScreen, "height");
                            const newCornerX = initialCornerX + deltaX;
                            const newCornerY = initialCornerY + deltaY;
                            const newDistance = Math.sqrt(Math.pow(newCornerX - centerX, 2) + Math.pow(newCornerY - centerY, 2));
                            const scale = newDistance / initialDistance;
                            let newWidth = initialWidth * scale;
                            let newHeight = newWidth / imageAspectRatio;
                            const minSizePx = Math.min(canvasSize.width, canvasSize.height) * 0.05;
                            const maxWidthPx = canvasSize.width; // Максимальная ширина = 100% ширины канвы
                            const maxHeightPx = canvasSize.height; // Максимальная высота = 100% высоты канвы
                            if (newWidth > maxWidthPx) {
                                newWidth = maxWidthPx;
                                newHeight = newWidth / imageAspectRatio;
                            }
                            if (newWidth < minSizePx) {
                                newWidth = minSizePx;
                                newHeight = newWidth / imageAspectRatio;
                            }
                            if (newHeight > maxHeightPx) {
                                newHeight = maxHeightPx;
                                newWidth = newHeight * imageAspectRatio;
                            }
                            if (newHeight < minSizePx) {
                                newHeight = minSizePx;
                                newWidth = newHeight * imageAspectRatio;
                            }
                            onElementSizeChange(element.id, {
                                width: newWidth,
                                height: newHeight
                            });
                            rafId = null;
                        }
                    }["MediaCanvasWrapper.useCallback[handleResizeStart].handlePointerMove"]);
                }
            }["MediaCanvasWrapper.useCallback[handleResizeStart].handlePointerMove"];
            const handlePointerUp = {
                "MediaCanvasWrapper.useCallback[handleResizeStart].handlePointerUp": ()=>{
                    if (rafId !== null) {
                        cancelAnimationFrame(rafId);
                        rafId = null;
                    }
                    window.removeEventListener("pointermove", handlePointerMove);
                    window.removeEventListener("pointerup", handlePointerUp);
                }
            }["MediaCanvasWrapper.useCallback[handleResizeStart].handlePointerUp"];
            window.addEventListener("pointermove", handlePointerMove);
            window.addEventListener("pointerup", handlePointerUp);
        }
    }["MediaCanvasWrapper.useCallback[handleResizeStart]"], [
        element,
        imageAspectRatio,
        screenToCanvas,
        canvasSize,
        onElementSizeChange
    ]);
    if (!imageAspectRatio) {
        return null;
    }
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$MediaCanvas$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MediaCanvas"], {
        element: element,
        canvasSize: canvasSize,
        onRemove: onRemove,
        onPointerDown: onPointerDown,
        onResizeStart: handleResizeStart
    }, void 0, false, {
        fileName: "[project]/app/material/editor/components/MediaCanvasWrapper.tsx",
        lineNumber: 147,
        columnNumber: 5
    }, this);
}
_s(MediaCanvasWrapper, "u3yimclVmjtf4Sg3ahBNBrU9QYc=", false, function() {
    return [
        __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useImageAspectRatio"]
    ];
});
_c = MediaCanvasWrapper;
var _c;
__turbopack_context__.k.register(_c, "MediaCanvasWrapper");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/LayersPanel.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "LayersPanel",
    ()=>LayersPanel
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
function LayersPanel({ isOpen, onClose, elements, avatar, avatarZIndex, avatarLocked, onReorderLayers, onToggleAvatarLock, panelRef }) {
    _s();
    const [draggedId, setDraggedId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [dragOverId, setDragOverId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    // Создаем список слоев: элементы и аватар отсортированные по zIndex (больший zIndex = выше = первый в списке)
    const layers = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useMemo"])({
        "LayersPanel.useMemo[layers]": ()=>{
            const allLayers = [
                ...elements.map({
                    "LayersPanel.useMemo[layers]": (el)=>({
                            id: el.id,
                            type: "media",
                            label: el.label,
                            thumbnail: el.imageUrl,
                            zIndex: el.zIndex ?? 0
                        })
                }["LayersPanel.useMemo[layers]"]),
                ...avatar ? [
                    {
                        id: "avatar",
                        type: "avatar",
                        label: avatar.name,
                        thumbnail: avatar.photo,
                        zIndex: avatarZIndex ?? 9999
                    }
                ] : []
            ];
            return allLayers.sort({
                "LayersPanel.useMemo[layers]": (a, b)=>b.zIndex - a.zIndex
            }["LayersPanel.useMemo[layers]"]); // Больший zIndex = первый в списке
        }
    }["LayersPanel.useMemo[layers]"], [
        elements,
        avatar,
        avatarZIndex
    ]);
    const handleDragStart = (e, id)=>{
        // Аватар не перетаскивается, если заблокирован
        if (id === "avatar" && avatarLocked) {
            e.preventDefault();
            return;
        }
        setDraggedId(id);
        e.dataTransfer.effectAllowed = "move";
        e.dataTransfer.setData("text/plain", id);
    };
    const handleDragOver = (e, id)=>{
        // Нельзя перетаскивать на заблокированный аватар или перетаскивать заблокированный аватар
        if (id === "avatar" && avatarLocked || draggedId === "avatar" && avatarLocked) {
            return;
        }
        e.preventDefault();
        e.stopPropagation();
        if (draggedId && draggedId !== id) {
            setDragOverId(id);
        }
    };
    const handleDragLeave = ()=>{
        setDragOverId(null);
    };
    const handleDrop = (e, targetId)=>{
        e.preventDefault();
        e.stopPropagation();
        // Нельзя перетаскивать на заблокированный аватар или перетаскивать заблокированный аватар
        if (targetId === "avatar" && avatarLocked || !draggedId || draggedId === targetId || draggedId === "avatar" && avatarLocked) {
            setDraggedId(null);
            setDragOverId(null);
            return;
        }
        // Используем актуальный список layers
        const currentLayers = [
            ...elements.map((el)=>({
                    id: el.id,
                    type: "media",
                    label: el.label,
                    thumbnail: el.imageUrl,
                    zIndex: el.zIndex ?? 0
                })),
            ...avatar ? [
                {
                    id: "avatar",
                    type: "avatar",
                    label: avatar.name,
                    thumbnail: avatar.photo,
                    zIndex: avatarZIndex ?? 9999
                }
            ] : []
        ].sort((a, b)=>b.zIndex - a.zIndex);
        const draggedIndex = currentLayers.findIndex((l)=>l.id === draggedId);
        const targetIndex = currentLayers.findIndex((l)=>l.id === targetId);
        if (draggedIndex === -1 || targetIndex === -1) {
            setDraggedId(null);
            setDragOverId(null);
            return;
        }
        // Создаем новый порядок слоев
        const newLayers = [
            ...currentLayers
        ];
        const [draggedLayer] = newLayers.splice(draggedIndex, 1);
        newLayers.splice(targetIndex, 0, draggedLayer);
        // Обновляем zIndex: первый в списке (index 0) = больший zIndex = выше на канве
        const newOrder = newLayers.map((l)=>l.id);
        onReorderLayers(newOrder);
        setDraggedId(null);
        setDragOverId(null);
    };
    const handleDragEnd = ()=>{
        setDraggedId(null);
        setDragOverId(null);
    };
    if (!isOpen) return null;
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        ref: panelRef,
        className: "absolute right-0 top-full z-50 mt-2 w-[416px] rounded-xl border border-gray-200 bg-white shadow-lg",
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
            className: "p-4",
            children: [
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "mb-4",
                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h2", {
                        className: "text-lg font-semibold text-gray-900",
                        children: "Слои"
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                        lineNumber: 161,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                    lineNumber: 160,
                    columnNumber: 9
                }, this),
                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "space-y-2",
                    children: layers.length === 0 ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                        className: "py-8 text-center text-sm text-gray-500",
                        children: "Нет элементов на канве"
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                        lineNumber: 166,
                        columnNumber: 13
                    }, this) : layers.map((layer, index)=>{
                        const isAvatar = layer.type === "avatar";
                        const isLocked = isAvatar && avatarLocked;
                        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            draggable: !isLocked,
                            onDragStart: (e)=>handleDragStart(e, layer.id),
                            onDragOver: (e)=>handleDragOver(e, layer.id),
                            onDragLeave: handleDragLeave,
                            onDrop: (e)=>handleDrop(e, layer.id),
                            onDragEnd: handleDragEnd,
                            className: `flex items-center gap-3 rounded-xl border-2 p-3 transition ${draggedId === layer.id ? "cursor-move opacity-50" : dragOverId === layer.id && !isLocked ? "cursor-move border-blue-500 bg-blue-50" : isLocked ? "cursor-default border-gray-200 bg-gray-50" : "cursor-move border-gray-200 hover:border-gray-300"}`,
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-gray-100 text-xs font-semibold text-gray-600",
                                    children: index + 1
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                    lineNumber: 192,
                                    columnNumber: 17
                                }, this),
                                layer.thumbnail ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "relative h-10 w-10 flex-shrink-0 overflow-hidden rounded-lg",
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("img", {
                                        src: layer.thumbnail,
                                        alt: layer.label,
                                        className: "h-full w-full object-cover"
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                        lineNumber: 197,
                                        columnNumber: 21
                                    }, this)
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                    lineNumber: 196,
                                    columnNumber: 19
                                }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-gray-200",
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                        className: "text-xs text-gray-500",
                                        children: layer.type === "avatar" ? "👤" : "📄"
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                        lineNumber: 205,
                                        columnNumber: 21
                                    }, this)
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                    lineNumber: 204,
                                    columnNumber: 19
                                }, this),
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex-1 min-w-0",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                            className: "text-sm font-medium text-gray-900 truncate",
                                            children: layer.label
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                            lineNumber: 211,
                                            columnNumber: 19
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                            className: "text-xs text-gray-500 truncate",
                                            children: layer.type === "avatar" ? "Аватар" : "Медиа"
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                            lineNumber: 212,
                                            columnNumber: 19
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                    lineNumber: 210,
                                    columnNumber: 17
                                }, this),
                                isAvatar ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                    type: "button",
                                    onClick: (e)=>{
                                        e.stopPropagation();
                                        onToggleAvatarLock();
                                    },
                                    className: `flex-shrink-0 rounded-lg px-3 py-1.5 text-xs font-medium transition ${avatarLocked ? "bg-red-100 text-red-600 hover:bg-red-200" : "bg-green-100 text-green-600 hover:bg-green-200"}`,
                                    "aria-label": avatarLocked ? "Разблокировать аватар" : "Заблокировать аватар",
                                    children: avatarLocked ? "Заблокирован" : "Разблокирован"
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                    lineNumber: 217,
                                    columnNumber: 20
                                }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                    xmlns: "http://www.w3.org/2000/svg",
                                    viewBox: "0 0 24 24",
                                    fill: "none",
                                    stroke: "currentColor",
                                    strokeWidth: 2,
                                    className: "h-5 w-5 flex-shrink-0 text-gray-400",
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                        d: "M8 9h8M8 15h8"
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                        lineNumber: 241,
                                        columnNumber: 21
                                    }, this)
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                                    lineNumber: 233,
                                    columnNumber: 19
                                }, this)
                            ]
                        }, layer.id, true, {
                            fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                            lineNumber: 174,
                            columnNumber: 15
                        }, this);
                    })
                }, void 0, false, {
                    fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
                    lineNumber: 164,
                    columnNumber: 9
                }, this)
            ]
        }, void 0, true, {
            fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
            lineNumber: 159,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "[project]/app/material/editor/components/LayersPanel.tsx",
        lineNumber: 155,
        columnNumber: 5
    }, this);
}
_s(LayersPanel, "HDz9tqLsSNvdMEaqZKjF6EVxhMU=");
_c = LayersPanel;
var _c;
__turbopack_context__.k.register(_c, "LayersPanel");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/CanvasArea.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CanvasArea",
    ()=>CanvasArea
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$AvatarCanvas$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/AvatarCanvas.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$MediaCanvasWrapper$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/MediaCanvasWrapper.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$LayersPanel$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/LayersPanel.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/useImageAspectRatio.ts [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
;
;
;
;
// Размеры канвы в пикселях
const CANVAS_SIZES = {
    "16:9": {
        width: 1920,
        height: 1080
    },
    "9:16": {
        width: 1080,
        height: 1920
    }
};
function CanvasArea({ aspectRatio, elements, avatar, avatarPosition, avatarSize, avatarZIndex, avatarLocked, onElementPositionChange, onElementSizeChange, onRemoveElement, onReorderLayers, onAvatarPositionChange, onAvatarSizeChange, onAddMediaAsset, onRemoveAvatar, onToggleAvatarLock }) {
    _s();
    const canvasRef = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])(null);
    const fileInputRef = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])(null);
    const layersButtonRef = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])(null);
    const layersPanelRef = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])(null);
    const mediaButtonRef = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])(null);
    const mediaPanelRef = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])(null);
    const layersCloseTimeoutRef = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])(null);
    const mediaCloseTimeoutRef = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRef"])(null);
    const [isLayersPanelOpen, setIsLayersPanelOpen] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(false);
    const [isMediaPanelOpen, setIsMediaPanelOpen] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(false);
    // Закрытие меню слоев при клике вне его
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "CanvasArea.useEffect": ()=>{
            const handleClickOutside = {
                "CanvasArea.useEffect.handleClickOutside": (event)=>{
                    if (isLayersPanelOpen && layersButtonRef.current && layersPanelRef.current && !layersButtonRef.current.contains(event.target) && !layersPanelRef.current.contains(event.target)) {
                        setIsLayersPanelOpen(false);
                    }
                }
            }["CanvasArea.useEffect.handleClickOutside"];
            document.addEventListener("mousedown", handleClickOutside);
            return ({
                "CanvasArea.useEffect": ()=>{
                    document.removeEventListener("mousedown", handleClickOutside);
                }
            })["CanvasArea.useEffect"];
        }
    }["CanvasArea.useEffect"], [
        isLayersPanelOpen
    ]);
    // Закрытие меню медиа при клике вне его
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "CanvasArea.useEffect": ()=>{
            const handleClickOutside = {
                "CanvasArea.useEffect.handleClickOutside": (event)=>{
                    if (isMediaPanelOpen && mediaButtonRef.current && mediaPanelRef.current && !mediaButtonRef.current.contains(event.target) && !mediaPanelRef.current.contains(event.target)) {
                        setIsMediaPanelOpen(false);
                    }
                }
            }["CanvasArea.useEffect.handleClickOutside"];
            document.addEventListener("mousedown", handleClickOutside);
            return ({
                "CanvasArea.useEffect": ()=>{
                    document.removeEventListener("mousedown", handleClickOutside);
                }
            })["CanvasArea.useEffect"];
        }
    }["CanvasArea.useEffect"], [
        isMediaPanelOpen
    ]);
    // Обработчики для автоматического закрытия меню слоев
    const handleLayersMouseEnter = ()=>{
        if (layersCloseTimeoutRef.current) {
            clearTimeout(layersCloseTimeoutRef.current);
            layersCloseTimeoutRef.current = null;
        }
    };
    const handleLayersMouseLeave = ()=>{
        layersCloseTimeoutRef.current = setTimeout(()=>{
            setIsLayersPanelOpen(false);
        }, 500);
    };
    // Обработчики для автоматического закрытия меню медиа
    const handleMediaMouseEnter = ()=>{
        if (mediaCloseTimeoutRef.current) {
            clearTimeout(mediaCloseTimeoutRef.current);
            mediaCloseTimeoutRef.current = null;
        }
    };
    const handleMediaMouseLeave = ()=>{
        mediaCloseTimeoutRef.current = setTimeout(()=>{
            setIsMediaPanelOpen(false);
        }, 500);
    };
    // Очистка таймеров при размонтировании
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "CanvasArea.useEffect": ()=>{
            return ({
                "CanvasArea.useEffect": ()=>{
                    if (layersCloseTimeoutRef.current) {
                        clearTimeout(layersCloseTimeoutRef.current);
                    }
                    if (mediaCloseTimeoutRef.current) {
                        clearTimeout(mediaCloseTimeoutRef.current);
                    }
                }
            })["CanvasArea.useEffect"];
        }
    }["CanvasArea.useEffect"], []);
    const [draggingElementId, setDraggingElementId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [dragCoords, setDragCoords] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [draggingAvatar, setDraggingAvatar] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(false);
    const [avatarDragCoords, setAvatarDragCoords] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const [snapPoint, setSnapPoint] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(null);
    const canvasSize = CANVAS_SIZES[aspectRatio];
    // Получаем пропорции изображения аватара для правильного масштабирования
    const avatarImageAspectRatio = (0, __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useImageAspectRatio"])(avatar?.photo ?? null);
    // Получаем пропорции изображений медиа элементов
    const mediaImageAspectRatios = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useMemo"])({
        "CanvasArea.useMemo[mediaImageAspectRatios]": ()=>{
            const ratios = {};
            elements.forEach({
                "CanvasArea.useMemo[mediaImageAspectRatios]": (element)=>{
                    if (element.imageUrl) {
                        ratios[element.id] = null; // Будет установлено через хук
                    }
                }
            }["CanvasArea.useMemo[mediaImageAspectRatios]"]);
            return ratios;
        }
    }["CanvasArea.useMemo[mediaImageAspectRatios]"], [
        elements
    ]);
    // Определяем линии привязки
    const snapLines = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useMemo"])({
        "CanvasArea.useMemo[snapLines]": ()=>{
            const snapDistance = 160; // Расстояние от углов
            return {
                vertical: [
                    snapDistance,
                    canvasSize.width - snapDistance,
                    canvasSize.width / 2
                ],
                horizontal: [
                    snapDistance,
                    canvasSize.height - snapDistance,
                    canvasSize.height / 2
                ]
            };
        }
    }["CanvasArea.useMemo[snapLines]"], [
        canvasSize
    ]);
    // Определяем точки привязки (пересечения линий)
    const snapPoints = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useMemo"])({
        "CanvasArea.useMemo[snapPoints]": ()=>{
            const snapDistance = 160;
            return [
                {
                    x: snapDistance,
                    y: snapDistance,
                    type: 'top-left'
                },
                {
                    x: canvasSize.width - snapDistance,
                    y: snapDistance,
                    type: 'top-right'
                },
                {
                    x: snapDistance,
                    y: canvasSize.height - snapDistance,
                    type: 'bottom-left'
                },
                {
                    x: canvasSize.width - snapDistance,
                    y: canvasSize.height - snapDistance,
                    type: 'bottom-right'
                },
                {
                    x: canvasSize.width / 2,
                    y: canvasSize.height / 2,
                    type: 'center'
                }
            ];
        }
    }["CanvasArea.useMemo[snapPoints]"], [
        canvasSize
    ]);
    // Проверка привязки к линиям и точкам
    const checkSnap = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useCallback"])({
        "CanvasArea.useCallback[checkSnap]": (x, y, threshold = 20)=>{
            let snapX = null;
            let snapY = null;
            let snapType = '';
            // Проверяем привязку к вертикальным линиям
            for (const lineX of snapLines.vertical){
                if (Math.abs(x - lineX) <= threshold) {
                    snapX = lineX;
                    break;
                }
            }
            // Проверяем привязку к горизонтальным линиям
            for (const lineY of snapLines.horizontal){
                if (Math.abs(y - lineY) <= threshold) {
                    snapY = lineY;
                    break;
                }
            }
            // Проверяем привязку к точкам (пересечениям линий)
            for (const point of snapPoints){
                const distance = Math.sqrt(Math.pow(x - point.x, 2) + Math.pow(y - point.y, 2));
                if (distance <= threshold) {
                    // Если попали в точку, используем координаты точки
                    snapX = point.x;
                    snapY = point.y;
                    snapType = point.type;
                    break;
                }
            }
            // Если есть привязка хотя бы по одной оси
            if (snapX !== null || snapY !== null) {
                return {
                    x: snapX,
                    y: snapY,
                    type: snapType || (snapX !== null && snapY !== null ? 'intersection' : snapX !== null ? 'vertical' : 'horizontal')
                };
            }
            return null;
        }
    }["CanvasArea.useCallback[checkSnap]"], [
        snapLines,
        snapPoints
    ]);
    // Конвертирует пиксели канвы в пиксели экрана
    const canvasToScreen = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useCallback"])({
        "CanvasArea.useCallback[canvasToScreen]": (canvasPx, dimension)=>{
            const canvas = canvasRef.current;
            if (!canvas) return 0;
            const rect = canvas.getBoundingClientRect();
            const screenSize = dimension === "width" ? rect.width : rect.height;
            const canvasSizePx = dimension === "width" ? canvasSize.width : canvasSize.height;
            return canvasPx / canvasSizePx * screenSize;
        }
    }["CanvasArea.useCallback[canvasToScreen]"], [
        canvasSize
    ]);
    // Конвертирует пиксели экрана в пиксели канвы
    const screenToCanvas = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useCallback"])({
        "CanvasArea.useCallback[screenToCanvas]": (screenPx, dimension)=>{
            const canvas = canvasRef.current;
            if (!canvas) return 0;
            const rect = canvas.getBoundingClientRect();
            const screenSize = dimension === "width" ? rect.width : rect.height;
            const canvasSizePx = dimension === "width" ? canvasSize.width : canvasSize.height;
            return screenPx / screenSize * canvasSizePx;
        }
    }["CanvasArea.useCallback[screenToCanvas]"], [
        canvasSize
    ]);
    const handlePointerDown = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useCallback"])({
        "CanvasArea.useCallback[handlePointerDown]": (event, element)=>{
            event.preventDefault();
            const canvas = canvasRef.current;
            if (!canvas) return;
            setDraggingElementId(element.id);
            const canvasRect = canvas.getBoundingClientRect();
            // Вычисляем позицию мыши относительно канвы
            const mouseXRelative = event.clientX - canvasRect.left;
            const mouseYRelative = event.clientY - canvasRect.top;
            // Конвертируем в пиксели канвы
            const mouseXCanvas = screenToCanvas(mouseXRelative, "width");
            const mouseYCanvas = screenToCanvas(mouseYRelative, "height");
            // Вычисляем смещение мыши относительно центра элемента
            const offsetX = mouseXCanvas - element.x;
            const offsetY = mouseYCanvas - element.y;
            const startX = event.clientX;
            const startY = event.clientY;
            const initialX = element.x;
            const initialY = element.y;
            const handlePointerMove = {
                "CanvasArea.useCallback[handlePointerDown].handlePointerMove": (moveEvent)=>{
                    const deltaXScreen = moveEvent.clientX - startX;
                    const deltaYScreen = moveEvent.clientY - startY;
                    // Конвертируем смещение экрана в пиксели канвы
                    const deltaX = screenToCanvas(deltaXScreen, "width");
                    const deltaY = screenToCanvas(deltaYScreen, "height");
                    // Вычисляем новую позицию центра элемента с учетом смещения мыши
                    let nextX = initialX + deltaX;
                    let nextY = initialY + deltaY;
                    // Ограничиваем позицию так, чтобы элемент не выходил за границы канвы
                    const halfWidth = element.width / 2;
                    const halfHeight = element.height / 2;
                    nextX = Math.min(canvasSize.width - halfWidth, Math.max(halfWidth, nextX));
                    nextY = Math.min(canvasSize.height - halfHeight, Math.max(halfHeight, nextY));
                    setDragCoords({
                        x: Math.round(nextX),
                        y: Math.round(nextY)
                    });
                    onElementPositionChange(element.id, {
                        x: nextX,
                        y: nextY
                    });
                }
            }["CanvasArea.useCallback[handlePointerDown].handlePointerMove"];
            const handlePointerUp = {
                "CanvasArea.useCallback[handlePointerDown].handlePointerUp": ()=>{
                    setDraggingElementId(null);
                    setDragCoords(null);
                    window.removeEventListener("pointermove", handlePointerMove);
                    window.removeEventListener("pointerup", handlePointerUp);
                }
            }["CanvasArea.useCallback[handlePointerDown].handlePointerUp"];
            window.addEventListener("pointermove", handlePointerMove);
            window.addEventListener("pointerup", handlePointerUp);
        }
    }["CanvasArea.useCallback[handlePointerDown]"], [
        onElementPositionChange,
        screenToCanvas,
        canvasSize
    ]);
    const handleAvatarPointerDown = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useCallback"])({
        "CanvasArea.useCallback[handleAvatarPointerDown]": (event)=>{
            event.preventDefault();
            const canvas = canvasRef.current;
            if (!canvas) return;
            setDraggingAvatar(true);
            const startX = event.clientX;
            const startY = event.clientY;
            // Начальная позиция центра аватара в пикселях канвы
            const initialX = Math.max(0, Math.min(canvasSize.width, avatarPosition.x));
            const initialY = Math.max(0, Math.min(canvasSize.height, avatarPosition.y));
            let rafId = null;
            const handlePointerMove = {
                "CanvasArea.useCallback[handleAvatarPointerDown].handlePointerMove": (moveEvent)=>{
                    if (rafId !== null) {
                        cancelAnimationFrame(rafId);
                    }
                    rafId = requestAnimationFrame({
                        "CanvasArea.useCallback[handleAvatarPointerDown].handlePointerMove": ()=>{
                            const deltaXScreen = moveEvent.clientX - startX;
                            const deltaYScreen = moveEvent.clientY - startY;
                            // Конвертируем смещение экрана в пиксели канвы
                            const deltaX = screenToCanvas(deltaXScreen, "width");
                            const deltaY = screenToCanvas(deltaYScreen, "height");
                            // Вычисляем новую позицию центра аватара
                            let nextX = initialX + deltaX;
                            let nextY = initialY + deltaY;
                            // Проверяем привязку к линиям и точкам
                            const snap = checkSnap(nextX, nextY);
                            if (snap) {
                                // Фиксируем координаты только если есть привязка по соответствующей оси
                                if (snap.x !== null) {
                                    nextX = snap.x;
                                }
                                if (snap.y !== null) {
                                    nextY = snap.y;
                                }
                                setSnapPoint(snap);
                            } else {
                                setSnapPoint(null);
                            }
                            // Ограничиваем позицию так, чтобы центр аватара не выходил за границы канвы
                            nextX = Math.max(0, Math.min(canvasSize.width, nextX));
                            nextY = Math.max(0, Math.min(canvasSize.height, nextY));
                            setAvatarDragCoords({
                                x: Math.round(nextX),
                                y: Math.round(nextY)
                            });
                            onAvatarPositionChange({
                                x: nextX,
                                y: nextY
                            });
                            rafId = null;
                        }
                    }["CanvasArea.useCallback[handleAvatarPointerDown].handlePointerMove"]);
                }
            }["CanvasArea.useCallback[handleAvatarPointerDown].handlePointerMove"];
            const handlePointerUp = {
                "CanvasArea.useCallback[handleAvatarPointerDown].handlePointerUp": ()=>{
                    setDraggingAvatar(false);
                    setAvatarDragCoords(null);
                    setSnapPoint(null);
                    if (rafId !== null) {
                        cancelAnimationFrame(rafId);
                        rafId = null;
                    }
                    window.removeEventListener("pointermove", handlePointerMove);
                    window.removeEventListener("pointerup", handlePointerUp);
                }
            }["CanvasArea.useCallback[handleAvatarPointerDown].handlePointerUp"];
            window.addEventListener("pointermove", handlePointerMove);
            window.addEventListener("pointerup", handlePointerUp);
        }
    }["CanvasArea.useCallback[handleAvatarPointerDown]"], [
        avatarPosition,
        onAvatarPositionChange,
        screenToCanvas,
        canvasSize,
        checkSnap
    ]);
    const handleAvatarResizeStart = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useCallback"])({
        "CanvasArea.useCallback[handleAvatarResizeStart]": (event, corner)=>{
            event.preventDefault();
            event.stopPropagation();
            const canvas = canvasRef.current;
            if (!canvas) return;
            const startX = event.clientX;
            const startY = event.clientY;
            const initialWidth = avatarSize.width;
            // Высота вычисляется автоматически на основе ширины и пропорций изображения
            const initialHeight = avatarImageAspectRatio ? initialWidth / avatarImageAspectRatio : avatarSize.height;
            const initialX = avatarPosition.x;
            const initialY = avatarPosition.y;
            // Вычисляем начальную позицию угла в пикселях канвы
            const centerX = initialX;
            const centerY = initialY;
            const halfWidth = initialWidth / 2;
            const halfHeight = initialHeight / 2;
            let initialCornerX, initialCornerY;
            if (corner === "top-left") {
                initialCornerX = centerX - halfWidth;
                initialCornerY = centerY - halfHeight;
            } else if (corner === "top-right") {
                initialCornerX = centerX + halfWidth;
                initialCornerY = centerY - halfHeight;
            } else if (corner === "bottom-left") {
                initialCornerX = centerX - halfWidth;
                initialCornerY = centerY + halfHeight;
            } else {
                // bottom-right
                initialCornerX = centerX + halfWidth;
                initialCornerY = centerY + halfHeight;
            }
            // Начальное расстояние от центра до угла (для расчета масштаба)
            const initialDistance = Math.sqrt(Math.pow(initialCornerX - centerX, 2) + Math.pow(initialCornerY - centerY, 2));
            let rafId = null;
            const handlePointerMove = {
                "CanvasArea.useCallback[handleAvatarResizeStart].handlePointerMove": (moveEvent)=>{
                    if (rafId !== null) {
                        cancelAnimationFrame(rafId);
                    }
                    rafId = requestAnimationFrame({
                        "CanvasArea.useCallback[handleAvatarResizeStart].handlePointerMove": ()=>{
                            const deltaXScreen = moveEvent.clientX - startX;
                            const deltaYScreen = moveEvent.clientY - startY;
                            // Конвертируем смещение экрана в пиксели канвы
                            const deltaX = screenToCanvas(deltaXScreen, "width");
                            const deltaY = screenToCanvas(deltaYScreen, "height");
                            // Вычисляем новую позицию угла в пикселях канвы
                            const newCornerX = initialCornerX + deltaX;
                            const newCornerY = initialCornerY + deltaY;
                            // Вычисляем новое расстояние от центра до угла
                            const newDistance = Math.sqrt(Math.pow(newCornerX - centerX, 2) + Math.pow(newCornerY - centerY, 2));
                            // Масштабируем на основе изменения расстояния
                            const scale = newDistance / initialDistance;
                            // Вычисляем новую ширину
                            let newWidth = initialWidth * scale;
                            // Вычисляем высоту автоматически на основе ширины и пропорций изображения
                            let newHeight = avatarImageAspectRatio ? newWidth / avatarImageAspectRatio : initialHeight * scale;
                            // Ограничиваем минимальный и максимальный размер в пикселях
                            const minSizePx = Math.min(canvasSize.width, canvasSize.height) * 0.05; // минимум 5% от меньшей стороны
                            const maxSizePx = Math.min(canvasSize.width, canvasSize.height) * 0.95; // максимум 95% от меньшей стороны
                            // Ограничиваем ширину
                            if (newWidth > maxSizePx) {
                                newWidth = maxSizePx;
                                newHeight = avatarImageAspectRatio ? newWidth / avatarImageAspectRatio : newHeight;
                            }
                            if (newWidth < minSizePx) {
                                newWidth = minSizePx;
                                newHeight = avatarImageAspectRatio ? newWidth / avatarImageAspectRatio : newHeight;
                            }
                            // Ограничиваем высоту (если она слишком большая)
                            if (newHeight > maxSizePx) {
                                newHeight = maxSizePx;
                                newWidth = avatarImageAspectRatio ? newHeight * avatarImageAspectRatio : newWidth;
                            }
                            if (newHeight < minSizePx) {
                                newHeight = minSizePx;
                                newWidth = avatarImageAspectRatio ? newHeight * avatarImageAspectRatio : newWidth;
                            }
                            onAvatarSizeChange({
                                width: newWidth,
                                height: newHeight
                            });
                            rafId = null;
                        }
                    }["CanvasArea.useCallback[handleAvatarResizeStart].handlePointerMove"]);
                }
            }["CanvasArea.useCallback[handleAvatarResizeStart].handlePointerMove"];
            const handlePointerUp = {
                "CanvasArea.useCallback[handleAvatarResizeStart].handlePointerUp": ()=>{
                    if (rafId !== null) {
                        cancelAnimationFrame(rafId);
                        rafId = null;
                    }
                    window.removeEventListener("pointermove", handlePointerMove);
                    window.removeEventListener("pointerup", handlePointerUp);
                }
            }["CanvasArea.useCallback[handleAvatarResizeStart].handlePointerUp"];
            window.addEventListener("pointermove", handlePointerMove);
            window.addEventListener("pointerup", handlePointerUp);
        }
    }["CanvasArea.useCallback[handleAvatarResizeStart]"], [
        avatarPosition,
        avatarSize,
        onAvatarSizeChange,
        screenToCanvas,
        canvasSize,
        avatarImageAspectRatio
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "flex h-full flex-col rounded-3xl border border-gray-100 bg-white p-4 shadow-sm ring-1 ring-black/5",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "mb-3 flex flex-shrink-0 items-center justify-between",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                className: "text-sm font-semibold text-gray-900",
                                children: "Редактор"
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                lineNumber: 532,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                className: "text-xs text-gray-500",
                                children: [
                                    "Соотношение сторон ",
                                    aspectRatio
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                lineNumber: 533,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                        lineNumber: 531,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex items-center gap-2",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("input", {
                                        ref: fileInputRef,
                                        type: "file",
                                        accept: "image/*",
                                        multiple: true,
                                        className: "hidden",
                                        onChange: (e)=>{
                                            const files = e.target.files;
                                            if (files && files.length > 0) {
                                                Array.from(files).forEach((file)=>{
                                                    const imageUrl = URL.createObjectURL(file);
                                                    const fileName = file.name;
                                                    onAddMediaAsset(imageUrl, fileName);
                                                });
                                            }
                                            // Сброс input для возможности повторной загрузки того же файла
                                            if (e.target) {
                                                e.target.value = "";
                                            }
                                        }
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 539,
                                        columnNumber: 13
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "relative",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                ref: mediaButtonRef,
                                                type: "button",
                                                onClick: ()=>{
                                                    if (mediaCloseTimeoutRef.current) {
                                                        clearTimeout(mediaCloseTimeoutRef.current);
                                                        mediaCloseTimeoutRef.current = null;
                                                    }
                                                    setIsMediaPanelOpen(!isMediaPanelOpen);
                                                },
                                                onMouseEnter: handleMediaMouseEnter,
                                                onMouseLeave: handleMediaMouseLeave,
                                                className: "flex h-9 min-w-[100px] items-center justify-center gap-2 rounded-2xl border border-gray-200 px-4 text-xs font-semibold text-gray-900 transition hover:bg-gray-50",
                                                children: [
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                        className: "text-base leading-none",
                                                        children: "＋"
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                        lineNumber: 575,
                                                        columnNumber: 17
                                                    }, this),
                                                    " Медиа"
                                                ]
                                            }, void 0, true, {
                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                lineNumber: 561,
                                                columnNumber: 15
                                            }, this),
                                            isMediaPanelOpen && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                ref: mediaPanelRef,
                                                onMouseEnter: handleMediaMouseEnter,
                                                onMouseLeave: handleMediaMouseLeave,
                                                className: "absolute right-0 top-full z-50 mt-2 w-[416px] rounded-xl border border-gray-200 bg-white shadow-lg",
                                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                    className: "p-4",
                                                    children: [
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                            className: "mb-4",
                                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("h2", {
                                                                className: "text-lg font-semibold text-gray-900",
                                                                children: "Медиа"
                                                            }, void 0, false, {
                                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                lineNumber: 586,
                                                                columnNumber: 23
                                                            }, this)
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                            lineNumber: 585,
                                                            columnNumber: 21
                                                        }, this),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                            className: "space-y-2",
                                                            children: [
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                                    type: "button",
                                                                    onClick: ()=>{
                                                                        fileInputRef.current?.click();
                                                                        setIsMediaPanelOpen(false);
                                                                    },
                                                                    className: "flex w-full items-center gap-3 rounded-xl border-2 border-dashed border-gray-300 p-3 transition hover:border-gray-400 hover:bg-gray-50",
                                                                    children: [
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                            className: "flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-gray-100",
                                                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                                className: "text-xl",
                                                                                children: "＋"
                                                                            }, void 0, false, {
                                                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                lineNumber: 598,
                                                                                columnNumber: 27
                                                                            }, this)
                                                                        }, void 0, false, {
                                                                            fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                            lineNumber: 597,
                                                                            columnNumber: 25
                                                                        }, this),
                                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                            className: "flex-1 text-left",
                                                                            children: [
                                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                                    className: "text-sm font-medium text-gray-900",
                                                                                    children: "Добавить медиа"
                                                                                }, void 0, false, {
                                                                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                    lineNumber: 601,
                                                                                    columnNumber: 27
                                                                                }, this),
                                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                                    className: "text-xs text-gray-500",
                                                                                    children: "Загрузить изображение"
                                                                                }, void 0, false, {
                                                                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                    lineNumber: 602,
                                                                                    columnNumber: 27
                                                                                }, this)
                                                                            ]
                                                                        }, void 0, true, {
                                                                            fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                            lineNumber: 600,
                                                                            columnNumber: 25
                                                                        }, this)
                                                                    ]
                                                                }, void 0, true, {
                                                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                    lineNumber: 589,
                                                                    columnNumber: 23
                                                                }, this),
                                                                elements.filter((el)=>el.type === "media").length === 0 ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                    className: "py-8 text-center text-sm text-gray-500",
                                                                    children: "Нет добавленных медиа"
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                    lineNumber: 606,
                                                                    columnNumber: 25
                                                                }, this) : elements.filter((el)=>el.type === "media").map((element)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                        className: "flex items-center gap-3 rounded-xl border-2 border-gray-200 p-3 transition hover:border-gray-300",
                                                                        children: [
                                                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                                className: "flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-gray-100 text-xs font-semibold text-gray-600",
                                                                                children: elements.filter((el)=>el.type === "media").indexOf(element) + 1
                                                                            }, void 0, false, {
                                                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                lineNumber: 617,
                                                                                columnNumber: 31
                                                                            }, this),
                                                                            element.imageUrl ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                                className: "relative h-10 w-10 flex-shrink-0 overflow-hidden rounded-lg",
                                                                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("img", {
                                                                                    src: element.imageUrl,
                                                                                    alt: element.label,
                                                                                    className: "h-full w-full object-cover"
                                                                                }, void 0, false, {
                                                                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                    lineNumber: 622,
                                                                                    columnNumber: 35
                                                                                }, this)
                                                                            }, void 0, false, {
                                                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                lineNumber: 621,
                                                                                columnNumber: 33
                                                                            }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                                className: "flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-gray-200",
                                                                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                                    className: "text-xs text-gray-500",
                                                                                    children: "📄"
                                                                                }, void 0, false, {
                                                                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                    lineNumber: 630,
                                                                                    columnNumber: 35
                                                                                }, this)
                                                                            }, void 0, false, {
                                                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                lineNumber: 629,
                                                                                columnNumber: 33
                                                                            }, this),
                                                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                                className: "flex-1 min-w-0",
                                                                                children: [
                                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                                        className: "text-sm font-medium text-gray-900 truncate",
                                                                                        children: element.label
                                                                                    }, void 0, false, {
                                                                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                        lineNumber: 634,
                                                                                        columnNumber: 33
                                                                                    }, this),
                                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                                        className: "text-xs text-gray-500 truncate",
                                                                                        children: "Медиа"
                                                                                    }, void 0, false, {
                                                                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                        lineNumber: 635,
                                                                                        columnNumber: 33
                                                                                    }, this)
                                                                                ]
                                                                            }, void 0, true, {
                                                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                lineNumber: 633,
                                                                                columnNumber: 31
                                                                            }, this),
                                                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                                                type: "button",
                                                                                onClick: ()=>{
                                                                                    onRemoveElement(element.id);
                                                                                },
                                                                                className: "flex-shrink-0 rounded-lg px-3 py-1.5 text-xs font-medium text-red-600 transition hover:bg-red-50",
                                                                                "aria-label": "Удалить медиа",
                                                                                children: "Удалить"
                                                                            }, void 0, false, {
                                                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                                lineNumber: 637,
                                                                                columnNumber: 31
                                                                            }, this)
                                                                        ]
                                                                    }, element.id, true, {
                                                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                                        lineNumber: 613,
                                                                        columnNumber: 29
                                                                    }, this))
                                                            ]
                                                        }, void 0, true, {
                                                            fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                            lineNumber: 588,
                                                            columnNumber: 21
                                                        }, this)
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                    lineNumber: 584,
                                                    columnNumber: 19
                                                }, this)
                                            }, void 0, false, {
                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                lineNumber: 578,
                                                columnNumber: 17
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 560,
                                        columnNumber: 13
                                    }, this)
                                ]
                            }, void 0, true),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "relative",
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                        ref: layersButtonRef,
                                        type: "button",
                                        onClick: ()=>{
                                            if (layersCloseTimeoutRef.current) {
                                                clearTimeout(layersCloseTimeoutRef.current);
                                                layersCloseTimeoutRef.current = null;
                                            }
                                            setIsLayersPanelOpen(!isLayersPanelOpen);
                                        },
                                        onMouseEnter: handleLayersMouseEnter,
                                        onMouseLeave: handleLayersMouseLeave,
                                        className: "flex h-9 min-w-[100px] items-center justify-center gap-2 rounded-2xl border border-gray-200 px-4 text-xs font-semibold text-gray-900 transition hover:bg-gray-50",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                                xmlns: "http://www.w3.org/2000/svg",
                                                viewBox: "0 0 24 24",
                                                fill: "none",
                                                stroke: "currentColor",
                                                strokeWidth: 2,
                                                className: "h-4 w-4 flex-shrink-0",
                                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                                    d: "M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                    lineNumber: 679,
                                                    columnNumber: 15
                                                }, this)
                                            }, void 0, false, {
                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                lineNumber: 671,
                                                columnNumber: 13
                                            }, this),
                                            "Слои"
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 657,
                                        columnNumber: 13
                                    }, this),
                                    isLayersPanelOpen && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        onMouseEnter: handleLayersMouseEnter,
                                        onMouseLeave: handleLayersMouseLeave,
                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$LayersPanel$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LayersPanel"], {
                                            isOpen: isLayersPanelOpen,
                                            onClose: ()=>setIsLayersPanelOpen(false),
                                            elements: elements,
                                            avatar: avatar,
                                            avatarZIndex: avatarZIndex,
                                            avatarLocked: avatarLocked,
                                            onReorderLayers: onReorderLayers,
                                            onToggleAvatarLock: onToggleAvatarLock,
                                            panelRef: layersPanelRef
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                            lineNumber: 688,
                                            columnNumber: 15
                                        }, this)
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 684,
                                        columnNumber: 13
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                lineNumber: 656,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                        lineNumber: 537,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                lineNumber: 530,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "relative flex-1 min-h-0 overflow-hidden",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "flex h-full w-full items-center justify-center p-2",
                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        ref: canvasRef,
                        className: "relative overflow-visible rounded-2xl bg-gray-50 border-2 border-dashed border-gray-300",
                        style: {
                            aspectRatio: aspectRatio === "16:9" ? "16 / 9" : "9 / 16",
                            width: aspectRatio === "16:9" ? "100%" : "auto",
                            height: aspectRatio === "9:16" ? "100%" : "auto",
                            maxWidth: "100%",
                            maxHeight: "100%"
                        },
                        children: [
                            snapPoint && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                                children: [
                                    snapPoint.x !== null && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "absolute z-40 pointer-events-none",
                                        style: {
                                            left: `${snapPoint.x / canvasSize.width * 100}%`,
                                            top: 0,
                                            width: '1px',
                                            height: '100%',
                                            backgroundColor: '#3b82f6',
                                            opacity: 0.5
                                        }
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 723,
                                        columnNumber: 19
                                    }, this),
                                    snapPoint.y !== null && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "absolute z-40 pointer-events-none",
                                        style: {
                                            left: 0,
                                            top: `${snapPoint.y / canvasSize.height * 100}%`,
                                            width: '100%',
                                            height: '1px',
                                            backgroundColor: '#3b82f6',
                                            opacity: 0.5
                                        }
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 737,
                                        columnNumber: 19
                                    }, this)
                                ]
                            }, void 0, true),
                            draggingElementId && dragCoords && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "absolute z-50 rounded-lg bg-black/80 px-3 py-1.5 text-xs font-mono text-white pointer-events-none whitespace-nowrap",
                                style: {
                                    left: `${dragCoords.x / canvasSize.width * 100}%`,
                                    top: `${dragCoords.y / canvasSize.height * 100}%`,
                                    transform: "translate(-50%, calc(50% + 30px))"
                                },
                                children: [
                                    "X: ",
                                    dragCoords.x,
                                    " Y: ",
                                    dragCoords.y
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                lineNumber: 754,
                                columnNumber: 15
                            }, this),
                            draggingAvatar && avatarDragCoords && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "absolute z-50 rounded-lg bg-black/80 px-3 py-1.5 text-xs font-mono text-white pointer-events-none whitespace-nowrap",
                                style: {
                                    left: `${avatarDragCoords.x / canvasSize.width * 100}%`,
                                    top: `${avatarDragCoords.y / canvasSize.height * 100}%`,
                                    transform: "translate(-50%, calc(50% + 30px))"
                                },
                                children: [
                                    "X: ",
                                    avatarDragCoords.x,
                                    " Y: ",
                                    avatarDragCoords.y
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                lineNumber: 768,
                                columnNumber: 15
                            }, this),
                            [
                                ...elements.map((el)=>({
                                        type: "element",
                                        data: el,
                                        zIndex: el.zIndex ?? 0
                                    })),
                                ...avatar ? [
                                    {
                                        type: "avatar",
                                        data: avatar,
                                        zIndex: avatarZIndex ?? 9999
                                    }
                                ] : []
                            ].sort((a, b)=>a.zIndex - b.zIndex).map((item)=>{
                                if (item.type === "avatar") {
                                    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$AvatarCanvas$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["AvatarCanvas"], {
                                        avatar: item.data,
                                        position: avatarPosition,
                                        size: avatarSize,
                                        canvasSize: canvasSize,
                                        onRemove: onRemoveAvatar,
                                        onPointerDown: handleAvatarPointerDown,
                                        onResizeStart: handleAvatarResizeStart
                                    }, "avatar", false, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 788,
                                        columnNumber: 21
                                    }, this);
                                }
                                const element = item.data;
                                if (element.imageUrl) {
                                    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$MediaCanvasWrapper$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MediaCanvasWrapper"], {
                                        element: element,
                                        canvasSize: canvasSize,
                                        onRemove: ()=>onRemoveElement(element.id),
                                        onPointerDown: (event)=>handlePointerDown(event, element),
                                        onResizeStart: ()=>{},
                                        screenToCanvas: screenToCanvas,
                                        onElementSizeChange: onElementSizeChange
                                    }, element.id, false, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 804,
                                        columnNumber: 21
                                    }, this);
                                }
                                // Плейсхолдер для элементов без изображения
                                const leftPercent = element.x / canvasSize.width * 100;
                                const topPercent = element.y / canvasSize.height * 100;
                                const widthPercent = element.width / canvasSize.width * 100;
                                const heightPercent = element.height / canvasSize.height * 100;
                                return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    role: "button",
                                    tabIndex: 0,
                                    onPointerDown: (event)=>handlePointerDown(event, element),
                                    className: "absolute cursor-grab rounded-2xl border-2 border-gray-300 bg-white text-center text-xs font-semibold text-gray-900 shadow-md transition hover:border-gray-900 active:cursor-grabbing overflow-hidden",
                                    style: {
                                        left: `${leftPercent}%`,
                                        top: `${topPercent}%`,
                                        width: `${widthPercent}%`,
                                        height: `${heightPercent}%`,
                                        transform: "translate(-50%, -50%)",
                                        background: "#f3f4f6"
                                    },
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                        className: "flex h-full w-full flex-col items-center justify-center px-2",
                                        children: [
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                className: "text-sm text-gray-900",
                                                children: element.label
                                            }, void 0, false, {
                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                lineNumber: 840,
                                                columnNumber: 23
                                            }, this),
                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                className: "text-[10px] text-gray-500",
                                                children: "Медиа"
                                            }, void 0, false, {
                                                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                                lineNumber: 841,
                                                columnNumber: 23
                                            }, this)
                                        ]
                                    }, void 0, true, {
                                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                        lineNumber: 839,
                                        columnNumber: 21
                                    }, this)
                                }, element.id, false, {
                                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                                    lineNumber: 824,
                                    columnNumber: 19
                                }, this);
                            })
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                        lineNumber: 707,
                        columnNumber: 11
                    }, this)
                }, void 0, false, {
                    fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                    lineNumber: 706,
                    columnNumber: 9
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
                lineNumber: 705,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/material/editor/components/CanvasArea.tsx",
        lineNumber: 529,
        columnNumber: 5
    }, this);
}
_s(CanvasArea, "1e7ExC1a44XuDQCdTAzC8TAx1nE=", false, function() {
    return [
        __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$useImageAspectRatio$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useImageAspectRatio"]
    ];
});
_c = CanvasArea;
var _c;
__turbopack_context__.k.register(_c, "CanvasArea");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/components/MaterialEditor.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "MaterialEditor",
    ()=>MaterialEditor
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/navigation.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/supabaseClient.ts [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$EditorSidebar$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/EditorSidebar.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$Timeline$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/Timeline.tsx [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$CanvasArea$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/CanvasArea.tsx [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
;
;
;
;
;
const createScene = (index)=>({
        id: crypto.randomUUID(),
        title: `Слайд ${index}`,
        script: "",
        avatarId: null,
        voiceId: null,
        elements: []
    });
function MaterialEditor() {
    _s();
    const router = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRouter"])();
    const initialScenes = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useMemo"])({
        "MaterialEditor.useMemo[initialScenes]": ()=>[
                createScene(1)
            ]
    }["MaterialEditor.useMemo[initialScenes]"], []);
    const [aspectRatio, setAspectRatio] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])("16:9");
    const [videoTitle, setVideoTitle] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])("Новое видео");
    const [scenes, setScenes] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(initialScenes);
    const [activeSceneId, setActiveSceneId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(initialScenes[0].id);
    const [avatars, setAvatars] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])([]);
    const [voices, setVoices] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])([]);
    const [isLoadingAvatars, setIsLoadingAvatars] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(true);
    const [isLoadingVoices, setIsLoadingVoices] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(true);
    const [isGenerating, setIsGenerating] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])(false);
    const activeScene = scenes.find((scene)=>scene.id === activeSceneId);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "MaterialEditor.useEffect": ()=>{
            const fetchAvatars = {
                "MaterialEditor.useEffect.fetchAvatars": async ()=>{
                    const { data: { user } } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.getUser();
                    if (!user) return;
                    const { data, error } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from("photo_avatars").select("*").eq("uid", user.id).eq("status", "done").order("created_at", {
                        ascending: false
                    });
                    if (error) {
                        console.error("[MaterialEditor] Ошибка загрузки аватаров:", error);
                    } else {
                        setAvatars((data ?? []).map({
                            "MaterialEditor.useEffect.fetchAvatars": (avatar)=>({
                                    id: avatar.id ?? "",
                                    name: avatar.name,
                                    photo: avatar.photo,
                                    image_key: avatar.image_key,
                                    hey_gen_id: avatar.hey_gen_id,
                                    group_id: avatar.group_id
                                })
                        }["MaterialEditor.useEffect.fetchAvatars"]));
                    }
                    setIsLoadingAvatars(false);
                }
            }["MaterialEditor.useEffect.fetchAvatars"];
            fetchAvatars();
        }
    }["MaterialEditor.useEffect"], []);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "MaterialEditor.useEffect": ()=>{
            const fetchVoices = {
                "MaterialEditor.useEffect.fetchVoices": async ()=>{
                    const { data: { user } } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.getUser();
                    if (!user) return;
                    const { data, error } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].from("voices").select("*").eq("uid", user.id).order("created_at", {
                        ascending: false
                    });
                    if (error) {
                        console.error("[MaterialEditor] Ошибка загрузки голосов:", error);
                    } else {
                        setVoices((data ?? []).filter({
                            "MaterialEditor.useEffect.fetchVoices": (voice)=>voice.url && voice.name
                        }["MaterialEditor.useEffect.fetchVoices"]).map({
                            "MaterialEditor.useEffect.fetchVoices": (voice)=>({
                                    id: voice.id ?? "",
                                    name: voice.name,
                                    url: voice.url,
                                    description: voice.description,
                                    voice_id: voice.voice_id ?? null
                                })
                        }["MaterialEditor.useEffect.fetchVoices"]));
                    }
                    setIsLoadingVoices(false);
                }
            }["MaterialEditor.useEffect.fetchVoices"];
            fetchVoices();
        }
    }["MaterialEditor.useEffect"], []);
    const handleSceneUpdate = (sceneId, updater)=>setScenes((prev)=>prev.map((scene)=>scene.id === sceneId ? updater(scene) : scene));
    // Константы размеров канвы в пикселях
    const CANVAS_SIZES = {
        "16:9": {
            width: 1920,
            height: 1080
        },
        "9:16": {
            width: 1080,
            height: 1920
        }
    };
    // Рассчитывает начальный размер аватара в пикселях (35% от высоты канвы)
    const getInitialAvatarSize = (ratio)=>{
        const canvasSize = CANVAS_SIZES[ratio];
        // Высота аватара = 35% от высоты канвы в пикселях
        const avatarHeightPercent = 0.35;
        const height = canvasSize.height * avatarHeightPercent;
        // Типичное соотношение сторон аватара (ширина к высоте)
        const avatarAspectRatio = 3 / 4;
        // Ширина рассчитывается на основе соотношения сторон аватара
        const width = height * avatarAspectRatio;
        return {
            width,
            height
        };
    };
    // Конвертирует координаты из одного соотношения сторон в другое
    const convertCoordinates = (coords, fromRatio, toRatio)=>{
        if (fromRatio === toRatio) return coords;
        const fromSize = CANVAS_SIZES[fromRatio];
        const toSize = CANVAS_SIZES[toRatio];
        // Конвертируем в проценты относительно исходной канвы
        const xPercent = coords.x / fromSize.width;
        const yPercent = coords.y / fromSize.height;
        // Применяем проценты к новой канве
        return {
            x: xPercent * toSize.width,
            y: yPercent * toSize.height
        };
    };
    // Конвертирует размеры из одного соотношения сторон в другое
    const convertSize = (size, fromRatio, toRatio)=>{
        if (fromRatio === toRatio) return size;
        const fromSize = CANVAS_SIZES[fromRatio];
        const toSize = CANVAS_SIZES[toRatio];
        // Конвертируем в проценты относительно исходной канвы
        const widthPercent = size.width / fromSize.width;
        const heightPercent = size.height / fromSize.height;
        // Применяем проценты к новой канве
        return {
            width: widthPercent * toSize.width,
            height: heightPercent * toSize.height
        };
    };
    const handleAddScene = (afterSceneId)=>{
        setScenes((prev)=>{
            const newIndex = afterSceneId ? prev.findIndex((s)=>s.id === afterSceneId) + 1 : prev.length;
            // Берем данные из активного слайда для копирования настроек (кроме текста)
            const activeScene = prev.find((s)=>s.id === activeSceneId);
            const previousScene = afterSceneId ? prev.find((s)=>s.id === afterSceneId) : prev[prev.length - 1];
            const newScene = {
                id: crypto.randomUUID(),
                title: `Слайд ${newIndex + 1}`,
                script: "",
                avatarId: activeScene?.avatarId ?? previousScene?.avatarId ?? null,
                voiceId: activeScene?.voiceId ?? previousScene?.voiceId ?? null,
                elements: activeScene?.elements ? [
                    ...activeScene.elements
                ] : previousScene?.elements ? [
                    ...previousScene.elements
                ] : [],
                avatarPosition: activeScene?.avatarPosition ?? previousScene?.avatarPosition,
                avatarSize: activeScene?.avatarSize ?? previousScene?.avatarSize,
                avatarZIndex: activeScene?.avatarZIndex ?? previousScene?.avatarZIndex
            };
            setActiveSceneId(newScene.id);
            if (afterSceneId) {
                const index = prev.findIndex((s)=>s.id === afterSceneId);
                const updated = [
                    ...prev
                ];
                updated.splice(index + 1, 0, newScene);
                return updated.map((scene, idx)=>({
                        ...scene,
                        title: `Слайд ${idx + 1}`
                    }));
            }
            return [
                ...prev,
                newScene
            ].map((scene, idx)=>({
                    ...scene,
                    title: `Слайд ${idx + 1}`
                }));
        });
    };
    const handleDeleteScene = (sceneId)=>{
        setScenes((prev)=>{
            const filtered = prev.filter((scene)=>scene.id !== sceneId);
            if (filtered.length === 0) {
                const newScene = createScene(1);
                setActiveSceneId(newScene.id);
                return [
                    newScene
                ];
            }
            if (activeSceneId === sceneId) {
                const currentIndex = prev.findIndex((scene)=>scene.id === sceneId);
                const newActiveIndex = Math.max(0, currentIndex - 1);
                setActiveSceneId(filtered[newActiveIndex]?.id ?? filtered[0].id);
            }
            return filtered.map((scene, index)=>({
                    ...scene,
                    title: `Слайд ${index + 1}`
                }));
        });
    };
    const handleScriptChange = (value)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                script: value
            }));
    };
    const handleVoiceChange = (voiceId)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                voiceId
            }));
    };
    const handleAvatarChange = (avatarId)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>{
            if (avatarId && !scene.avatarPosition) {
                // При первом добавлении аватара устанавливаем начальную позицию и размер
                const initialSize = getInitialAvatarSize(aspectRatio);
                const canvasSize = CANVAS_SIZES[aspectRatio];
                // Аватар по умолчанию имеет большой zIndex (выше всех элементов)
                const maxZIndex = Math.max(...scene.elements.map((el)=>el.zIndex ?? 0), 0);
                return {
                    ...scene,
                    avatarId,
                    avatarPosition: {
                        x: canvasSize.width / 2,
                        y: canvasSize.height / 2
                    },
                    avatarSize: initialSize,
                    avatarZIndex: maxZIndex + 1
                };
            }
            return {
                ...scene,
                avatarId
            };
        });
    };
    const handleRemoveAvatar = ()=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                avatarId: null,
                avatarPosition: undefined,
                avatarSize: undefined
            }));
    };
    const handleAvatarPositionChange = (coords)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                avatarPosition: coords
            }));
    };
    const handleAvatarSizeChange = (size)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                avatarSize: size
            }));
    };
    const handleAddMediaAsset = (imageUrl, fileName)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>{
            const mediaIndex = scene.elements.filter((element)=>element.type === "media").length + 1;
            const canvasSize = CANVAS_SIZES[aspectRatio];
            // Начальные размеры элемента в пикселях (примерно 28% ширины канвы)
            const elementWidth = canvasSize.width * 0.28;
            // Высота будет установлена автоматически на основе соотношения сторон изображения
            // Пока используем примерную высоту, она будет скорректирована компонентом MediaCanvas
            const elementHeight = canvasSize.height * 0.34;
            // Определяем zIndex для нового элемента (добавляем в конец, самый верхний)
            const maxElementZIndex = scene.elements.reduce((max, el)=>Math.max(max, el.zIndex ?? 0), 0);
            const maxZIndex = Math.max(maxElementZIndex, scene.avatarZIndex ?? 0);
            // Используем имя файла, если оно есть, иначе используем "Медиа X"
            const label = fileName || `Медиа ${mediaIndex}`;
            const newElement = {
                id: `media-${scene.id}-${mediaIndex}-${Date.now()}`,
                type: "media",
                label: label,
                color: "#1fb6ff",
                width: elementWidth,
                height: elementHeight,
                x: canvasSize.width / 2,
                y: canvasSize.height / 2,
                imageUrl: imageUrl,
                zIndex: maxZIndex + 1
            };
            return {
                ...scene,
                elements: [
                    ...scene.elements,
                    newElement
                ]
            };
        });
    };
    const handleElementPositionChange = (elementId, coords)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                elements: scene.elements.map((element)=>element.id === elementId ? {
                        ...element,
                        ...coords
                    } : element)
            }));
    };
    const handleElementSizeChange = (elementId, size)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                elements: scene.elements.map((element)=>element.id === elementId ? {
                        ...element,
                        ...size
                    } : element)
            }));
    };
    const handleRemoveElement = (elementId)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                elements: scene.elements.filter((element)=>element.id !== elementId)
            }));
    };
    const handleReorderLayers = (newOrder)=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>{
            // Первый в списке (index 0) = больший zIndex = выше на канве
            // Обновляем zIndex для всех элементов и аватара
            const updatedElements = scene.elements.map((element)=>{
                const index = newOrder.indexOf(element.id);
                // Первый элемент (index 0) получает zIndex = newOrder.length, последний получает 1
                const zIndex = index !== -1 ? newOrder.length - index : element.zIndex ?? 0;
                return {
                    ...element,
                    zIndex
                };
            });
            // Обновляем zIndex для аватара
            const avatarIndex = newOrder.indexOf("avatar");
            const avatarZIndex = avatarIndex !== -1 ? newOrder.length - avatarIndex : scene.avatarZIndex ?? 9999;
            return {
                ...scene,
                elements: updatedElements,
                avatarZIndex
            };
        });
    };
    const handleToggleAvatarLock = ()=>{
        if (!activeScene) return;
        handleSceneUpdate(activeScene.id, (scene)=>({
                ...scene,
                avatarLocked: !scene.avatarLocked
            }));
    };
    // Функция для получения оригинальных размеров изображения
    const getImageDimensions = (imageUrl)=>{
        return new Promise((resolve, reject)=>{
            // Используем window.Image чтобы избежать конфликта с импортом Image из Next.js
            const img = document.createElement("img");
            // Устанавливаем таймаут для загрузки
            const timeout = setTimeout(()=>{
                img.onload = null;
                img.onerror = null;
                reject(new Error(`Таймаут загрузки изображения: ${imageUrl}`));
            }, 15000); // 15 секунд таймаут
            img.onload = ()=>{
                clearTimeout(timeout);
                const width = img.naturalWidth || img.width;
                const height = img.naturalHeight || img.height;
                if (width > 0 && height > 0) {
                    console.log(`Размеры изображения получены: ${imageUrl} - ${width}x${height}`);
                    resolve({
                        width,
                        height
                    });
                } else {
                    reject(new Error(`Неверные размеры изображения: ${imageUrl}`));
                }
            };
            img.onerror = (error)=>{
                clearTimeout(timeout);
                console.error(`Ошибка загрузки изображения: ${imageUrl}`, error);
                reject(new Error(`Не удалось загрузить изображение: ${imageUrl}`));
            };
            // Устанавливаем src после настройки обработчиков
            img.src = imageUrl;
        });
    };
    // Функция для подготовки данных слайда для вебхука
    const prepareSlideData = async (scene, slideNumber)=>{
        const canvasSize = CANVAS_SIZES[aspectRatio];
        const slideData = {
            slide_number: slideNumber,
            canvas_size: {
                width: canvasSize.width,
                height: canvasSize.height
            },
            aspect_ratio: aspectRatio,
            script: scene.script,
            voice_id: scene.voiceId ? voices.find((v)=>v.id === scene.voiceId)?.voice_id ?? null : null,
            elements: []
        };
        // Обрабатываем аватар
        if (scene.avatarId && scene.avatarPosition && scene.avatarSize) {
            const avatar = avatars.find((a)=>a.id === scene.avatarId);
            if (avatar && avatar.photo) {
                console.log(`Загрузка размеров аватара для слайда ${slideNumber}: ${avatar.photo}`);
                try {
                    const originalDimensions = await getImageDimensions(avatar.photo);
                    console.log(`Размеры аватара получены для слайда ${slideNumber}:`, originalDimensions);
                    slideData.elements.push({
                        type: "avatar",
                        id: scene.avatarId,
                        position: {
                            x: scene.avatarPosition.x,
                            y: scene.avatarPosition.y
                        },
                        original_resolution: {
                            width: originalDimensions.width,
                            height: originalDimensions.height
                        },
                        canvas_resolution: {
                            width: scene.avatarSize.width,
                            height: scene.avatarSize.height
                        },
                        z_index: scene.avatarZIndex ?? 0,
                        image_url: avatar.photo
                    });
                } catch (error) {
                    console.error(`Ошибка при получении размеров аватара для слайда ${slideNumber}:`, error);
                    console.error(`URL аватара: ${avatar.photo}`);
                    // Добавляем аватар без оригинальных размеров
                    slideData.elements.push({
                        type: "avatar",
                        id: scene.avatarId,
                        position: {
                            x: scene.avatarPosition.x,
                            y: scene.avatarPosition.y
                        },
                        original_resolution: null,
                        canvas_resolution: {
                            width: scene.avatarSize.width,
                            height: scene.avatarSize.height
                        },
                        z_index: scene.avatarZIndex ?? 0,
                        image_url: avatar.photo
                    });
                }
            }
        }
        // Обрабатываем медиа элементы
        for (const element of scene.elements){
            if (element.type === "media" && element.imageUrl) {
                console.log(`Загрузка размеров медиа для слайда ${slideNumber}: ${element.imageUrl}`);
                try {
                    const originalDimensions = await getImageDimensions(element.imageUrl);
                    console.log(`Размеры медиа получены для слайда ${slideNumber}:`, originalDimensions);
                    slideData.elements.push({
                        type: "media",
                        id: element.id,
                        label: element.label,
                        position: {
                            x: element.x,
                            y: element.y
                        },
                        original_resolution: {
                            width: originalDimensions.width,
                            height: originalDimensions.height
                        },
                        canvas_resolution: {
                            width: element.width,
                            height: element.height
                        },
                        z_index: element.zIndex ?? 0,
                        image_url: element.imageUrl,
                        crop: element.crop || null
                    });
                } catch (error) {
                    console.error(`Ошибка при получении размеров медиа для слайда ${slideNumber}:`, error);
                    console.error(`URL медиа: ${element.imageUrl}`);
                    // Добавляем медиа без оригинальных размеров
                    slideData.elements.push({
                        type: "media",
                        id: element.id,
                        label: element.label,
                        position: {
                            x: element.x,
                            y: element.y
                        },
                        original_resolution: null,
                        canvas_resolution: {
                            width: element.width,
                            height: element.height
                        },
                        z_index: element.zIndex ?? 0,
                        image_url: element.imageUrl,
                        crop: element.crop || null
                    });
                }
            }
        }
        // Сортируем элементы по z_index (от меньшего к большему для правильного порядка слоев)
        slideData.elements.sort((a, b)=>a.z_index - b.z_index);
        return slideData;
    };
    // Функция для отправки вебхука с данными всех слайдов
    const handleGenerate = async ()=>{
        if (isGenerating) return;
        setIsGenerating(true);
        try {
            const slidesData = [];
            // Подготавливаем данные для каждого слайда
            for(let i = 0; i < scenes.length; i++){
                const scene = scenes[i];
                const slideNumberMatch = scene.title.match(/\d+/);
                const slideNumber = slideNumberMatch ? parseInt(slideNumberMatch[0], 10) : i + 1;
                const slideData = await prepareSlideData(scene, slideNumber);
                slidesData.push(slideData);
            }
            // Отправляем вебхук
            const response = await fetch("https://rueleven.ru/webhook-test/2c6c697f-78cd-4eb2-bf01-2f00827b965d", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    video_title: videoTitle,
                    aspect_ratio: aspectRatio,
                    slides: slidesData
                })
            });
            if (!response.ok) {
                throw new Error(`Ошибка HTTP: ${response.status}`);
            }
            console.log("Вебхук успешно отправлен:", slidesData);
            alert("Генерация начата! Данные отправлены на сервер.");
        } catch (error) {
            console.error("Ошибка при отправке вебхука:", error);
            alert("Произошла ошибка при отправке данных. Проверьте консоль для подробностей.");
        } finally{
            setIsGenerating(false);
        }
    };
    // Проверяем, можно ли сгенерировать (для активного слайда)
    const canGenerate = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useMemo"])({
        "MaterialEditor.useMemo[canGenerate]": ()=>{
            if (!activeScene) return false;
            return !!(activeScene.avatarId && activeScene.voiceId && activeScene.script.trim());
        }
    }["MaterialEditor.useMemo[canGenerate]"], [
        activeScene
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("section", {
        className: "flex h-screen w-full flex-col gap-4 px-4 pb-6 pt-4 sm:px-6 lg:gap-6 lg:pb-8",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "flex items-center justify-between gap-4 pb-2",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                        type: "button",
                        onClick: async ()=>{
                            // Получаем UUID залогиненного пользователя
                            const { data: { user } } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.getUser();
                            const userUuid = user?.id || null;
                            // Отправляем вебхук для каждого слайда перед переходом назад
                            for(let i = 0; i < scenes.length; i++){
                                const scene = scenes[i];
                                if (!scene.voiceId) continue;
                                // Находим выбранный голос и получаем его voice_id из таблицы
                                const selectedVoice = voices.find((voice)=>voice.id === scene.voiceId);
                                if (!selectedVoice || !selectedVoice.voice_id) continue;
                                // Извлекаем номер слайда из title (например, "Слайд 1" -> 1)
                                const slideNumberMatch = scene.title.match(/\d+/);
                                const slideNumber = slideNumberMatch ? parseInt(slideNumberMatch[0], 10) : i + 1;
                                try {
                                    await fetch("https://rueleven.ru/webhook/8c42bae1-807d-40fa-b795-42897b4ec5b2", {
                                        method: "POST",
                                        headers: {
                                            "Content-Type": "application/json"
                                        },
                                        body: JSON.stringify({
                                            slide_number: slideNumber,
                                            voice_id: selectedVoice.voice_id,
                                            uuid: userUuid
                                        })
                                    });
                                    console.log(`Вебхук отправлен для слайда ${slideNumber}`);
                                } catch (error) {
                                    console.error(`Ошибка при отправке вебхука для слайда ${slideNumber}:`, error);
                                }
                            }
                            router.push("/material");
                        },
                        className: "flex items-center gap-2 rounded-xl border border-gray-200 bg-white px-4 py-2 text-sm font-semibold text-gray-900 transition hover:bg-gray-50",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                xmlns: "http://www.w3.org/2000/svg",
                                viewBox: "0 0 24 24",
                                fill: "none",
                                stroke: "currentColor",
                                strokeWidth: 2,
                                className: "h-5 w-5",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                    d: "M19 12H5M12 19l-7-7 7-7"
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                    lineNumber: 680,
                                    columnNumber: 13
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                lineNumber: 672,
                                columnNumber: 11
                            }, this),
                            "Назад"
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                        lineNumber: 628,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                        type: "button",
                        onClick: handleGenerate,
                        disabled: !canGenerate || isGenerating,
                        className: `flex items-center gap-2 rounded-xl px-4 py-2 text-sm font-semibold text-white transition ${canGenerate && !isGenerating ? "bg-green-600 hover:bg-green-500" : "bg-gray-300 cursor-not-allowed"}`,
                        children: isGenerating ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                    className: "animate-spin h-5 w-5",
                                    xmlns: "http://www.w3.org/2000/svg",
                                    fill: "none",
                                    viewBox: "0 0 24 24",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("circle", {
                                            className: "opacity-25",
                                            cx: "12",
                                            cy: "12",
                                            r: "10",
                                            stroke: "currentColor",
                                            strokeWidth: "4"
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                            lineNumber: 702,
                                            columnNumber: 17
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                            className: "opacity-75",
                                            fill: "currentColor",
                                            d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                                        }, void 0, false, {
                                            fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                            lineNumber: 710,
                                            columnNumber: 17
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                    lineNumber: 696,
                                    columnNumber: 15
                                }, this),
                                "Генерация..."
                            ]
                        }, void 0, true) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Fragment"], {
                            children: [
                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("svg", {
                                    xmlns: "http://www.w3.org/2000/svg",
                                    viewBox: "0 0 24 24",
                                    fill: "none",
                                    stroke: "currentColor",
                                    strokeWidth: 2,
                                    className: "h-5 w-5",
                                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("path", {
                                        d: "M5 12h14M12 5l7 7-7 7"
                                    }, void 0, false, {
                                        fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                        lineNumber: 728,
                                        columnNumber: 17
                                    }, this)
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                    lineNumber: 720,
                                    columnNumber: 15
                                }, this),
                                "Сгенерировать"
                            ]
                        }, void 0, true)
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                        lineNumber: 684,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                lineNumber: 627,
                columnNumber: 7
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "flex h-full min-h-0 flex-1 flex-col gap-4 lg:grid lg:grid-cols-[629px_minmax(0,1fr)] lg:items-stretch lg:gap-6",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex min-h-0 flex-1 flex-col lg:min-h-0 lg:h-full",
                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$EditorSidebar$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["EditorSidebar"], {
                            aspectRatio: aspectRatio,
                            onAspectRatioChange: (newRatio)=>{
                                // Конвертируем координаты всех элементов и аватара при изменении соотношения сторон
                                const oldRatio = aspectRatio;
                                setScenes((prevScenes)=>prevScenes.map((scene)=>{
                                        const updatedScene = {
                                            ...scene
                                        };
                                        // Конвертируем позицию и размер аватара
                                        if (updatedScene.avatarPosition && updatedScene.avatarSize) {
                                            updatedScene.avatarPosition = convertCoordinates(updatedScene.avatarPosition, oldRatio, newRatio);
                                            updatedScene.avatarSize = convertSize(updatedScene.avatarSize, oldRatio, newRatio);
                                        }
                                        // Конвертируем координаты всех элементов
                                        updatedScene.elements = updatedScene.elements.map((element)=>{
                                            const newPosition = convertCoordinates({
                                                x: element.x,
                                                y: element.y
                                            }, oldRatio, newRatio);
                                            const newSize = convertSize({
                                                width: element.width,
                                                height: element.height
                                            }, oldRatio, newRatio);
                                            return {
                                                ...element,
                                                x: newPosition.x,
                                                y: newPosition.y,
                                                width: newSize.width,
                                                height: newSize.height
                                            };
                                        });
                                        return updatedScene;
                                    }));
                                setAspectRatio(newRatio);
                            },
                            videoTitle: videoTitle,
                            onVideoTitleChange: setVideoTitle,
                            avatars: avatars,
                            isLoadingAvatars: isLoadingAvatars,
                            voices: voices,
                            isLoadingVoices: isLoadingVoices,
                            scenes: scenes,
                            activeSceneId: activeSceneId,
                            onSelectScene: setActiveSceneId,
                            onAddScene: handleAddScene,
                            onDeleteScene: handleDeleteScene,
                            onSceneVoiceChange: (sceneId, voiceId)=>{
                                handleSceneUpdate(sceneId, (scene)=>({
                                        ...scene,
                                        voiceId
                                    }));
                            },
                            onSceneScriptChange: (sceneId, script)=>{
                                handleSceneUpdate(sceneId, (scene)=>({
                                        ...scene,
                                        script
                                    }));
                            },
                            onSceneAvatarChange: (sceneId, avatarId)=>{
                                const scene = scenes.find((s)=>s.id === sceneId);
                                if (!scene) return;
                                if (avatarId && !scene.avatarPosition) {
                                    // При первом добавлении аватара устанавливаем начальную позицию и размер
                                    const initialSize = getInitialAvatarSize(aspectRatio);
                                    const canvasSize = CANVAS_SIZES[aspectRatio];
                                    const maxZIndex = Math.max(...scene.elements.map((el)=>el.zIndex ?? 0), 0);
                                    handleSceneUpdate(sceneId, (s)=>({
                                            ...s,
                                            avatarId,
                                            avatarPosition: {
                                                x: canvasSize.width / 2,
                                                y: canvasSize.height / 2
                                            },
                                            avatarSize: initialSize,
                                            avatarZIndex: maxZIndex + 1
                                        }));
                                } else {
                                    handleSceneUpdate(sceneId, (s)=>({
                                            ...s,
                                            avatarId
                                        }));
                                }
                            }
                        }, void 0, false, {
                            fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                            lineNumber: 737,
                            columnNumber: 11
                        }, this)
                    }, void 0, false, {
                        fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                        lineNumber: 736,
                        columnNumber: 9
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex min-h-0 flex-1 flex-col gap-4",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "flex-1 min-h-0",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$CanvasArea$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CanvasArea"], {
                                    aspectRatio: aspectRatio,
                                    elements: activeScene?.elements ?? [],
                                    avatar: activeScene?.avatarId ? avatars.find((a)=>a.id === activeScene.avatarId) ?? null : null,
                                    avatarPosition: activeScene?.avatarPosition ?? {
                                        x: CANVAS_SIZES[aspectRatio].width / 2,
                                        y: CANVAS_SIZES[aspectRatio].height / 2
                                    },
                                    avatarSize: activeScene?.avatarSize ?? getInitialAvatarSize(aspectRatio),
                                    avatarZIndex: activeScene?.avatarZIndex,
                                    avatarLocked: activeScene?.avatarLocked,
                                    onElementPositionChange: handleElementPositionChange,
                                    onElementSizeChange: handleElementSizeChange,
                                    onRemoveElement: handleRemoveElement,
                                    onReorderLayers: handleReorderLayers,
                                    onAvatarPositionChange: handleAvatarPositionChange,
                                    onAvatarSizeChange: handleAvatarSizeChange,
                                    onAddMediaAsset: handleAddMediaAsset,
                                    onRemoveAvatar: handleRemoveAvatar,
                                    onToggleAvatarLock: handleToggleAvatarLock
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                    lineNumber: 828,
                                    columnNumber: 13
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                lineNumber: 827,
                                columnNumber: 11
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "min-h-[220px] lg:min-h-[240px]",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$Timeline$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["Timeline"], {
                                    scenes: scenes,
                                    activeSceneId: activeSceneId,
                                    onSelectScene: setActiveSceneId,
                                    onAddScene: handleAddScene,
                                    avatars: avatars,
                                    aspectRatio: aspectRatio
                                }, void 0, false, {
                                    fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                    lineNumber: 857,
                                    columnNumber: 13
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                                lineNumber: 856,
                                columnNumber: 11
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                        lineNumber: 826,
                        columnNumber: 9
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
                lineNumber: 735,
                columnNumber: 7
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/material/editor/components/MaterialEditor.tsx",
        lineNumber: 626,
        columnNumber: 5
    }, this);
}
_s(MaterialEditor, "jkuPAivlOJrYtSygkwzFb/JLtWQ=", false, function() {
    return [
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRouter"]
    ];
});
_c = MaterialEditor;
var _c;
__turbopack_context__.k.register(_c, "MaterialEditor");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/app/material/editor/page.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>MaterialEditorPage
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/navigation.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/supabaseClient.ts [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$MaterialEditor$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/app/material/editor/components/MaterialEditor.tsx [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
;
;
;
function MaterialEditorPage() {
    _s();
    const router = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRouter"])();
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "MaterialEditorPage.useEffect": ()=>{
            const checkAuth = {
                "MaterialEditorPage.useEffect.checkAuth": async ()=>{
                    const { data: { user } } = await __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$supabaseClient$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["supabase"].auth.getUser();
                    if (!user) {
                        router.push("/");
                    }
                }
            }["MaterialEditorPage.useEffect.checkAuth"];
            checkAuth();
        }
    }["MaterialEditorPage.useEffect"], [
        router
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "min-h-screen bg-white",
        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$app$2f$material$2f$editor$2f$components$2f$MaterialEditor$2e$tsx__$5b$app$2d$client$5d$__$28$ecmascript$29$__["MaterialEditor"], {}, void 0, false, {
            fileName: "[project]/app/material/editor/page.tsx",
            lineNumber: 27,
            columnNumber: 7
        }, this)
    }, void 0, false, {
        fileName: "[project]/app/material/editor/page.tsx",
        lineNumber: 26,
        columnNumber: 5
    }, this);
}
_s(MaterialEditorPage, "vQduR7x+OPXj6PSmJyFnf+hU7bg=", false, function() {
    return [
        __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useRouter"]
    ];
});
_c = MaterialEditorPage;
var _c;
__turbopack_context__.k.register(_c, "MaterialEditorPage");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
]);

//# sourceMappingURL=_67c6c9fd._.js.map